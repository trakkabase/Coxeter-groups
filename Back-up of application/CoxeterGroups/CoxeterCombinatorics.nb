(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45279,       1140]
NotebookOptionsPosition[     39816,       1046]
NotebookOutlinePosition[     40482,       1069]
CellTagsIndexPosition[     40439,       1066]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{":", "Title", ":", " ", "CoxeterCombinatorics"}], " ", "*)"}], " ",
   "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Author", ":", " ", 
    RowBox[{"David", " ", "Sheard"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Summary", ":", " ", 
    RowBox[{
    "Functions", " ", "relating", " ", "to", " ", "the", " ", "combinatorial",
      " ", "group", " ", "theory", " ", "of", " ", "Coxeter", " ", 
     RowBox[{"systems", "."}]}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Context", ":", " ", "CoxeterGroups`CoxeterCombinatorics`"}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Package", " ", "version"}], ":", " ", "1.0"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "History", ":", "  ", 
    RowBox[{
    "Version", " ", "1.0", " ", "February", " ", "28", " ", "2022"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", 
    RowBox[{"Mathematica", " ", "version"}], ":", " ", 
    RowBox[{"12.0", ".0", " ", "for", " ", "Microsoft", " ", "Windows", " ", 
     RowBox[{"(", 
      RowBox[{"64", "-", "bit"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"April", " ", "6"}], ",", " ", "2019"}], ")"}]}]}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{":", "Discussion", ":", " ", 
    RowBox[{
     StyleBox["Give",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["more",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["details",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     RowBox[{
      StyleBox["here",
       FontColor->RGBColor[1, 0, 0]], "."}]}]}], "*)"}]}]], "Code",
 CellChangeTimes->{{3.8550578740344*^9, 3.8550579098911934`*^9}, {
  3.8550581812955947`*^9, 
  3.855058181583047*^9}},ExpressionUUID->"13b68376-fec2-40a9-a64d-\
0a6b460eb407"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\n", 
   RowBox[{"\"\<CoxeterGroups`CoxeterCombinatorics`\>\"", ",", "\n", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CoxeterGroups`BasicCoxeterFunctions`\>\"", ",", 
      "\"\<CoxeterGroups`ElementEnumeration`\>\""}], "}"}]}], "\n", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.855299351795579*^9, 3.8552993621399746`*^9}, {
  3.8555055202422295`*^9, 3.8555055440472097`*^9}, {3.8555057116861095`*^9, 
  3.855505745291998*^9}, {3.855506548658705*^9, 
  3.855506579339321*^9}},ExpressionUUID->"3b5e71a4-5693-4305-86aa-\
13377039e14e"],

Cell["Clearing public functions", "Text",
 CellChangeTimes->{{3.855057947135688*^9, 
  3.855057953727314*^9}},ExpressionUUID->"556a7930-803c-4ab4-a3c5-\
a9b3190607b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", "Inversions", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
   "Inversions", ",", "DescentSet", ",", "CentralGenerator", ",", 
    "ConjugatingElement", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Strong", " ", "Bruhat", " ", "order"}], "*)"}], 
    "\[IndentingNewLine]", "StrongBruhatCover", ",", "StrongBruhatGraph", ",",
     "StrongBruhatIdeal"}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", "Inversions", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
   "Inversions", ",", "DescentSet", ",", "CentralGenerator", ",", 
    "ConjugatingElement", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Strong", " ", "Bruhat", " ", "order"}], "*)"}], 
    "\[IndentingNewLine]", "StrongBruhatCover", ",", "StrongBruhatGraph", ",",
     "StrongBruhatIdeal"}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.855057956316985*^9, 3.8550579686145*^9}, {
  3.8552995460513563`*^9, 3.855299556841667*^9}, {3.8554103909821043`*^9, 
  3.8554104434104195`*^9}, {3.855475826435851*^9, 3.855475835222026*^9}, {
  3.8558224678194823`*^9, 3.8558225115878005`*^9}, {3.855904802100972*^9, 
  3.855904819769413*^9}},ExpressionUUID->"7dd896a4-0271-4bf4-8e5a-\
7e2f5220312d"],

Cell[CellGroupData[{

Cell["Usage Messages", "Subsection",
 CellChangeTimes->{{3.85505798349082*^9, 
  3.8550579884291925`*^9}},ExpressionUUID->"078782e5-30d9-41aa-a9e0-\
2d94697616c4"],

Cell[CellGroupData[{

Cell["Inversions", "Subsubsection",
 CellChangeTimes->{{3.8554104551612015`*^9, 
  3.8554104569542646`*^9}},ExpressionUUID->"cb2bc04a-0850-4ff7-96bf-\
b16e69d12822"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Inversions", "::", "usage"}], "=", 
   "\"\<Inversions[M, w,\\\"left\\\"] lists all reflections in the Coxeter \
system associated to M which reduce the length of w when multiplied on the \
left.\[IndentingNewLine]Inversions[M, w,\\\"right\\\"] lists all reflections \
in the Coxeter system associated to M which reduce the length of w when \
multiplied on the right.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DescentSet", "::", "usage"}], "=", 
   "\"\<DescentSet[M, w, \\\"left\\\"] lists all simple reflenctions in the \
Coxeter system associated to M which reduce the length of w when multiplied \
on the left.\nDescentSet[M, w, \\\"right\\\"] lists all simple reflenctions \
in the Coxeter system associated to M which reduce the length of w when \
multiplied on the right.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralGenerator", "::", "usage"}], "=", 
   "\"\<CentralGenerator[\\\"word\\\"] returns the middle s-symbol in \
\\\"word\\\" if it is palindromic and represents a reflection.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugatingElement", "::", "usage"}], "=", 
   "\"\<CentralGenerator[\\\"word\\\"] returns the subword of \\\"word\\\" \
such that \\\"word\\\" is the conjugate of some generator by that \
subword.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.855410483648528*^9, 3.855410511032733*^9}, {
  3.8554105566231604`*^9, 3.8554105577482824`*^9}, {3.8554105887623787`*^9, 
  3.8554106337573233`*^9}, {3.8554755728504305`*^9, 3.8554756974610634`*^9}, {
  3.8554758864250784`*^9, 3.855475913806048*^9}, {3.855512010581532*^9, 
  3.8555120867759695`*^9}, {3.855904829606289*^9, 3.8559048322047873`*^9}, {
  3.855904900653242*^9, 3.855904913820279*^9}, {3.85590510820442*^9, 
  3.8559052086351533`*^9}, {3.855905239110915*^9, 
  3.8559052885572605`*^9}},ExpressionUUID->"95e06899-483b-4e08-bb61-\
b45e2c4e7416"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bruhat order", "Subsubsection",
 CellChangeTimes->{{3.855410462644202*^9, 
  3.85541046536018*^9}},ExpressionUUID->"2f3d3502-c29b-4bef-a4be-\
b5c985cff83e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BruhatGraph", "::", "usage"}], "=", 
   "\"\<BruhatGraph[M, wList] gives the directed graph whose vertices are the \
elements of the Coxeter system associated to M listed in wList, and whose \
directed edges join elements whose length differes by 1, and which are \
related by Bruhat order.\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.855410515677322*^9, 3.8554105180516376`*^9}, 
   3.855410561738087*^9, {3.8554758708238935`*^9, 3.855475871755026*^9}, {
   3.8554759180637503`*^9, 
   3.855476058614601*^9}},ExpressionUUID->"e920d5a6-2462-4745-a901-\
301f15baf6ed"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error Messages", "Subsection",
 CellChangeTimes->{{3.855057996187267*^9, 
  3.855058001691546*^9}},ExpressionUUID->"e7028efb-bb0b-4028-a26b-\
2bd577bd7b7e"],

Cell[CellGroupData[{

Cell["Inversions", "Subsubsection",
 CellChangeTimes->{{3.8554104551612015`*^9, 
  3.8554104569542646`*^9}},ExpressionUUID->"864e93b3-6836-4b35-afe0-\
3119984773f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Inversions", "::", "argerr"}], "=", 
   "\"\<Three arguments expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inversions", "::", "handedness"}], "=", 
   "\"\<The third argument must be \\\"left\\\" or \\\"right\\\"\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DescentSet", "::", "argerr"}], "=", 
   "\"\<Three arguments expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DescentSet", "::", "handedness"}], "=", 
   "\"\<The third argument must be \\\"left\\\" or \\\"right\\\"\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralGenerator", "::", "argerr"}], "=", 
   "\"\<One string argument expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralGenerator", "::", "notpalindromic"}], "=", 
   "\"\<The input must be a palindromic word.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugatingElement", "::", "argerr"}], "=", 
   "\"\<One string argument expected.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConjugatingElement", "::", "notpalindromic"}], "=", 
   "\"\<The input must be a palindromic word.\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.8554105658117*^9, 3.8554105822712555`*^9}, {
  3.8554757012917004`*^9, 3.8554757209035025`*^9}, {3.8555120950776978`*^9, 
  3.8555120968509207`*^9}, {3.8555122388604865`*^9, 3.855512314576699*^9}, {
  3.8559048381630764`*^9, 3.855904843015365*^9}, {3.8559048878956747`*^9, 
  3.8559048980418186`*^9}, {3.855904935931389*^9, 3.8559049577234354`*^9}, {
  3.855905052689946*^9, 
  3.8559051018473167`*^9}},ExpressionUUID->"386bee8d-f3d2-4fd4-a84b-\
ec9857994160"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bruhat order", "Subsubsection",
 CellChangeTimes->{{3.855410462644202*^9, 
  3.85541046536018*^9}},ExpressionUUID->"13356216-24c0-41ea-8618-\
6fda51b11fc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BruhatGraph", "::", "argerr"}], "=", 
   "\"\<Two arguments expected.\>\""}], ";"}]], "Input",
 CellChangeTimes->{
  3.8554105843976974`*^9, {3.8554758570093646`*^9, 
   3.8554758609652224`*^9}},ExpressionUUID->"528d135c-db26-4efd-aed2-\
29c48b8c83b4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialisation", "Subsection",
 CellChangeTimes->{{3.8550580203807635`*^9, 
  3.855058023305772*^9}},ExpressionUUID->"1015dd08-5346-4b03-8403-\
713077dbd41f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Code",ExpressionU\
UID->"72eeff73-129f-430c-9519-ef36c40e2695"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inversions", "Subsection",
 CellChangeTimes->{{3.8552994711421337`*^9, 
  3.855299472773167*^9}},ExpressionUUID->"586dab76-df9c-42b4-9db9-\
e0b0889e50d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Inversions", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"Inversions", "::", "argerr"}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Inversions", "[", 
   RowBox[{"M_", ",", "w_", ",", "side_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"Inversions", "::", "handedness"}], "]"}], ";", "$Failed"}], 
    ")"}], "/;", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<left\>\"", ",", "\"\<right\>\""}], "}"}], ",", "side"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DescentSet", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"DescentSet", "::", "argerr"}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DescentSet", "[", 
   RowBox[{"M_", ",", "w_", ",", "side_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"DescentSet", "::", "handedness"}], "]"}], ";", "$Failed"}], 
    ")"}], "/;", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<left\>\"", ",", "\"\<right\>\""}], "}"}], ",", "side"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CentralGenerator", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"CentralGenerator", "::", "argerr"}], "]"}], ";", "$Failed"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugatingElement", "[", "args___", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"ConjugatingElement", "::", "argerr"}], "]"}], ";", "$Failed"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.855512329788231*^9, 3.8555125089349213`*^9}, {
  3.855904851848731*^9, 
  3.855904883039299*^9}},ExpressionUUID->"9f306daf-1049-433b-bb98-\
8538cce2413d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakePalindromic", "[", "u_String", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WordLength", "[", "u", "]"}], "\[Equal]", "1"}], ",", 
    "\[IndentingNewLine]", "u", ",", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"u", ",", 
      RowBox[{"WordDrop", "[", 
       RowBox[{
        RowBox[{"WordInverse", "[", "u", "]"}], ",", "1"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.731411046929428*^9, 3.7314110975030303`*^9}, {
   3.731411289306371*^9, 3.7314114218664646`*^9}, {3.731411499160747*^9, 
   3.731411506918039*^9}, {3.731418373328315*^9, 3.73141843009124*^9}, {
   3.731418471868579*^9, 3.7314184725240717`*^9}, 3.7314186920258236`*^9, {
   3.731418772429136*^9, 3.731418887036048*^9}, 3.7314191682758303`*^9, {
   3.733838640815073*^9, 3.733838653370206*^9}, {3.7338387609452724`*^9, 
   3.7338388302975197`*^9}, {3.733838999623672*^9, 3.73383902538455*^9}, {
   3.7338390975248814`*^9, 3.7338391313326616`*^9}, {3.7338392439778676`*^9, 
   3.7338392827987957`*^9}, {3.7338393537595186`*^9, 3.733839361684396*^9}, {
   3.733839431526512*^9, 3.7338394629955263`*^9}, 3.73384056310719*^9, {
   3.8552994895924606`*^9, 3.8552995427380056`*^9}, {3.855378195681164*^9, 
   3.8553782013507547`*^9}, {3.8558135856963468`*^9, 
   3.8558135984726253`*^9}, {3.855824344257913*^9, 
   3.855824385072772*^9}},ExpressionUUID->"eab69237-a632-4c8f-86ff-\
436ca1c2d547"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Inversions", "[", 
   RowBox[{"M_", ",", "w_String", ",", "\"\<left\>\""}], "]"}], ":=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CoxeterReduce", "[", 
        RowBox[{"M", ",", 
         RowBox[{"MakePalindromic", "[", 
          RowBox[{"WordTake", "[", 
           RowBox[{
            RowBox[{"FindCoxeterReducedWord", "[", 
             RowBox[{"M", ",", "w"}], "]"}], ",", "k"}], "]"}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WordPalindromeQ", "[", "#", "]"}], "&"}], ",", "1"}], 
      "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"CoxeterLength", "[", 
       RowBox[{"M", ",", "w"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Inversions", "[", 
   RowBox[{"M_", ",", "w_String", ",", "\"\<right\>\""}], "]"}], ":=", 
  RowBox[{"Inversions", "[", 
   RowBox[{"M", ",", 
    RowBox[{"WordInverse", "[", "w", "]"}], ",", "\"\<left\>\""}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.731411046929428*^9, 3.7314110975030303`*^9}, {
   3.731411289306371*^9, 3.7314114218664646`*^9}, {3.731411499160747*^9, 
   3.731411506918039*^9}, {3.731418373328315*^9, 3.73141843009124*^9}, {
   3.731418471868579*^9, 3.7314184725240717`*^9}, 3.7314186920258236`*^9, {
   3.731418772429136*^9, 3.731418887036048*^9}, 3.7314191682758303`*^9, {
   3.733838640815073*^9, 3.733838653370206*^9}, {3.7338387609452724`*^9, 
   3.7338388302975197`*^9}, {3.733838999623672*^9, 3.73383902538455*^9}, {
   3.7338390975248814`*^9, 3.7338391313326616`*^9}, {3.7338392439778676`*^9, 
   3.7338392827987957`*^9}, {3.7338393537595186`*^9, 3.733839361684396*^9}, {
   3.733839431526512*^9, 3.7338394629955263`*^9}, 3.73384056310719*^9, {
   3.8552994895924606`*^9, 3.855299571678129*^9}, {3.8555118369614716`*^9, 
   3.85551194359088*^9}, {3.8558136823943605`*^9, 3.855813682983798*^9}, {
   3.85581403645885*^9, 3.8558140383170958`*^9}, {3.855822764429251*^9, 
   3.855822814092084*^9}, {3.8558248292976522`*^9, 3.855824829914405*^9}, {
   3.8558251375604105`*^9, 
   3.855825138273551*^9}},ExpressionUUID->"eddba6fc-ac2c-4cf5-94e7-\
6f92ac8d3a3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CentralGenerator", "[", "w_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"WordTake", "[", 
    RowBox[{"w", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"WordLength", "[", "w", "]"}], "+", "1"}], ")"}], "/", "2"}],
       "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"WordPalindromeQ", "[", "w", "]"}], "&&", 
    RowBox[{"OddQ", "[", 
     RowBox[{"WordLength", "[", "w", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CentralGenerator", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"CentralGenerator", "::", "notpalindromic"}], "]"}], ";", 
     "$Failed"}], ")"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"WordPalindromeQ", "[", "w", "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"OddQ", "[", 
      RowBox[{"WordLength", "[", "w", "]"}], "]"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.731411046929428*^9, 3.7314110975030303`*^9}, {
   3.731411289306371*^9, 3.7314114218664646`*^9}, {3.731411499160747*^9, 
   3.731411506918039*^9}, {3.731418373328315*^9, 3.73141843009124*^9}, {
   3.731418471868579*^9, 3.7314184725240717`*^9}, 3.7314186920258236`*^9, {
   3.731418772429136*^9, 3.731418887036048*^9}, 3.7314191682758303`*^9, {
   3.733838640815073*^9, 3.733838653370206*^9}, {3.7338387609452724`*^9, 
   3.7338388302975197`*^9}, {3.733838999623672*^9, 3.73383902538455*^9}, {
   3.7338390975248814`*^9, 3.7338391313326616`*^9}, {3.7338392439778676`*^9, 
   3.7338392827987957`*^9}, {3.7338393537595186`*^9, 3.733839361684396*^9}, {
   3.733839431526512*^9, 3.7338394629955263`*^9}, 3.73384056310719*^9, {
   3.8552994895924606`*^9, 3.8552995786166887`*^9}, {3.855814056965727*^9, 
   3.8558140627191257`*^9}, {3.8558249425915823`*^9, 
   3.8558249431269693`*^9}, {3.855904968054484*^9, 3.8559050381859074`*^9}, {
   3.855905514378894*^9, 
   3.8559055429544144`*^9}},ExpressionUUID->"64469ff0-f85b-4582-945a-\
bb80c60fb46a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConjugatingElement", "[", "w_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"WordTake", "[", 
    RowBox[{"w", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"WordLength", "[", "w", "]"}], "-", "1"}], ")"}], "/", 
      "2"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"WordPalindromeQ", "[", "w", "]"}], "&&", 
    RowBox[{"OddQ", "[", 
     RowBox[{"WordLength", "[", "w", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConjugatingElement", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{"ConjugatingElement", "::", "notpalindromic"}], "]"}], ";", 
     "$Failed"}], ")"}], "/;", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"WordPalindromeQ", "[", "w", "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"OddQ", "[", 
      RowBox[{"WordLength", "[", "w", "]"}], "]"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.731411046929428*^9, 3.7314110975030303`*^9}, {
   3.731411289306371*^9, 3.7314114218664646`*^9}, {3.731411499160747*^9, 
   3.731411506918039*^9}, {3.731418373328315*^9, 3.73141843009124*^9}, {
   3.731418471868579*^9, 3.7314184725240717`*^9}, 3.7314186920258236`*^9, {
   3.731418772429136*^9, 3.731418887036048*^9}, 3.7314191682758303`*^9, {
   3.733838640815073*^9, 3.733838653370206*^9}, {3.7338387609452724`*^9, 
   3.7338388302975197`*^9}, {3.733838999623672*^9, 3.73383902538455*^9}, {
   3.7338390975248814`*^9, 3.7338391313326616`*^9}, {3.7338392439778676`*^9, 
   3.7338392827987957`*^9}, {3.7338393537595186`*^9, 3.733839361684396*^9}, {
   3.733839431526512*^9, 3.7338394629955263`*^9}, 3.73384056310719*^9, {
   3.8552994895924606`*^9, 3.8552995786166887`*^9}, {3.855814069323388*^9, 
   3.8558140775816402`*^9}, {3.85582494639526*^9, 3.855824946923895*^9}, {
   3.8559050140735865`*^9, 3.8559050461310887`*^9}, {3.855905551795086*^9, 
   3.85590555853697*^9}},ExpressionUUID->"e1f3763d-fb78-4c1a-bad1-\
ceba13d0be6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DescentSet", "[", 
   RowBox[{"M_", ",", "w_", ",", "\"\<left\>\""}], "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Generators", "[", "M", "]"}], ",", 
    RowBox[{
     RowBox[{"ReducibleWordQ", "[", 
      RowBox[{"M", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"#", ",", 
         RowBox[{"FindCoxeterReducedWord", "[", 
          RowBox[{"M", ",", "w"}], "]"}]}], "]"}]}], "]"}], "&"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"DescentSet", "[", 
   RowBox[{"M_", ",", "w_", ",", "\"\<right\>\""}], "]"}], ":=", 
  RowBox[{"DescentSet", "[", 
   RowBox[{"M", ",", 
    RowBox[{"WordInverse", "[", "w", "]"}], ",", "\"\<left\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8553781763914413`*^9, 3.8553782915926895`*^9}, {
  3.8553783228377695`*^9, 3.855378334151553*^9}, {3.855475742272585*^9, 
  3.8554758070915027`*^9}, {3.8555054390074387`*^9, 3.855505456722561*^9}, {
  3.8558140948323574`*^9, 
  3.85581409675886*^9}},ExpressionUUID->"89db682a-a6a3-4a31-be67-\
c823ef1ceac8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Strong Bruhat order", "Subsection",
 CellChangeTimes->{{3.8555076178070707`*^9, 
  3.8555076232430644`*^9}},ExpressionUUID->"10c4e5ac-adac-47c5-b71a-\
0814ff0291c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StrongBruhatCover", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CoxeterMultiply", "[", 
         RowBox[{"M", ",", "#", ",", "w"}], "]"}], "\[Rule]", "w"}], ",", 
       "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Inversions", "[", 
     RowBox[{"M", ",", "w", ",", "\"\<left\>\""}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8554087409988637`*^9, 3.855408805468727*^9}, {
   3.85540887919241*^9, 3.8554088794167833`*^9}, {3.8554089544500427`*^9, 
   3.855408984349269*^9}, {3.8554090927754636`*^9, 3.855409114580532*^9}, {
   3.855409151732155*^9, 3.855409157293064*^9}, {3.8554092132557945`*^9, 
   3.8554092154753227`*^9}, {3.855409553570912*^9, 3.8554095673993616`*^9}, {
   3.8554099062894325`*^9, 3.855409919615749*^9}, {3.8554100999659414`*^9, 
   3.8554101038297706`*^9}, 3.855410147449661*^9, {3.855475812386778*^9, 
   3.8554758180924873`*^9}, {3.8555068641676774`*^9, 3.855506866479456*^9}, {
   3.855507589617487*^9, 3.855507593220801*^9}, {3.8555116266692*^9, 
   3.855511631148724*^9}, {3.855512174309044*^9, 
   3.8555121881930437`*^9}},ExpressionUUID->"26e9e52f-881f-4c5e-9ac1-\
667b7eb2c823"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StrongBruhatGraph", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"GraphUnion", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"StrongBruhatCover", "[", 
       RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", "wList"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8554091620912604`*^9, 3.8554092431718287`*^9}, {
  3.855410111319007*^9, 3.8554101138477287`*^9}, {3.855410150284878*^9, 
  3.8554101552356515`*^9}, {3.855506872818756*^9, 3.855506880821452*^9}, {
  3.8555070533760033`*^9, 3.8555070546414485`*^9}, {3.855507596834267*^9, 
  3.855507600977871*^9}, {3.855511634428438*^9, 
  3.8555116417569504`*^9}},ExpressionUUID->"07c7de80-6953-43a2-876c-\
6d35fd3dabda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StrongBruhatGraph", "[", 
   RowBox[{"M_", ",", "k_Integer"}], "]"}], ":=", 
  RowBox[{"StrongBruhatGraph", "[", 
   RowBox[{"M", ",", 
    RowBox[{"CoxeterGroupElements", "[", 
     RowBox[{"M", ",", "k"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8554101399562716`*^9, 3.8554101728566194`*^9}, {
  3.855410239783889*^9, 3.8554102481662874`*^9}, {3.855507603566188*^9, 
  3.8555076046821756`*^9}, {3.8555116450984097`*^9, 3.8555116488509316`*^9}, {
  3.8558255307634573`*^9, 
  3.8558255318713903`*^9}},ExpressionUUID->"3af24838-79b3-4f1f-b220-\
e4174093fc47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StrongBruhatIdeal", "[", 
   RowBox[{"M_", ",", "\"\<\>\""}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", "\"\<\>\"", "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrongBruhatIdeal", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Graph", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\>\"", "\[Rule]", "w"}], "}"}], "]"}], "/;", 
   RowBox[{"GeneratorQ", "[", "w", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrongBruhatIdeal", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StringMatchQ", "[", 
      RowBox[{"w", ",", 
       RowBox[{
        RowBox[{"\"\<s\>\"", "~~", "x__", "~~", "\"\<s\>\"", "~~", "x__"}], "/;", 
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"x", ",", "\"\<s\>\""}], "]"}]}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StrongBruhatIdeal", "[", 
      RowBox[{"M", ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\"\<\>\"", "}"}], ",", 
         RowBox[{"WordSymbols", "[", "w", "]"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<\>\"", "\[Rule]", "#"}], ",", 
            RowBox[{"#", "\[Rule]", "w"}]}], "}"}], "&"}], "/@", 
         RowBox[{"WordSymbols", "[", "w", "]"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"WordLength", "[", "w", "]"}], "\[Equal]", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrongBruhatIdeal", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cover", ",", "lower"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cover", "=", 
      RowBox[{"StrongBruhatCover", "[", 
       RowBox[{"M", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lower", "=", 
      RowBox[{"Fold", "[", 
       RowBox[{"GraphUnion", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"StrongBruhatIdeal", "[", 
           RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"VertexList", "[", "cover", "]"}], ",", 
           RowBox[{"{", "w", "}"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GraphUnion", "[", 
      RowBox[{"cover", ",", "lower"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8558188398560877`*^9, 3.855818899332677*^9}, {
  3.855818952389801*^9, 3.8558189587332673`*^9}, {3.8558190116104603`*^9, 
  3.8558190611395493`*^9}, {3.855819115063947*^9, 3.8558192728719378`*^9}, {
  3.855819310380039*^9, 3.8558193455885*^9}, {3.8558194494839616`*^9, 
  3.855819491472621*^9}, {3.855819600202073*^9, 3.855819615416624*^9}, {
  3.855819792028927*^9, 3.8558198604714947`*^9}, {3.8558205668768034`*^9, 
  3.8558205833332396`*^9}, {3.855820927254942*^9, 3.8558210408151293`*^9}, {
  3.855821153200759*^9, 3.8558211797576904`*^9}, {3.855821211535425*^9, 
  3.855821240769384*^9}, {3.855821680927684*^9, 3.8558217327716427`*^9}, {
  3.8558217728757024`*^9, 3.855821805105056*^9}, {3.855826219156429*^9, 
  3.8558262221246047`*^9}, {3.8558276175452113`*^9, 
  3.855827627498383*^9}},ExpressionUUID->"0857e898-5664-4c59-9ffa-\
0c905d659d03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SubWords", "[", 
   RowBox[{"M_", ",", "\"\<\>\"", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubWords", "[", 
   RowBox[{"M_", ",", "w_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FindCoxeterReducedWord", "[", 
      RowBox[{"M", ",", 
       RowBox[{"Fold", "[", 
        RowBox[{"StringJoin", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"WordToList", "[", "w", "]"}], ",", 
      RowBox[{"{", "k", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.855829192443412*^9, {3.8558293163781567`*^9, 
   3.855829387372717*^9}},ExpressionUUID->"fa189f52-5a03-4290-81a1-\
67d95a191120"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoxeterReducedSubWords", "[", 
   RowBox[{"M_", ",", "w_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Sort", "[", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"SubWords", "[", 
       RowBox[{"M", ",", "w", ",", "k"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"nonMinimalQ", "[", 
         RowBox[{"M", ",", "#"}], "]"}], "]"}], "&"}]}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.855829192443412*^9, {3.8558293973461676`*^9, 
   3.8558294136028547`*^9}},ExpressionUUID->"ef638b10-426b-47e5-b8e0-\
b12cc34a6730"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"titBruhatLess", "[", 
   RowBox[{"M_", ",", "\"\<\>\""}], "]"}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"titBruhatLess", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "d", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"FindCoxeterReducedWord", "[", 
       RowBox[{"M", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"WordLength", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"CoxeterReducedSubWords", "[", 
       RowBox[{"M", ",", "x", ",", 
        RowBox[{"d", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"titBruhatLess", "[", 
       RowBox[{"M", ",", "w"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "x"}], "}"}], "&"}], "/@", "r"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8558291035983706`*^9, 3.8558291477028503`*^9}, 
   3.8558291780060883`*^9, {3.8558294057971716`*^9, 
   3.8558294060496826`*^9}},ExpressionUUID->"ef1fae38-6d7f-478b-8835-\
5f3748c27c79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"titBruhatLessList", "[", 
    RowBox[{"M_", ",", "\"\<\>\""}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"titBruhatLessList", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"titBruhatLessList", "[", 
    RowBox[{"M", ",", "w"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"titBruhatLess", "[", 
     RowBox[{"M", ",", "w"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8558291035983706`*^9, 3.8558291477028503`*^9}, 
   3.8558291780060883`*^9},ExpressionUUID->"f27d0c2c-bfb9-48b0-a74a-\
49a0347510f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"titBruhatGraph", "[", 
   RowBox[{"M_", ",", "\"\<\>\""}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", "\"\<\>\"", "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"titBruhatGraph", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Graph", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<\>\"", "\[Rule]", "w"}], "}"}], "]"}], "/;", 
   RowBox[{"GeneratorQ", "[", "w", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"titBruhatGraph", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"titBruhatLess", "[", 
      RowBox[{"M", ",", "w"}], "]"}], ",", 
     RowBox[{"Fold", "[", 
      RowBox[{"Join", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"titBruhatGraph", "[", 
          RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"titBruhatLessList", "[", 
         RowBox[{"M", ",", "w"}], "]"}]}]}], "]"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.855828963600792*^9, 3.8558290335970736`*^9}, {
  3.855830156352668*^9, 
  3.855830195593734*^9}},ExpressionUUID->"6bddde10-c08e-4884-8b3c-\
f0e7f805b980"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak Bruhat order", "Subsection",
 CellChangeTimes->{{3.85540793990335*^9, 3.855407946878406*^9}, {
  3.855507607433152*^9, 
  3.8555076084350147`*^9}},ExpressionUUID->"f41b3537-01d2-457f-85ff-\
506da7285b36"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"To", " ", "be", " ", "carefully", " ", "re"}], "-", "written"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8555121522552032`*^9, 
  3.8555121622652855`*^9}},ExpressionUUID->"86dd4bfb-07a9-4209-84e4-\
ea6fcb9adcec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeakBruhatCover", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CoxeterMultiply", "[", 
         RowBox[{"M", ",", "w", ",", "#"}], "]"}], "\[Rule]", "w"}], ",", 
       "#"}], "]"}], "&"}], "/@", 
    RowBox[{"DescentSet", "[", 
     RowBox[{"M", ",", "w", ",", "\"\<right\>\""}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8554087409988637`*^9, 3.855408805468727*^9}, {
   3.85540887919241*^9, 3.8554088794167833`*^9}, {3.8554089544500427`*^9, 
   3.855408984349269*^9}, {3.8554090927754636`*^9, 3.855409114580532*^9}, {
   3.855409151732155*^9, 3.855409157293064*^9}, {3.8554092132557945`*^9, 
   3.8554092154753227`*^9}, {3.855409553570912*^9, 3.8554095673993616`*^9}, {
   3.8554099062894325`*^9, 3.855409919615749*^9}, {3.8554100999659414`*^9, 
   3.8554101038297706`*^9}, 3.855410147449661*^9, {3.855475812386778*^9, 
   3.8554758180924873`*^9}, {3.8555068641676774`*^9, 3.855506866479456*^9}, {
   3.855507589617487*^9, 
   3.855507593220801*^9}},ExpressionUUID->"62f57e79-d4a3-4f32-b1ff-\
f2054e6bdde8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeakBruhatGraph", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"GraphUnion", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"WeakBruhatCover", "[", 
       RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", "wList"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8554091620912604`*^9, 3.8554092431718287`*^9}, {
  3.855410111319007*^9, 3.8554101138477287`*^9}, {3.855410150284878*^9, 
  3.8554101552356515`*^9}, {3.855506872818756*^9, 3.855506880821452*^9}, {
  3.8555070533760033`*^9, 3.8555070546414485`*^9}, {3.855507596834267*^9, 
  3.855507600977871*^9}},ExpressionUUID->"99813f40-9866-4024-9fc3-\
14db0011ea9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeakBruhatGraph", "[", 
   RowBox[{"M_", ",", "k_Integer"}], "]"}], ":=", 
  RowBox[{"BruhatGraph", "[", 
   RowBox[{"M", ",", 
    RowBox[{"CoxeterGroupElements", "[", 
     RowBox[{"M", ",", "k"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8554101399562716`*^9, 3.8554101728566194`*^9}, {
  3.855410239783889*^9, 3.8554102481662874`*^9}, {3.855507603566188*^9, 
  3.8555076046821756`*^9}},ExpressionUUID->"673a7164-ab37-4e8e-b555-\
d1b0cfb92034"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualisation", "Subsection",
 CellChangeTimes->{{3.8561673062928314`*^9, 
  3.8561673087369957`*^9}},ExpressionUUID->"49951b2f-7f17-457d-8136-\
f692080bc7ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GalleryLeftBruhatIdeal", "[", 
   RowBox[{"M_", ",", "w_"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ShowLeftBruhatIdeal", "[", 
     RowBox[{"M", ",", "w", ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "]"}], ",", 
    RowBox[{"Gallery", "[", 
     RowBox[{"M", ",", "w"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.855906270416065*^9, 3.855906301294797*^9}, {
  3.8559063389975243`*^9, 
  3.855906369840849*^9}},ExpressionUUID->"1c70612d-4c8f-4491-b3ac-\
952001753f62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GalleryLengthIdeal", "[", 
   RowBox[{"M_", ",", "w_String"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ShowLengthIdeal", "[", 
     RowBox[{"M", ",", 
      RowBox[{"CoxeterLength", "[", 
       RowBox[{"M", ",", "w"}], "]"}], ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "]"}], ",", 
    RowBox[{"Gallery", "[", 
     RowBox[{"M", ",", "w"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GalleryLengthIdeal", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ShowLengthIdeal", "[", 
     RowBox[{"M", ",", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CoxeterLength", "[", 
          RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", "wList"}], "]"}], ",", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], "]"}], ",", 
    RowBox[{"Gallery", "[", 
     RowBox[{"M", ",", "wList"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.855906270416065*^9, 3.855906301294797*^9}, {
  3.8559063389975243`*^9, 
  3.8559063819933896`*^9}},ExpressionUUID->"97820d5c-3ad6-4ef7-96ce-\
88b0836d71f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finalisation", "Subsection",
 CellChangeTimes->{{3.85505807217948*^9, 
  3.855058074236624*^9}},ExpressionUUID->"e2f46879-7821-44c4-b4ac-\
ff860464262f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Code",ExpressionUUID->"8ac50909-4090-4ab9-be12-f4aef7eeb06b"],

Cell["Protecting public functions", "Text",
 CellChangeTimes->{{3.8550580930384645`*^9, 
  3.8550581017930117`*^9}},ExpressionUUID->"1fe00d46-c4d9-467c-ab34-\
5ae51e5a183b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", "Inversions", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
   "Inversions", ",", "DescentSet", ",", "CentralGenerator", ",", 
    "ConjugatingElement", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Strong", " ", "Bruhat", " ", "order"}], "*)"}], 
    "\[IndentingNewLine]", "StrongBruhatCover", ",", "StrongBruhatGraph", ",",
     "StrongBruhatIdeal"}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.855058124653308*^9, 3.8550581274471536`*^9}, 
   3.8554104481577787`*^9, {3.8554757285041113`*^9, 3.855475732302021*^9}, {
   3.855822516044634*^9, 3.8558225242050767`*^9}, 
   3.8559048232882767`*^9},ExpressionUUID->"d6f39f5d-d66a-4c35-9bfc-\
9753d61d8fb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Code",ExpressionUUID->"46523909-737f-46e8-b5f5-3182bf99a5ff"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{926, 817},
WindowMargins->{{Automatic, 7}, {Automatic, 0}},
TaggingRules->None,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Input"], InitializationCell -> True]}, Visible -> False, 
  FrontEndVersion -> "12.0 for Microsoft Windows (64-bit) (April 8, 2019)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2017, 56, 177, "Code",ExpressionUUID->"13b68376-fec2-40a9-a64d-0a6b460eb407"],
Cell[2578, 78, 594, 13, 105, "Code",ExpressionUUID->"3b5e71a4-5693-4305-86aa-13377039e14e"],
Cell[3175, 93, 167, 3, 34, "Text",ExpressionUUID->"556a7930-803c-4ab4-a3c5-a9b3190607b0"],
Cell[3345, 98, 1394, 27, 254, "Input",ExpressionUUID->"7dd896a4-0271-4bf4-8e5a-7e2f5220312d"],
Cell[CellGroupData[{
Cell[4764, 129, 163, 3, 53, "Subsection",ExpressionUUID->"078782e5-30d9-41aa-a9e0-2d94697616c4"],
Cell[CellGroupData[{
Cell[4952, 136, 165, 3, 44, "Subsubsection",ExpressionUUID->"cb2bc04a-0850-4ff7-96bf-b16e69d12822"],
Cell[5120, 141, 1983, 37, 330, "Input",ExpressionUUID->"95e06899-483b-4e08-bb61-b45e2c4e7416"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7140, 183, 162, 3, 44, "Subsubsection",ExpressionUUID->"2f3d3502-c29b-4bef-a4be-b5c985cff83e"],
Cell[7305, 188, 617, 12, 121, "Input",ExpressionUUID->"e920d5a6-2462-4745-a901-301f15baf6ed"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7971, 206, 162, 3, 53, "Subsection",ExpressionUUID->"e7028efb-bb0b-4028-a26b-2bd577bd7b7e"],
Cell[CellGroupData[{
Cell[8158, 213, 165, 3, 44, "Subsubsection",ExpressionUUID->"864e93b3-6836-4b35-afe0-3119984773f9"],
Cell[8326, 218, 1783, 43, 178, "Input",ExpressionUUID->"386bee8d-f3d2-4fd4-a84b-ec9857994160"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10146, 266, 162, 3, 44, "Subsubsection",ExpressionUUID->"13356216-24c0-41ea-8618-6fda51b11fc0"],
Cell[10311, 271, 299, 8, 44, "Input",ExpressionUUID->"528d135c-db26-4efd-aed2-29c48b8c83b4"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10659, 285, 164, 3, 53, "Subsection",ExpressionUUID->"1015dd08-5346-4b03-8403-713077dbd41f"],
Cell[10826, 290, 148, 3, 50, "Code",ExpressionUUID->"72eeff73-129f-430c-9519-ef36c40e2695"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11011, 298, 160, 3, 53, "Subsection",ExpressionUUID->"586dab76-df9c-42b4-9db9-e0b0889e50d2"],
Cell[11174, 303, 2044, 62, 197, "Input",ExpressionUUID->"9f306daf-1049-433b-bb98-8538cce2413d"],
Cell[13221, 367, 1548, 29, 121, "Input",ExpressionUUID->"eab69237-a632-4c8f-86ff-436ca1c2d547",
 InitializationCell->True],
Cell[14772, 398, 2431, 50, 178, "Input",ExpressionUUID->"eddba6fc-ac2c-4cf5-94e7-6f92ac8d3a3f",
 InitializationCell->True],
Cell[17206, 450, 2045, 47, 83, "Input",ExpressionUUID->"64469ff0-f85b-4582-945a-bb80c60fb46a",
 InitializationCell->True],
Cell[19254, 499, 2011, 45, 83, "Input",ExpressionUUID->"e1f3763d-fb78-4c1a-bad1-ceba13d0be6c",
 InitializationCell->True],
Cell[21268, 546, 1106, 27, 102, "Input",ExpressionUUID->"89db682a-a6a3-4a31-be67-c823ef1ceac8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22411, 578, 171, 3, 53, "Subsection",ExpressionUUID->"10c4e5ac-adac-47c5-b71a-0814ff0291c0"],
Cell[22585, 583, 1283, 26, 44, "Input",ExpressionUUID->"26e9e52f-881f-4c5e-9ac1-667b7eb2c823"],
Cell[23871, 611, 751, 17, 44, "Input",ExpressionUUID->"07c7de80-6953-43a2-876c-6d35fd3dabda"],
Cell[24625, 630, 605, 13, 44, "Input",ExpressionUUID->"3af24838-79b3-4f1f-b220-e4174093fc47"],
Cell[25233, 645, 3590, 88, 254, "Input",ExpressionUUID->"0857e898-5664-4c59-9ffa-0c905d659d03"],
Cell[28826, 735, 796, 22, 83, "Input",ExpressionUUID->"fa189f52-5a03-4290-81a1-67d95a191120"],
Cell[29625, 759, 640, 18, 44, "Input",ExpressionUUID->"ef638b10-426b-47e5-b8e0-b12cc34a6730"],
Cell[30268, 779, 1278, 33, 159, "Input",ExpressionUUID->"ef1fae38-6d7f-478b-8835-5f3748c27c79"],
Cell[31549, 814, 730, 20, 83, "Input",ExpressionUUID->"f27d0c2c-bfb9-48b0-a74a-49a0347510f0"],
Cell[32282, 836, 1278, 36, 102, "Input",ExpressionUUID->"6bddde10-c08e-4884-8b3c-f0e7f805b980"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33597, 877, 215, 4, 53, "Subsection",ExpressionUUID->"f41b3537-01d2-457f-85ff-506da7285b36"],
Cell[33815, 883, 268, 7, 44, "Input",ExpressionUUID->"86dd4bfb-07a9-4209-84e4-ea6fcb9adcec"],
Cell[34086, 892, 1186, 25, 44, "Input",ExpressionUUID->"62f57e79-d4a3-4f32-b1ff-f2054e6bdde8"],
Cell[35275, 919, 696, 16, 44, "Input",ExpressionUUID->"99813f40-9866-4024-9fc3-14db0011ea9e"],
Cell[35974, 937, 491, 11, 44, "Input",ExpressionUUID->"673a7164-ab37-4e8e-b555-d1b0cfb92034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36502, 953, 165, 3, 53, "Subsection",ExpressionUUID->"49951b2f-7f17-457d-8136-f692080bc7ef"],
Cell[36670, 958, 545, 14, 44, "Input",ExpressionUUID->"1c70612d-4c8f-4491-b3ac-952001753f62"],
Cell[37218, 974, 1161, 31, 83, "Input",ExpressionUUID->"97820d5c-3ad6-4ef7-96ce-88b0836d71f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38416, 1010, 159, 3, 53, "Subsection",ExpressionUUID->"e2f46879-7821-44c4-b4ac-ff860464262f"],
Cell[38578, 1015, 123, 2, 50, "Code",ExpressionUUID->"8ac50909-4090-4ab9-be12-f4aef7eeb06b"],
Cell[38704, 1019, 173, 3, 34, "Text",ExpressionUUID->"1fe00d46-c4d9-467c-ab34-5ae51e5a183b"],
Cell[38880, 1024, 787, 15, 140, "Input",ExpressionUUID->"d6f39f5d-d66a-4c35-9bfc-9753d61d8fb4"],
Cell[39670, 1041, 130, 2, 50, "Code",ExpressionUUID->"46523909-737f-46e8-b5f5-3182bf99a5ff"]
}, Open  ]]
}
]
*)

