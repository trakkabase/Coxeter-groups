(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    345718,       8525]
NotebookOptionsPosition[    326806,       8164]
NotebookOutlinePosition[    327147,       8179]
CellTagsIndexPosition[    327104,       8176]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Folding square complexes of RACGs", "Title",
 CellChangeTimes->{{3.819399998208827*^9, 
  3.819400011173802*^9}},ExpressionUUID->"c0592181-2bc2-40ff-8063-\
625e90e7c580"],

Cell["\<\
This notebook is designed to be compatible with the Coxeter groups notebook, \
ie a Coxeter group is specified by its Coxeter matrix, and elements of a \
Coxeter group are formatted as strings.We shall restrict to RACGs whose Davis \
complex is two dimensional, thus we will work only with square complexes. \
\>", "Text",
 CellChangeTimes->{{3.819455996102406*^9, 
  3.819456003955261*^9}},ExpressionUUID->"d5c460ef-276d-40cb-a9ff-\
62fca3d364c1"],

Cell[CellGroupData[{

Cell["Square Complexes", "Chapter",
 CellChangeTimes->{{3.819400024727724*^9, 
  3.819400027726778*^9}},ExpressionUUID->"7281204c-ae45-42a7-bd00-\
203577ee332d"],

Cell[CellGroupData[{

Cell["We will encode a square complex as an association", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191217145355616`*^9, 3.819121868895321*^9}, {
   3.819124152871351*^9, 3.8191241996718607`*^9}, {3.8191325536616616`*^9, 
   3.8191325610182962`*^9}, {3.819455985930497*^9, 3.8194559937614594`*^9}, 
   3.8432927901852303`*^9},ExpressionUUID->"884cfa5a-207c-40f8-b40b-\
c94e659c4dc8"],

Cell["\<\
<|\"vertices\" -> \"VertexList\", \"edges\" -> \"EdgeAssociation\", \"squares\
\" -> \"SquareAssociation\"|>\
\>", "CodeText",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191242123631516`*^9, 3.8191242273751316`*^9}, {
   3.819132565584857*^9, 3.819132644478142*^9}, {3.819132676305484*^9, 
   3.819132677427297*^9}, 3.819136611350916*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"faed99d7-aea1-4436-8b58-\
aa6a5f3b5ae7"],

Cell["\<\
where the first entry is a list of strings, each string being a vertex, eg\
\>", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191242398998985`*^9, 3.8191243023064346`*^9}, 
   3.8432927901868935`*^9},ExpressionUUID->"e6e3f7be-cbc4-4376-98f7-\
cdec57e14145"],

Cell["{\"v0\", \"v1\", \"v2\"}", "CodeText",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191243087740817`*^9, 3.8191243308468227`*^9}, {
   3.8191244377032185`*^9, 3.819124477694981*^9}, 3.819132655276885*^9, 
   3.819136624817054*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"1c96b662-9192-41bc-ac52-\
2daab7aabc0a"],

Cell["\<\
The second entry is an association of edge names with edge data, each edge \
being specified by two pieces of data 1) a list containing two vertices; and \
2) a string which should be a single generator of a Coxeter group, though of \
as the label of that edge. Thus an edge has the form\
\>", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.819124339676551*^9, 3.8191245196836777`*^9}, {
   3.819124746497061*^9, 3.8191247472027216`*^9}, {3.8191321811299005`*^9, 
   3.8191322464053354`*^9}, 3.8194554482499866`*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"67495eec-b796-49b0-b2a1-\
a4c2bb26c78d"],

Cell["\"e1\" -> {{\"v0\", \"v1\"}, \"a\"}", "CodeText",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191245363320255`*^9, 3.819124552410891*^9}, {
   3.8191322530231385`*^9, 3.8191322616776395`*^9}, 3.819136630024822*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"fb95d1d8-63fb-4f2c-ba24-\
3e19b309b397"],

Cell[TextData[{
 "We can naturally treat such an edge as being oriented from the vertex with \
smaller index to the one with larger index (where the edge is not a loop), so \
from \[OpenCurlyDoubleQuote]v0\[CloseCurlyDoubleQuote] to \
\[OpenCurlyDoubleQuote]v1\[CloseCurlyDoubleQuote] in this case. For the \
purpose of folding edges in the context of Coxeter groups, this orientation \
is ignored, however this can lead to ambiguity when folding an edge with an \
edge loop. In this implementation we ",
 StyleBox["always",
  FontSlant->"Italic"],
 " fold so that orientations match in this case. The place this becomes \
relevant is when computing the fundamental groups of square complexes, which \
are generated by the ",
 StyleBox["oriented",
  FontSlant->"Italic"],
 " edges.\nThe final part of the specification of a square complex is an \
association of square names with square data. Each square is specified by a \
list of the four edge names which bound the square. So a square looks like"
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191245851044064`*^9, 3.8191247538007975`*^9}, {
   3.8191322747171993`*^9, 3.8191323236311436`*^9}, {3.8194554017677445`*^9, 
   3.819455501300625*^9}, {3.8194555337714777`*^9, 3.8194556109458213`*^9}, {
   3.8194556525125484`*^9, 3.819455709228861*^9}, {3.819463304920203*^9, 
   3.8194633565150204`*^9}, 
   3.8432927901868935`*^9},ExpressionUUID->"80dc2ad9-f8fe-4ea7-a036-\
786059851d1a"],

Cell["\"s1\" -> {\"e0\", \"e1\", \"e2\", \"e3\"}", "CodeText",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191247624247274`*^9, 3.819124785427779*^9}, {
   3.819132326774296*^9, 3.8191323346689425`*^9}, 3.8191366352838907`*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"3b53e2f9-a34b-469d-912e-\
5dedf4c42674"],

Cell["\<\
Note that cyclically permuting the edges listed in a square, or reversing \
their order should not represent different squares. Again, orientations of \
edges can cause ambiguity in the case that part of the boundary of a square \
is mapped to an edge loop. In this implementation we will treat parallel \
boundary edges of a square as being oriented in the same direction, ie \
consistent with the product structure of the square.
Thus as an example, a square complex consisting of a single square would look \
as follows\
\>", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8191247924020405`*^9, 3.819124837227129*^9}, {
   3.8191326665122786`*^9, 3.81913271592561*^9}, {3.819455755309159*^9, 
   3.8194559592386994`*^9}, 
   3.8432927901868935`*^9},ExpressionUUID->"f0052d5d-30e1-497c-869b-\
d12b7bd0dccc"],

Cell["\<\
<|
 \"vertices\" -> {\"v0\", \"v1\", \"v2\", \"v3\"},
 \"edges\" -> <|\"e1\" -> {{\"v0\", \"v1\"}, \"a\"}, \"e2\" -> {{\"v1\", \"v2\
\"}, \"b\"}, \"e3\" -> {{\"v2\", \"v3\"}, \"a\"}, \"e4\" -> {{\"v3\", \
\"v0\"}, \"b\"}|>,
 \"squares\" -> <|\"s1\" -> {\"e1\", \"e2\", \"e3\", \"e4\"}|>
 |>\
\>", "CodeText",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.819132728909935*^9, 3.8191329275637016`*^9}, 
   3.8191366418159018`*^9, 
   3.8432927901868935`*^9},ExpressionUUID->"e168f076-4f37-4dab-86a4-\
b4f113f7bc5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic square complex functions", "Section",
 CellChangeTimes->{{3.819209879311034*^9, 
  3.8192098907349815`*^9}},ExpressionUUID->"8b2d407b-3a04-4f1f-8003-\
07117fe47118"],

Cell[CellGroupData[{

Cell["Square complex properties", "Subsection",
 CellChangeTimes->{{3.819302039603354*^9, 
  3.819302046078187*^9}},ExpressionUUID->"fe0d3314-4a93-4ac4-b359-\
45a83e658208"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxVertexIndex", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"-", "1"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxEdgeIndex", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Max", "[", " ", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", " ", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ",", "0"}], 
    "]"}], " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxSquareIndex", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Max", "[", " ", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", " ", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
     "0"}], "]"}], " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cubeCount", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<vertexCount\>\"", ",", "\"\<edgeCount\>\"", ",", 
      "\"\<squareCount\>\""}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "\"\<vertices\>\"", ",", "\"\<edges\>\"", ",", "\"\<squares\>\""}], 
      "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graphQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"squareComplex", "[", 
    RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "\[Equal]", 
   RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortKeys", "[", "keyList_", "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"keyList", ",", 
    RowBox[{
     RowBox[{"StringDrop", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193020862818265`*^9, 3.8193020865201826`*^9}, {
  3.81936072129313*^9, 3.8193607234528055`*^9}, {3.81982597523545*^9, 
  3.819826016451706*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d6aeecbc-4a98-48f4-b6fd-457c9baafd29"]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertex properties", "Subsection",
 CellChangeTimes->{{3.8193020993284883`*^9, 
  3.8193021145953493`*^9}},ExpressionUUID->"6574bbfb-0047-4614-83fa-\
2ed1d841659e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"incidentEdges", "[", 
   RowBox[{"squareComplex_", ",", "v1_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"edgeVertices", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], ",", "v1"}], "]"}], 
     "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidentEdges", "[", 
   RowBox[{"squareComplex_", ",", "v1_", ",", "edgelabel1_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"incidentEdges", "[", 
     RowBox[{"squareComplex", ",", "v1"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeLabel", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "\[Equal]", "edgelabel1"}],
      "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidentEdgeLabels", "[", 
   RowBox[{"squareComplex_", ",", "v1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"edgeLabel", "[", 
     RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"incidentEdges", "[", 
    RowBox[{"squareComplex", ",", "v1"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[7]:=",ExpressionUUID->"2a996f2f-eb5b-4b3b-a680-6275fe592046"]
}, Closed]],

Cell[CellGroupData[{

Cell["Edge properties", "Subsection",
 CellChangeTimes->{{3.819302138887339*^9, 
  3.819302142707697*^9}},ExpressionUUID->"d61beb70-b7d8-4f88-8540-\
dda0af60aadb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeLabel", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "[", 
    RowBox[{"[", "e1", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeVertices", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "[", 
    RowBox[{"[", "e1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialVertex", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"\"\<v\>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Min", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"edgeVertices", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"terminalVertex", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"\"\<v\>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"edgeVertices", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disjointEdgesQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"edgeVertices", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "]"}], "]"}], "\[Equal]", 
   "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidentSquares", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Keys", "[", " ", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", "e1"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidentSquareTypes", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"squareType", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"incidentSquares", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeEdgeQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"incidentSquares", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], "]"}], "\[Equal]", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeFaceQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentSquares", "[", 
      RowBox[{"squareComplex", ",", "e1"}], "]"}], "]"}], "\[Equal]", "1"}], "&&", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"incidentSquares", "[", 
           RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "\[Equal]", "e1"}], "&"}]}], "]"}], "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeLoopQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"edgeVertices", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"edgeVertices", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819302220868923*^9, 3.8193022210280085`*^9}, {
   3.8193667529075694`*^9, 3.8193667769593773`*^9}, {3.819367243363696*^9, 
   3.8193672953912215`*^9}, {3.819367338279459*^9, 3.81936734073099*^9}, {
   3.8193674399143257`*^9, 3.8193674525865617`*^9}, {3.819368930142131*^9, 
   3.819369117143651*^9}, 3.819369206577508*^9, {3.819379102692978*^9, 
   3.8193791027787514`*^9}, {3.8193791491230803`*^9, 3.819379247883883*^9}, {
   3.8194587310189357`*^9, 3.8194587778375826`*^9}, {3.819463377841672*^9, 
   3.8194634183256717`*^9}, {3.819463454291073*^9, 3.8194635021170907`*^9}, {
   3.8194635520821443`*^9, 3.819463634593213*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"c4f0ac6d-3f4e-4803-a598-be760e467173"]
}, Closed]],

Cell[CellGroupData[{

Cell["Square properties", "Subsection",
 CellChangeTimes->{{3.819302149339393*^9, 
  3.8193021527467384`*^9}},ExpressionUUID->"f6c7a115-f0aa-4a7c-a90a-\
37b4d78d7d23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareType", "[", 
   RowBox[{"squareComplex_", ",", "s1_"}], "]"}], ":=", 
  RowBox[{"Sort", "[", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeLabel", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", "s1", "]"}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squaresAdjacentQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{
    RowBox[{"Intersection", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "s1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "s2", "]"}], "]"}]}], "]"}], "\[Equal]", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundaryEqualQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"permutations", ",", "boundaryPermutations"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"permutations", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycles", "[", 
         RowBox[{"{", "}"}], "]"}], ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "}"}], "]"}], 
        ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "}"}], "}"}], "]"}], 
        ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"2", ",", "4"}], "}"}], "}"}], "]"}], ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "]"}], ",", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"boundaryPermutations", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Permute", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", "s1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
       "permutations"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"boundaryPermutations", ",", 
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "s2", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareVertices", "[", 
   RowBox[{"squareComplex_", ",", "s1_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeVertices", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", "s1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[20]:=",ExpressionUUID->"2fc0f5af-70c0-4c43-ab81-2f89a72f33ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Walls", "Subsection",
 CellChangeTimes->{{3.819368920612138*^9, 3.8193689245579233`*^9}, 
   3.8193691964846964`*^9},ExpressionUUID->"72e99d18-8a0f-4f72-a6c2-\
9f1111113988"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"elementaryParallelEdges", "[", 
   RowBox[{"squareComplex_", ",", "e1_String"}], "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"incidentSquares", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"edgeLabel", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}], "\[Equal]", 
       RowBox[{"edgeLabel", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}]}], "&&", 
      RowBox[{"Not", "[", 
       RowBox[{"e1", "\[Equal]", "#"}], "]"}]}], "&"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elementaryParallelEdges", "[", 
   RowBox[{"squareComplex_", ",", "eList_List"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"elementaryParallelEdges", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", "eList"}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parallelEdges", "[", 
   RowBox[{"squareComplex_", ",", "eList_List"}], "]"}], ":=", 
  RowBox[{"eList", "/;", 
   RowBox[{"SubsetQ", "[", 
    RowBox[{"eList", ",", 
     RowBox[{"elementaryParallelEdges", "[", 
      RowBox[{"squareComplex", ",", "eList"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parallelEdges", "[", 
   RowBox[{"squareComplex_", ",", "eList_List"}], "]"}], ":=", 
  RowBox[{"parallelEdges", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Join", "[", 
      RowBox[{"eList", ",", 
       RowBox[{"elementaryParallelEdges", "[", 
        RowBox[{"squareComplex", ",", "eList"}], "]"}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wall", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"parallelEdges", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"{", "e1", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wallSquares", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"incidentSquares", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"wall", "[", 
      RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wallReps", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"DeleteDuplicatesBy", "[", 
   RowBox[{
    RowBox[{"Keys", "[", " ", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
    RowBox[{
     RowBox[{"sortKeys", "[", 
      RowBox[{"wall", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "]"}], "&"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.819369209695654*^9, {3.8193692601038675`*^9, 3.8193695521756053`*^9}, {
   3.8193695975393305`*^9, 3.819369705133297*^9}, {3.819369776390339*^9, 
   3.819370063167799*^9}, {3.8193718749483037`*^9, 3.819371885299633*^9}, {
   3.8193720446748366`*^9, 3.8193720451209507`*^9}, {3.8193738178419313`*^9, 
   3.819373850262454*^9}, 3.819814550313902*^9, {3.819822688463601*^9, 
   3.81982270543286*^9}, {3.819825853835371*^9, 3.8198259524725447`*^9}, {
   3.819826031728368*^9, 3.819826061017498*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0933ed46-6358-4e14-a911-64bd530b8ecd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions on square complexes", "Subsection",
 CellChangeTimes->{{3.8193021643055325`*^9, 
  3.819302170629381*^9}},ExpressionUUID->"ea20c1da-d6f2-41fd-adec-\
c378a14c67c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deleteDuplicateVertices", "[", "vertexList_List", "]"}], ":=", 
  RowBox[{"DeleteDuplicatesBy", "[", 
   RowBox[{"vertexList", ",", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<v\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], "&"}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reindexToRelabel", "[", 
   RowBox[{"reindex_List", ",", "label_"}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"label", "<>", "#"}], "&"}], ",", 
     RowBox[{"KeyMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"label", "<>", "#"}], "&"}], ",", 
       RowBox[{"Association", "[", "reindex", "]"}]}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reindexVertices", "[", 
   RowBox[{"squareComplex_", ",", "reindexing_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "relabelledEdgeValues", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"relabelledEdgeValues", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"reindexToRelabel", "[", 
               RowBox[{"reindexing", ",", "\"\<v\>\""}], "]"}]}], "]"}], 
            "&"}], "/@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Values", "[", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#", ",", 
             RowBox[{"reindexToRelabel", "[", 
              RowBox[{"reindexing", ",", "\"\<v\>\""}], "]"}]}], "]"}], "&"}],
           "/@", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}], "\[Rule]", " ",
           "relabelledEdgeValues"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reindexEdges", "[", 
   RowBox[{"squareComplex_", ",", "reindexing_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"relabelledEdgeKeys", ",", "relabelledSquareValues"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"relabelledEdgeKeys", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"reindexToRelabel", "[", 
           RowBox[{"reindexing", ",", "\"\<e\>\""}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"relabelledSquareValues", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"reindexToRelabel", "[", 
             RowBox[{"reindexing", ",", "\"\<e\>\""}], "]"}]}], "]"}], "&"}], 
         "/@", "#"}], "&"}], "/@", 
       RowBox[{"Values", "[", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"relabelledEdgeKeys", "\[Rule]", 
          RowBox[{"Values", "[", 
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}], "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}], "\[Rule]", 
          "relabelledSquareValues"}], "]"}]}]}], "\[IndentingNewLine]", 
      "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reindexSquares", "[", 
   RowBox[{"squareComplex_", ",", "reindexing_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "relabelledSquareKeys", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"relabelledSquareKeys", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"reindexToRelabel", "[", 
           RowBox[{"reindexing", ",", "\"\<s\>\""}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{"relabelledSquareKeys", "\[Rule]", 
          RowBox[{"Values", "[", 
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relabelEdges", "[", 
   RowBox[{"squareComplex_", ",", "relabelling_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "newEdges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newEdges", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "relabelling"}], "]"}]}], 
         "}"}], "&"}], "/@", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", "newEdges"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"complexUnion", "[", 
    RowBox[{"squareComplex1_", ",", "squareComplex2_"}], "]"}], ":=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<vertices\>\"", "\[Rule]", 
      RowBox[{"deleteDuplicateVertices", "[", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"squareComplex1", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
         RowBox[{"squareComplex2", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<edges\>\"", "\[Rule]", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"squareComplex1", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
        RowBox[{"squareComplex2", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<squares\>\"", "\[Rule]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"squareComplex1", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
        RowBox[{"squareComplex2", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "gives", " ", "the", " ", "union", " ", "of", " ", "two", " ", "square", 
     " ", "complexes", " ", "with", " ", "vertices"}], ",", " ", "edges", ",",
     " ", 
    RowBox[{
    "and", " ", "squares", " ", "with", " ", "the", " ", "same", " ", "names",
      " ", 
     RowBox[{"identified", ".", " ", "Note"}], " ", "this", " ", "function", 
     " ", "will", " ", "delete", " ", "edges", " ", "or", " ", "squares", " ",
      "which", " ", "have", " ", "duplicate", " ", "names"}], ",", " ", 
    RowBox[{
    "regardless", " ", "of", " ", "whether", " ", "their", " ", "data", " ", 
     "is", " ", "the", " ", "same"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"complexUnion", "[", "cubeComplexList_List", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"complexUnion", ",", "cubeComplexList"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inducedSubcomplex", "[", 
   RowBox[{"squareComplex_", ",", "vertexSet_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edgeSet", ",", "squareSet"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edgeSet", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Keys", "[", " ", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
        RowBox[{
         RowBox[{"SubsetQ", "[", 
          RowBox[{"vertexSet", ",", 
           RowBox[{"edgeVertices", "[", 
            RowBox[{"squareComplex", ",", "#"}], "]"}]}], "]"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"squareSet", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Keys", "[", " ", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
        RowBox[{
         RowBox[{"SubsetQ", "[", " ", 
          RowBox[{"edgeSet", ",", 
           RowBox[{
            RowBox[{"squareComplex", "[", 
             RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", "vertexSet"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"KeyTake", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", "edgeSet"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"KeyTake", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", "squareSet"}], 
         "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wedge", "[", 
   RowBox[{"squareComplex1_", ",", "squareComplex2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vIndexShift", ",", "eIndexShift", ",", "sIndexShift", ",", "vIndexList",
       ",", "eIndexList", ",", "sIndexList", ",", "vReindexing", ",", 
      "eReindexing", ",", "sReindexing", ",", "reindexedSquareComplex"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vIndexShift", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"squareComplex1", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eIndexShift", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", 
         RowBox[{"squareComplex1", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sIndexShift", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringDrop", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", 
         RowBox[{"squareComplex1", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"vIndexList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"squareComplex2", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
         RowBox[{"{", "\"\<v0\>\"", "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eIndexList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", 
        RowBox[{"squareComplex2", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sIndexList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", 
        RowBox[{"squareComplex2", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vReindexing", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "\[Rule]", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "+", "vIndexShift"}], "]"}]}], "&"}], "/@", 
       "vIndexList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eReindexing", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "+", "eIndexShift"}], "]"}]}], "&"}], "/@", 
       "eIndexList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sReindexing", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "+", "sIndexShift"}], "]"}]}], "&"}], "/@", 
       "sIndexList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reindexedSquareComplex", "=", 
      RowBox[{"reindexSquares", "[", 
       RowBox[{
        RowBox[{"reindexEdges", "[", 
         RowBox[{
          RowBox[{"reindexVertices", "[", 
           RowBox[{"squareComplex2", ",", "vReindexing"}], "]"}], ",", 
          "eReindexing"}], "]"}], ",", "sReindexing"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"complexUnion", "[", 
      RowBox[{"squareComplex1", ",", "reindexedSquareComplex"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193021973283386`*^9, 3.8193021975780478`*^9}, {
  3.8198149482236943`*^9, 3.8198149484114513`*^9}, {3.8222082500880337`*^9, 
  3.822208460556078*^9}, {3.8222085770526285`*^9, 3.8222085938531137`*^9}, {
  3.8222096093423843`*^9, 3.8222101325421896`*^9}, {3.8222101806510506`*^9, 
  3.822210213106628*^9}, {3.822210252505188*^9, 3.8222102568023553`*^9}, {
  3.822213172406786*^9, 3.822213224308563*^9}, {3.8222132768662963`*^9, 
  3.8222132812802825`*^9}, {3.822213324614807*^9, 3.822213351697511*^9}, {
  3.822213392924556*^9, 3.8222136860319858`*^9}, {3.8222165214668703`*^9, 
  3.82221656373044*^9}, {3.822216773324172*^9, 3.8222168417869377`*^9}, {
  3.822219708420538*^9, 3.8222197392609034`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"df36fa4e-02b5-46b6-b773-5e6b1afdbe45"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructing a rose graph", "Section",
 CellChangeTimes->{{3.819110707808104*^9, 
  3.8191107152467136`*^9}},ExpressionUUID->"430d001c-0020-42a0-9ca3-\
8aa91cfeeaa6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wordToLoop", "[", "w_String", "]"}], ":=", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<vertices\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\"\<v\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"StringLength", "[", "w", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<edges\>\"", "\[Rule]", 
     RowBox[{"Association", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<e\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"i", "+", "1"}], "]"}]}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<v\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], ",", 
             RowBox[{"\"\<v\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", 
                 RowBox[{"StringLength", "[", "w", "]"}]}], "]"}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"w", ",", 
             RowBox[{"{", 
              RowBox[{"i", "+", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"StringLength", "[", "w", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<squares\>\"", "\[Rule]", 
     RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", 
   "|>"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wordToLoop", "[", 
   RowBox[{"w_String", ",", "vertexLabelShift_", ",", "edgeLabelShift_"}], 
   "]"}], ":=", 
  RowBox[{"reindexEdges", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reindexVertices", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wordToLoop", "[", "w", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "i", "]"}], "\[Rule]", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "+", "vertexLabelShift"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"StringLength", "[", "w", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", "i", "]"}], "\[Rule]", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{"i", "+", "edgeLabelShift"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"StringLength", "[", "w", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setToRose", "[", "wList_List", "]"}], ":=", 
  RowBox[{"complexUnion", "[", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wordToLoop", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"wList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", 
            RowBox[{"wList", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "-", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"i", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "each", " ", "word", " ", "shifts", " ", "the", " ", "index", " ", 
          "of", " ", "vertices", " ", "for", " ", "subsiquent", " ", "words", 
          " ", "by", " ", "one", " ", "less", " ", "than", " ", "their", " ", 
          "length"}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"this", " ", "is", " ", "the", " ", "total", " ", "off"}], 
         "-", "set"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringLength", "[", 
           RowBox[{"wList", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"i", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "each", " ", "word", " ", "shifts", " ", "the", " ", "index", " ", 
          "of", " ", "edges", " ", "for", " ", "subsequent", " ", "words", 
          " ", "by", " ", "length"}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"this", " ", "is", " ", "the", " ", "total", " ", "off"}], 
        "-", "set"}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "is", " ", "the", " ", "loop", " ", "for", " ", "the", " ",
        "ith", " ", "word", " ", "based", " ", "at", " ", "v0", " ", "with", 
       " ", "other", " ", "vertex", " ", "labels", " ", "correctly", " ", 
       "indexed"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "wList", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "list", " ", "of", " ", "all", " ", "loops", " ", 
      "corresponding", " ", "to", " ", "wList"}], ",", " ", 
     RowBox[{
     "disjoint", " ", "except", " ", "for", " ", "their", " ", "base", " ", 
      "vertices"}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819051252597322*^9, 3.8190512547821655`*^9}, {
   3.819051397613405*^9, 3.8190515112036247`*^9}, {3.8190517176293945`*^9, 
   3.8190519788613153`*^9}, {3.819052023791005*^9, 3.8190520919862204`*^9}, {
   3.819052498942374*^9, 3.8190526647379413`*^9}, {3.8190528322186027`*^9, 
   3.819052853580954*^9}, {3.819052918093172*^9, 3.8190529182586207`*^9}, {
   3.819052948327063*^9, 3.8190529608136063`*^9}, 3.819053093237131*^9, {
   3.819053367082847*^9, 3.819053370600806*^9}, {3.819053424641079*^9, 
   3.819053564321462*^9}, {3.819053595344829*^9, 3.819053710725584*^9}, {
   3.819053746633323*^9, 3.8190538792255936`*^9}, {3.819054291331024*^9, 
   3.819054396390381*^9}, {3.8191089653796115`*^9, 3.8191090016285577`*^9}, {
   3.819109032683512*^9, 3.8191091628528476`*^9}, {3.8191092067144337`*^9, 
   3.8191092296570272`*^9}, {3.8191093379065514`*^9, 
   3.8191094015236373`*^9}, {3.819109466469014*^9, 3.81910954011033*^9}, {
   3.8191096459048634`*^9, 3.8191098141202583`*^9}, {3.8191099317581253`*^9, 
   3.8191100104633226`*^9}, {3.819110279208232*^9, 3.8191102935912905`*^9}, {
   3.819117213638776*^9, 3.8191173528517456`*^9}, {3.819117393779749*^9, 
   3.8191174442421637`*^9}, {3.81911753699079*^9, 3.8191178406515193`*^9}, {
   3.819117886433525*^9, 3.819117908118581*^9}, {3.8191213497689724`*^9, 
   3.8191213568858767`*^9}, {3.8191252385099535`*^9, 
   3.8191252476763396`*^9}, {3.819132962585187*^9, 3.819132998892864*^9}, {
   3.819133034627741*^9, 3.8191330886910543`*^9}, {3.819133120667473*^9, 
   3.819133191748556*^9}, {3.8191332598458214`*^9, 3.8191332878249254`*^9}, {
   3.8191333245000305`*^9, 3.8191333366269703`*^9}, {3.819135200889018*^9, 
   3.8191352041941414`*^9}, {3.819135249021661*^9, 3.819135266975981*^9}, {
   3.819135345434692*^9, 3.8191353977964334`*^9}, {3.819135434793869*^9, 
   3.8191354538484383`*^9}, {3.8191355119259567`*^9, 
   3.8191355419828067`*^9}, {3.8191357602204733`*^9, 
   3.8191359756638365`*^9}, {3.8191361285562677`*^9, 
   3.8191361755708637`*^9}, {3.8191362114464664`*^9, 3.819136215705429*^9}, {
   3.8191362735708413`*^9, 3.8191363162978487`*^9}, {3.819136349204384*^9, 
   3.819136357624826*^9}, {3.81913641255243*^9, 3.8191364187438426`*^9}, {
   3.819136511845624*^9, 3.819136515782761*^9}, {3.81913682486692*^9, 
   3.819136829588896*^9}, {3.819137600116685*^9, 3.8191376699524918`*^9}, {
   3.8191379149383335`*^9, 3.819137941240797*^9}, {3.819137990438713*^9, 
   3.819138040897539*^9}, {3.81913811678062*^9, 3.8191383340909624`*^9}, {
   3.819179471400816*^9, 3.819179472787464*^9}, 3.8191795108877726`*^9, {
   3.8191795468966312`*^9, 3.8191795529133987`*^9}, {3.8191822860006156`*^9, 
   3.8191823368546977`*^9}, {3.819182398593734*^9, 3.8191823997253695`*^9}, {
   3.819182509936728*^9, 3.819182630196165*^9}, {3.819182671318037*^9, 
   3.81918280626322*^9}, {3.8191828711496387`*^9, 3.819182925493875*^9}, {
   3.819182999191214*^9, 3.819183321553889*^9}, {3.81918335561942*^9, 
   3.8191833570099754`*^9}, {3.819191538250749*^9, 3.8191915449132586`*^9}, {
   3.8191928455613737`*^9, 3.8191928464830155`*^9}, {3.8191960008959875`*^9, 
   3.8191960381052904`*^9}, {3.8192014102283006`*^9, 3.819201439033681*^9}, {
   3.8192098459910126`*^9, 3.819209846861549*^9}, {3.8192099028525023`*^9, 
   3.8192099298663425`*^9}, {3.819279790199871*^9, 3.8192797907244997`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"dda4ef83-975a-4c94-850c-2bb7a5d404b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Retractions of square complexes", "Section",
 CellChangeTimes->{{3.819359822774483*^9, 3.819359841545451*^9}, 
   3.819366493165245*^9},ExpressionUUID->"68c839cc-8cec-41d3-ab85-\
27575fb53983"],

Cell[CellGroupData[{

Cell["Deformation retractions of squares", "Subsection",
 CellChangeTimes->{{3.8193665898995514`*^9, 3.81936659373884*^9}, {
  3.8193669916659546`*^9, 
  3.819366994079484*^9}},ExpressionUUID->"30fc5afe-1e3b-402d-b20f-\
d3e298381c9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareRetractionPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"freeFaceQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", " ", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareDeformationRetraction", "[", "squareComplex_", "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Keys", "[", " ", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{
      RowBox[{"freeFaceQ", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], ",", "1"}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractSquare", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "sKey", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sKey", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Keys", "[", " ", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", "e1"}], "]"}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
          RowBox[{"{", "e1", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", "sKey"}], 
         "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractSquare", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"deformationRetractSquare", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
    "possibleSquareDeformationRetraction", "[", "squareComplex", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullSquareDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"squareRetractionPossibleQ", "[", "squareComplex", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullSquareDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"fullSquareDeformationRetraction", "[", 
   RowBox[{"deformationRetractSquare", "[", "squareComplex", "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193599314017057`*^9, 3.81936018272398*^9}, {
   3.819360246064743*^9, 3.8193606117829423`*^9}, 3.819360713655388*^9, {
   3.819366504712414*^9, 3.8193665653282766`*^9}, {3.819366746083705*^9, 
   3.819366747297737*^9}, {3.819366985545377*^9, 3.819367136386423*^9}, 
   3.8193681043294063`*^9, {3.8195279577911873`*^9, 3.8195279638702126`*^9}, {
   3.8195280409141455`*^9, 3.819528043289672*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"3a777bcd-eba2-4679-937d-58d9491d6277"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deformation retraction of edges", "Subsection",
 CellChangeTimes->{{3.819367174527583*^9, 3.8193671857133045`*^9}, {
  3.8193675331414423`*^9, 
  3.81936753319526*^9}},ExpressionUUID->"3023db2d-146d-4322-af10-\
793d021c8715"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeRetractionPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"edgeLoopQ", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "]"}], "&&", 
         RowBox[{"freeEdgeQ", "[", 
          RowBox[{"squareComplex", ",", "#"}], "]"}]}], "&"}], "/@", 
       RowBox[{"Keys", "[", " ", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleEdgeDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Keys", "[", " ", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"edgeLoopQ", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], "]"}], "&"}], ",", "1"}], 
    "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractEdge", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v1", ",", "v2", ",", "minvIndex", ",", "maxvIndex", ",", 
      "edgeDeleted"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v1", "=", 
      RowBox[{
       RowBox[{"edgeVertices", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{
       RowBox[{"edgeVertices", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"minvIndex", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"maxvIndex", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edgeDeleted", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "\[Rule]", " ", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", "e1"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reindexVertices", "[", 
      RowBox[{"edgeDeleted", ",", 
       RowBox[{"{", 
        RowBox[{"maxvIndex", "\[Rule]", "minvIndex"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractEdge", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"deformationRetractEdge", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
    "possibleEdgeDeformationRetraction", "[", "squareComplex", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullEdgeDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"edgeRetractionPossibleQ", "[", "squareComplex", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullEdgeDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"fullEdgeDeformationRetraction", "[", 
   RowBox[{"deformationRetractEdge", "[", "squareComplex", "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819367550299428*^9, 3.8193679842002087`*^9}, {
   3.8193680294080486`*^9, 3.8193681259050226`*^9}, {3.8193681864894876`*^9, 
   3.8193681866046677`*^9}, {3.819368242956313*^9, 3.8193682661243777`*^9}, {
   3.819368630931116*^9, 3.819368733054167*^9}, 3.8193688003812637`*^9, {
   3.819527982601605*^9, 3.8195279952753124`*^9}, {3.8195280339706335`*^9, 
   3.819528036430663*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c715ca63-8720-40a0-ad87-a2646cd2db05"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deformation retraction of walls", "Subsection",
 CellChangeTimes->{{3.819366699099351*^9, 3.8193667061388865`*^9}, {
  3.8193720577865477`*^9, 
  3.819372067070649*^9}},ExpressionUUID->"d29f9d81-b0ab-4c4e-bc82-\
8c0a035c938e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wallRetractableQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"edgeLoopQ", "[", 
          RowBox[{"squareComplex", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"wall", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wallRetractionPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"wallRetractableQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", " ", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleWallDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Keys", "[", " ", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
     RowBox[{
      RowBox[{"wallRetractableQ", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], ",", "1"}], "]"}], 
   "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractWall", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "wall1", ",", "wallSquares1", ",", "wallLabel", ",", "finalFolds", ",", 
       "squaresDeleted", ",", "wallRetracted"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wall1", "=", 
       RowBox[{"wall", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "list", " ", "of", " ", "edges", " ", "in", "  ", "the", " ", "wall", 
        " ", "containing", " ", "e1"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wallSquares1", "=", 
       RowBox[{"wallSquares", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "list", " ", "of", " ", "squares", " ", "appearing", " ", "in", " ", 
        "the", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wallLabel", "=", 
       RowBox[{"edgeLabel", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"squaresDeleted", "=", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<vertices\>\"", "\[Rule]", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<edges\>\"", "\[Rule]", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<squares\>\"", "\[Rule]", 
          RowBox[{"KeyDrop", "[", 
           RowBox[{
            RowBox[{"squareComplex", "[", 
             RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
            "wallSquares1"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "result", " ", "of", " ", "deleting", " ", "the", " ", 
        "interiors", " ", "of", " ", "all", " ", "squares", " ", "along", " ",
         "the", " ", "wall"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wallRetracted", "=", 
       RowBox[{"Fold", "[", "\[IndentingNewLine]", 
        RowBox[{
        "deformationRetractEdge", ",", "\[IndentingNewLine]", 
         "squaresDeleted", ",", "\[IndentingNewLine]", "wall1"}], 
        "\[IndentingNewLine]", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "resul", " ", "of", " ", "then", " ", "retracting", " ", 
        "all", " ", "edges", " ", "along", " ", "the", " ", "wall"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"finalFolds", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{
               RowBox[{"edgeLabel", "[", 
                RowBox[{"squareComplex", ",", "#"}], "]"}], "\[Equal]", 
               "wallLabel"}], "]"}], "&"}]}], "]"}], "&"}], "/@", 
         "wallSquares1"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "list", " ", "of", " ", "all", " ", "type", " ", "II", " ", "folds", 
        " ", "which", " ", "now", " ", "have", " ", "to", " ", "be", " ", 
        "done"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Fold", "[", "\[IndentingNewLine]", 
       RowBox[{
       "edgeFold", ",", "\[IndentingNewLine]", "wallRetracted", ",", 
        "\[IndentingNewLine]", "finalFolds"}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"freeEdgeQ", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractWall", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"deformationRetractEdge", "[", 
   RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deformationRetractWall", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"deformationRetractWall", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
    "possibleWallDeformationRetraction", "[", "squareComplex", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullWallDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"wallRetractionPossibleQ", "[", "squareComplex", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullWallDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"fullWallDeformationRetraction", "[", 
   RowBox[{"deformationRetractWall", "[", "squareComplex", "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193657546452436`*^9, 3.8193657672563624`*^9}, 
   3.8193667403516235`*^9, {3.8193720693032303`*^9, 3.8193720706322217`*^9}, {
   3.8193721261703863`*^9, 3.819372185862502*^9}, {3.819372527576626*^9, 
   3.8193729074141946`*^9}, {3.819372952442457*^9, 3.819373043639534*^9}, {
   3.8193730770435777`*^9, 3.819373199768612*^9}, {3.8193734690610523`*^9, 
   3.8193737737400336`*^9}, {3.819373856460163*^9, 3.819374009574706*^9}, {
   3.8193743006019077`*^9, 3.819374305426428*^9}, {3.8193743393676*^9, 
   3.819374340857688*^9}, {3.819528005766532*^9, 3.8195280275050545`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"3ffd6460-0bb3-4c94-b4a9-5c4bcef55e91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Deformation retraction and pruning square complexes", "Subsection",
 CellChangeTimes->{{3.8193785584040523`*^9, 
  3.8193785844861546`*^9}},ExpressionUUID->"37d1ea17-ebed-4c40-8e0c-\
edc11e026222"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullDeformationRetraction", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"fullWallDeformationRetraction", "[", 
   RowBox[{"fullSquareDeformationRetraction", "[", "squareComplex", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pruneEdgeLoops", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "prunableEdges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prunableEdges", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeLoopQ", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "&&", 
          RowBox[{"freeEdgeQ", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"KeyDrop", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", "prunableEdges"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullDeformationRetractionAndPruning", "[", "squareComplex_", "]"}],
   ":=", 
  RowBox[{"pruneEdgeLoops", "[", 
   RowBox[{"fullDeformationRetraction", "[", "squareComplex", "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193785899311447`*^9, 3.8193786035341835`*^9}, {
  3.8193786457705355`*^9, 3.819378905938436*^9}, {3.8193789518314285`*^9, 
  3.8193789554684954`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"ebece2f7-5c7a-4dc2-8ebe-4f9d1fc30670"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Topology of square complexes", "Section",
 CellChangeTimes->{{3.8198127141247563`*^9, 
  3.8198127212817535`*^9}},ExpressionUUID->"5fbda290-5847-4e02-997a-\
5e0a86ea34bc"],

Cell[CellGroupData[{

Cell["Connectedness", "Subsection",
 CellChangeTimes->{{3.8198127394195538`*^9, 
  3.8198127586900263`*^9}},ExpressionUUID->"9202fadd-112a-4a09-ab2c-\
16292e3742a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"neighbouringVertices", "[", 
   RowBox[{"squareComplex_", ",", "v1_String"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"edgeVertices", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"incidentEdges", "[", 
      RowBox[{"squareComplex", ",", "v1"}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neighbouringVertices", "[", 
   RowBox[{"squareComplex_", ",", "vertexSet_List"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"neighbouringVertices", "[", 
       RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", "vertexSet"}],
     "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectedComponent", "[", 
   RowBox[{"squareComplex_", ",", "vertexSet_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"inducedSubcomplex", "[", 
    RowBox[{"squareComplex", ",", "vertexSet"}], "]"}], "/;", 
   RowBox[{"ContainsExactly", "[", 
    RowBox[{
     RowBox[{"neighbouringVertices", "[", 
      RowBox[{"squareComplex", ",", "vertexSet"}], "]"}], ",", "vertexSet"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectedComponent", "[", 
   RowBox[{"squareComplex_", ",", "vertexSet_"}], "]"}], ":=", 
  RowBox[{"connectedComponent", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"neighbouringVertices", "[", 
     RowBox[{"squareComplex", ",", "vertexSet"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ContainsExactly", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"connectedComponent", "[", 
       RowBox[{"squareComplex", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], "]"}], "/;", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", "]"}], "\[Equal]", 
     "0"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"connectedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberComponents", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"n_:", "0"}]}], "]"}], ":=", 
  RowBox[{"0", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberComponents", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"n_:", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"n", "+", "1"}], "/;", 
   RowBox[{
    RowBox[{"connectedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{"Not", "[", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", "]"}], "\[Equal]",
       "0"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberComponents", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"n_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"component1", ",", "componentRemoved"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"component1", "=", 
      RowBox[{"connectedComponent", "[", 
       RowBox[{"squareComplex", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"componentRemoved", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
           RowBox[{"component1", "[", 
            RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], " ", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "\[Rule]", 
         RowBox[{"KeyComplement", "[", 
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"component1", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"KeyComplement", "[", 
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
           RowBox[{"component1", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numberComponents", "[", 
      RowBox[{"componentRemoved", ",", 
       RowBox[{"n", "+", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8198127841951723`*^9, 3.819812840129653*^9}, {
  3.8198128947670217`*^9, 3.8198129491287727`*^9}, {3.819812997944654*^9, 
  3.8198132545180283`*^9}, {3.8198132877664185`*^9, 3.8198133565298643`*^9}, {
  3.8198134266138268`*^9, 3.8198135665492067`*^9}, {3.819813679586342*^9, 
  3.8198139650833254`*^9}, {3.8198149448738613`*^9, 3.8198149459518967`*^9}, {
  3.822074904149959*^9, 3.8220749874529824`*^9}, {3.822075025553372*^9, 
  3.8220751317952375`*^9}, {3.822075163121026*^9, 3.822075243797371*^9}, {
  3.822075393346945*^9, 3.822075476891305*^9}, {3.8220808965485163`*^9, 
  3.8220809513580666`*^9}, {3.8220819354727535`*^9, 3.8220819585426774`*^9}, {
  3.822082325397463*^9, 3.8220823778459406`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c4573fac-19fd-4ed6-a0f7-625f957e1d05"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cut vertices", "Subsection",
 CellChangeTimes->{{3.819813582118788*^9, 3.8198135936664944`*^9}, {
  3.8198139839334545`*^9, 
  3.8198139946890345`*^9}},ExpressionUUID->"78e00cfa-51fb-4888-9707-\
72a5b591940e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cutVertexQ", "[", 
   RowBox[{"squareComplex_", ",", "v1_"}], "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{"connectedQ", "[", "\[IndentingNewLine]", 
    RowBox[{"inducedSubcomplex", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
        RowBox[{"{", "v1", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutVertices", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"cutVertexQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"containsCutVertexQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"cutVertices", "[", "squareComplex", "]"}], "]"}], ">", 
   "0"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819814015779403*^9, 3.819814146681485*^9}, {
  3.81981418638908*^9, 3.8198142682725697`*^9}, {3.8198143420020437`*^9, 
  3.819814347311536*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"616e1a69-d624-4ad6-a53f-57f1ce994a2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cut walls", "Subsection",
 CellChangeTimes->{{3.819814961787747*^9, 
  3.819814981321138*^9}},ExpressionUUID->"75ef1c7d-ca9a-4a4d-8e9f-\
1400bad63b5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wallCarrier", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vertexSet", ",", "squareSet", ",", "edgeSet"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertexSet", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"wall", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"squareSet", "=", 
      RowBox[{"wallSquares", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgeSet", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "e1", "}"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "squareSet"}], 
          "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", "vertexSet"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"KeyTake", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", "edgeSet"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"KeyTake", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", "squareSet"}], 
         "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wallCollapsableQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"fundamentalGroupPresentation", "[", 
    RowBox[{"wallCarrier", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<generators\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<relations\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], 
    "\[RightAssociation]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"containsCollapableWallQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"wallCollapsableQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"wallReps", "[", "squareComplex", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutWallQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{"connectedQ", "[", "\[IndentingNewLine]", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<vertices\>\"", "\[Rule]", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<edges\>\"", "\[Rule]", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
         RowBox[{"wall", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<squares\>\"", "\[Rule]", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
         RowBox[{"wallSquares", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "\[IndentingNewLine]", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cutWalls", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"wallReps", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"cutWallQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"containsCutWallQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"cutWalls", "[", "squareComplex", "]"}], "]"}], ">", 
   "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wallTwoSidedQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"cutWallQ", "[", 
   RowBox[{
    RowBox[{"wallCarrier", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", "e1"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/fFKJv+O0jeOpU+1ZUC0kJGcAojmSfmjAqKdjqzT
BNH3euNNQXSfwzkbEO1xQc4JRMtnzPQE0asLe0NB9I9ExmgQPe3ujAQQvf2h
UgmIvsZQXQeic7ZenACifVamTwLRbPnbZoBoGbWrC0D03s2nlu4E0v96gpaB
6JCa++tBtEhh6AYQHWW8/vBuIK2kKX8URHPM0Dq/B0ibvcu8CKKlFrGE7AXS
R37bhYLog4ZlJSD6kNuZShBd69pfC6JV3iZMAdETfB3ngGi5X09WgOhZFce2
g+gCu9bdIFqs3ng2W9UbxycP6ueAaABcwKN+
  "],
 CellLabel->"In[79]:=",ExpressionUUID->"284136c3-a375-421b-ab58-005a905808a0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Surface topology", "Subsection",
 CellChangeTimes->{{3.8220731028820076`*^9, 
  3.8220731061865416`*^9}},ExpressionUUID->"428f9184-0b4b-4f15-835d-\
827d995bfc71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surfaceQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], 
    "\[GreaterEqual]", " ", "1"}], "&&", " ", 
   RowBox[{"Fold", "[", 
    RowBox[{"And", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"Length", "[", 
            RowBox[{"incidentSquares", "[", 
             RowBox[{"squareComplex", ",", "#"}], "]"}], "]"}]}], "]"}], 
         "&"}], "/@", 
        RowBox[{"Keys", "[", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True"}], "}"}]}], "]"}]}], " ", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eulerCharacteristic", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", "]"}], "-", 
   RowBox[{"Length", "[", 
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], "+", 
   RowBox[{"Length", "[", 
    RowBox[{"squareComplex", "[", 
     RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfaceClosedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{
        RowBox[{"freeFaceQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], "]"}], "]"}], 
    "\[Equal]", "0"}], "/;", 
   RowBox[{"surfaceQ", "[", "squareComplex", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfaceBoundary", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edgeKeys", ",", "vertices"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgeKeys", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Keys", "[", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
         RowBox[{
          RowBox[{"freeFaceQ", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vertices", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"edgeVertices", "[", 
            RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
          "edgeKeys"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", "vertices"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "\[Rule]", 
         RowBox[{"KeySelect", "[", 
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"edgeKeys", ",", "#"}], "]"}], "&"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"surfaceClosedQ", "[", "squareComplex", "]"}], "]"}], "&&", 
    RowBox[{
    "surfaceQ", "[", "squareComplex", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfaceBoundary", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<vertices\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"\"\<edges\>\"", "\[Rule]", 
      RowBox[{"<|", "|>"}]}], ",", 
     RowBox[{"\"\<squares\>\"", "\[Rule]", 
      RowBox[{"<|", "|>"}]}]}], "|>"}], "/;", 
   RowBox[{
    RowBox[{"surfaceClosedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{
    "surfaceQ", "[", "squareComplex", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberBoundaries", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"numberBoundaries", "[", "squareComplex", "]"}], "=", 
   RowBox[{"numberComponents", "[", 
    RowBox[{"surfaceBoundary", "[", "squareComplex", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orientableQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"wallTwoSidedQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"wallReps", "[", "squareComplex", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genus", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "-", 
      RowBox[{"eulerCharacteristic", "[", "squareComplex", "]"}], "-", 
      RowBox[{"numberBoundaries", "[", "squareComplex", "]"}]}], ")"}], "/", 
    "2"}], "/;", 
   RowBox[{
    RowBox[{"surfaceQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{
    "orientableQ", "[", "squareComplex", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossCaps", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"2", "-", 
    RowBox[{"eulerCharacteristic", "[", "squareComplex", "]"}], "-", 
    RowBox[{"numberBoundaries", "[", "squareComplex", "]"}]}], "/;", 
   RowBox[{
    RowBox[{"surfaceQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{"Not", "[", 
     RowBox[{"orientableQ", "[", "squareComplex", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"surfaceClassification", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"surfaceQ", "[", "squareComplex", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orientableQ", "[", "squareComplex", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Orientable surface with Euler characteristic \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"eulerCharacteristic", "[", "squareComplex", "]"}], "]"}], 
        "<>", "\"\<, genus \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"genus", "[", "squareComplex", "]"}], "]"}], "<>", 
        "\"\<, and \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"numberBoundaries", "[", "squareComplex", "]"}], "]"}], 
        "<>", "\"\< boundary component(s)\>\""}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Non-orientable surface with Euler characteristic \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"eulerCharacteristic", "[", "squareComplex", "]"}], "]"}], 
        "<>", "\"\<, \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"crossCaps", "[", "squareComplex", "]"}], "]"}], "<>", 
        "\"\< cross-cap(s), and \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"numberBoundaries", "[", "squareComplex", "]"}], "]"}], 
        "<>", "\"\< boundary component(s)\>\""}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Not a surface\>\"", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822073112412383*^9, 3.822073229285418*^9}, {
   3.8220732626662073`*^9, 3.822073411129365*^9}, {3.8220734640918107`*^9, 
   3.82207353178179*^9}, {3.822073564480816*^9, 3.8220735889230223`*^9}, {
   3.8220736690167828`*^9, 3.8220736973203363`*^9}, {3.8220738059798183`*^9, 
   3.822073869698619*^9}, {3.822073937203291*^9, 3.822073967140395*^9}, {
   3.822074020494171*^9, 3.8220741159977694`*^9}, {3.8220741478499985`*^9, 
   3.8220742616203413`*^9}, {3.8220743856198635`*^9, 3.822074465742543*^9}, {
   3.822074499472009*^9, 3.8220745233666873`*^9}, {3.822074636220107*^9, 
   3.822074652520238*^9}, {3.8220746827839785`*^9, 3.822074686541337*^9}, 
   3.8220747466864347`*^9, {3.8220747879846396`*^9, 3.8220748145752144`*^9}, {
   3.822080840867742*^9, 3.8220808539734898`*^9}, {3.8220809681551704`*^9, 
   3.82208098291514*^9}, {3.822081097362954*^9, 3.8220811708999853`*^9}, {
   3.822081210390137*^9, 3.822081359397128*^9}, {3.8220814017002788`*^9, 
   3.822081776536231*^9}, {3.8220824739953723`*^9, 3.822082474187377*^9}, {
   3.8221637827667913`*^9, 3.822163793706416*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"1b95cab2-4a8c-43fb-9a86-335dde4e8579"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Free groups and fundamental groups", "Chapter",
 CellChangeTimes->{{3.81939988942941*^9, 3.819399898774957*^9}, {
  3.819706879607254*^9, 
  3.8197069021372085`*^9}},ExpressionUUID->"ecbd4324-6ed4-4710-9c15-\
f3e71f502ab0"],

Cell[CellGroupData[{

Cell["Basic functions in groups", "Section",
 CellChangeTimes->{{3.819399915739773*^9, 
  3.8193999349219675`*^9}},ExpressionUUID->"cb721450-5317-4952-a0ca-\
cfb01ffe944e"],

Cell["\<\
We will represent elements of groups as strings whose characters are treated \
as the generators of the group. In the case of non-Coxeter groups where a \
generator may be distinct from its inverse, the generators will be lower case \
letters, and their inverses the corresponding upper case letters. We will be \
working a lot with automorphisms of free groups. An automorphism is \
determined by its effect on the generators of a group, and hence we will \
represent automorphisms by associations whose keys are the generators of the \
group, and whose values are the images of those generators under the \
automorphism:\
\>", "Text",
 CellChangeTimes->{{3.8195674108016486`*^9, 
  3.819567602001297*^9}},ExpressionUUID->"cf6253f5-f674-4483-afd3-\
392f6dfcc078"],

Cell["<| \[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]aB\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]b\
\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]Cbc\[CloseCurlyDoubleQuote], \[OpenCurlyDoubleQuote]c\
\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]Ac\[CloseCurlyDoubleQuote]|>", "CodeText",
 CellChangeTimes->{{3.8195676129360437`*^9, 
  3.8195676652806787`*^9}},ExpressionUUID->"2587533a-d0d5-4d73-84ec-\
4aba3d567f54"],

Cell[CellGroupData[{

Cell["Functions which apply to generators", "Subsection",
 CellChangeTimes->{{3.8194837944950495`*^9, 
  3.8194838002580247`*^9}},ExpressionUUID->"b999f5b5-6930-475b-bf7b-\
3abb948aeef4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inverse", "[", "generator_", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LowerCaseQ", "[", "generator", "]"}], ",", 
     RowBox[{"ToUpperCase", "[", "generator", "]"}], ",", 
     RowBox[{"ToLowerCase", "[", "generator", "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"StringLength", "[", "generator", "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gen", "[", 
   RowBox[{"generator_", ",", "\"\<0\>\""}], "]"}], ":=", 
  "generator"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gen", "[", 
   RowBox[{"generator_", ",", "\"\<1\>\""}], "]"}], ":=", 
  RowBox[{"ToUpperCase", "[", "generator", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8183380068685274`*^9, 3.8183380225588207`*^9}, {
   3.8183380740455503`*^9, 3.8183381255419025`*^9}, {3.818338156482957*^9, 
   3.818338343377963*^9}, {3.8183383835672245`*^9, 3.8183383967803984`*^9}, {
   3.818338461166533*^9, 3.8183384770612893`*^9}, {3.818338705440585*^9, 
   3.8183388287065897`*^9}, {3.8183388647735095`*^9, 
   3.8183388715277634`*^9}, {3.8183389129586945`*^9, 
   3.8183389634282494`*^9}, {3.818339144714615*^9, 3.8183391545228677`*^9}, {
   3.8183392121485133`*^9, 3.8183392464057083`*^9}, {3.818339291997837*^9, 
   3.818339439066407*^9}, {3.818339499355421*^9, 3.8183396529177523`*^9}, {
   3.818339894164652*^9, 3.8183399162277875`*^9}, {3.818340016302007*^9, 
   3.8183400851893125`*^9}, {3.8183401268115044`*^9, 3.8183401723186255`*^9}, 
   3.81834063563621*^9, {3.8183406755882244`*^9, 3.8183409208788586`*^9}, {
   3.8183409618235817`*^9, 3.8183410321435213`*^9}, {3.8183410815538735`*^9, 
   3.8183410890821743`*^9}, {3.8183411454189854`*^9, 3.818341146094988*^9}, {
   3.8194837492348323`*^9, 3.8194837524391336`*^9}, {3.8194842443822823`*^9, 
   3.8194842554920444`*^9}, 3.8194848572966948`*^9, 3.8194849367791557`*^9, {
   3.8194863114350915`*^9, 3.819486382627077*^9}, 3.8194864294974976`*^9, {
   3.81953191618361*^9, 3.8195319379118085`*^9}, {3.819545623975994*^9, 
   3.8195456243645763`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"d8c962d1-daba-47b0-9481-e3cd870ae812"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions which apply to words", "Subsection",
 CellChangeTimes->{{3.819483780483277*^9, 
  3.819483786860939*^9}},ExpressionUUID->"7d927834-75f2-46f3-82a3-\
bc1bd2b9a0d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inverse", "[", "word_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringReverse", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"inverse", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"word", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"StringLength", "[", "word", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"StringLength", "[", "word", "]"}], ">", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inverse", "[", "\"\<\>\"", "]"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyReducedQ", "[", "word_", "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{"Or", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"word", ",", 
            RowBox[{"{", "i", "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"inverse", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"word", ",", 
             RowBox[{"{", 
              RowBox[{"i", "+", "1"}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"StringLength", "[", "word", "]"}], "-", "1"}]}], "}"}]}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cyclicallyReducedQ", "[", "\"\<\>\"", "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclicallyReducedQ", "[", "word_", "]"}], ":=", 
  RowBox[{
   RowBox[{"freelyReducedQ", "[", "word", "]"}], "&&", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"word", ",", "1"}], "]"}], "\[Equal]", 
     RowBox[{"inverse", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"word", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyReduce", "[", "word_", "]"}], ":=", 
  RowBox[{"word", "/;", 
   RowBox[{"freelyReducedQ", "[", "word", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyReduce", "[", "word_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "position", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"position", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"StringLength", "[", "word", "]"}], "-", "1"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"word", ",", 
             RowBox[{"{", "#", "}"}]}], "]"}], "\[Equal]", 
           RowBox[{"inverse", "[", 
            RowBox[{"StringTake", "[", 
             RowBox[{"word", ",", 
              RowBox[{"{", 
               RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "]"}]}], "&"}], ",", 
         "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"freelyReduce", "[", 
      RowBox[{"StringDrop", "[", 
       RowBox[{"word", ",", 
        RowBox[{"{", 
         RowBox[{"position", ",", 
          RowBox[{"position", "+", "1"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyReducedLength", "[", "word_", "]"}], ":=", 
  RowBox[{
   RowBox[{"freelyReducedLength", "[", "word", "]"}], "=", 
   RowBox[{"StringLength", "[", 
    RowBox[{"freelyReduce", "[", "word", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclicallyReduce", "[", "word_String", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cyclicallyReducedQ", "[", "word", "]"}], ",", 
    "\[IndentingNewLine]", "word", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"freelyReducedQ", "[", "word", "]"}], "&&", 
       RowBox[{"Not", "[", 
        RowBox[{"cyclicallyReducedQ", "[", "word", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cyclicallyReduce", "[", 
       RowBox[{"StringTake", "[", 
        RowBox[{"word", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"StringLength", "[", "word", "]"}], "-", "1"}]}], "}"}]}],
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"cyclicallyReduce", "[", 
       RowBox[{"freelyReduce", "[", "word", "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclicallyReducedLength", "[", "word_String", "]"}], ":=", 
  RowBox[{
   RowBox[{"cyclicallyReducedLength", "[", "word", "]"}], "=", 
   RowBox[{"StringLength", "[", 
    RowBox[{"cyclicallyReduce", "[", "word", "]"}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819484264943878*^9, 3.819484272658114*^9}, {
  3.8194844546868067`*^9, 3.819484693452935*^9}, {3.8194865081497416`*^9, 
  3.8194865608381033`*^9}, {3.8194865980126357`*^9, 3.819486727690874*^9}, {
  3.8194868744647493`*^9, 3.819486980826006*^9}, {3.8194870582345743`*^9, 
  3.8194870990112705`*^9}, {3.8194871626601152`*^9, 3.8194871645567265`*^9}, {
  3.819545662753811*^9, 3.8195457060253363`*^9}, {3.819545742944687*^9, 
  3.8195457680129356`*^9}, {3.8195471509512396`*^9, 3.819547178258159*^9}, {
  3.819618331163142*^9, 3.8196184901489267`*^9}, {3.8196185387615595`*^9, 
  3.8196185760495095`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"e74bf74f-be66-4243-a06e-ad1234cdce44"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Whitehead automorphisms", "Section",
 CellChangeTimes->{{3.8193999612336893`*^9, 3.819399969113657*^9}, {
  3.819400146907984*^9, 
  3.8194001498958545`*^9}},ExpressionUUID->"f05c9f81-f86a-473a-bca6-\
afd9a1f34c70"],

Cell[CellGroupData[{

Cell["Whitehead automorphisms of type I", "Subsection",
 CellChangeTimes->{{3.818341173170806*^9, 
  3.8183411864880476`*^9}},ExpressionUUID->"e4716def-cbaa-40ff-866f-\
69090320216d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"autI", "[", 
   RowBox[{"generators_", ",", "permutation_", ",", " ", "binary_"}], "]"}], ":=", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"generators", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
      RowBox[{"gen", "[", " ", 
       RowBox[{
        RowBox[{"generators", "[", 
         RowBox[{"[", " ", 
          RowBox[{"PermutationReplace", "[", 
           RowBox[{"i", ",", "permutation"}], "]"}], " ", "]"}], "]"}], ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"binary", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "generators", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permutations", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"PermutationCycles", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"Permutations", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "generators", "]"}]}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binaryNumbers", "[", "length_", "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Fold", "[", 
       RowBox[{"StringJoin", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<0\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "length"}], "}"}]}], "]"}]}], "]"}], 
      "]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"Fold", "[", 
              RowBox[{"StringJoin", ",", 
               RowBox[{"Table", "[", 
                RowBox[{"\"\<0\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"length", "-", "n"}]}], "}"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"BaseForm", "[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "n"}], "]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"2", "^", "n"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"length", "-", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"BaseForm", "[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "length"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"length", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"2", "^", "length"}], "-", "1"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"autIParameters", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<permutation\>\"", ",", "\"\<binary\>\""}], "}"}], ",", 
      "#"}], "]"}], "&"}], "/@", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"permutations", "[", "generators", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"binaryNumbers", "[", 
             RowBox[{"Length", "[", "generators", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"permutations", "[", "generators", "]"}], "]"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"binaryNumbers", "[", 
           RowBox[{"Length", "[", "generators", "]"}], "]"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAutI", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{"allAutI", "[", "generators", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"autI", "[", 
      RowBox[{"generators", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "\"\<permutation\>\"", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "\"\<binary\>\"", "]"}], "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{
    "autIParameters", "[", "generators", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allAutI", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8183410941243644`*^9, 3.818341131613578*^9}, {
   3.8183413266425743`*^9, 3.818341378791751*^9}, {3.8183415826304584`*^9, 
   3.81834159930158*^9}, {3.818341710384632*^9, 3.8183417701619024`*^9}, {
   3.818341809257554*^9, 3.818341902250733*^9}, {3.8183419330375757`*^9, 
   3.818342484709029*^9}, {3.818342569699154*^9, 3.8183425900465217`*^9}, {
   3.8183426231016345`*^9, 3.8183426292680206`*^9}, {3.81834267439808*^9, 
   3.8183426880168085`*^9}, {3.8183427814380493`*^9, 3.818342889620556*^9}, 
   3.818342926940535*^9, {3.8183501231751895`*^9, 3.8183501649073*^9}, {
   3.8183502296897783`*^9, 3.8183502314134855`*^9}, {3.8183507202840557`*^9, 
   3.818350724339325*^9}, {3.8195317326005383`*^9, 3.819531739667*^9}, {
   3.8195318125185895`*^9, 3.819531856921976*^9}, {3.819531954493578*^9, 
   3.819532221691397*^9}, {3.819532448890997*^9, 3.8195324551012707`*^9}, {
   3.8195325241115212`*^9, 3.819532526934664*^9}, {3.819548062186367*^9, 
   3.8195480643530455`*^9}, {3.819568695344536*^9, 3.8195687138338475`*^9}, {
   3.819568869879157*^9, 3.819568935065205*^9}, {3.8196507660409374`*^9, 
   3.8196507687395477`*^9}, 3.8196523313548717`*^9, {3.8196524243011613`*^9, 
   3.819652427158451*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"d5f97de8-1918-42df-ad64-cfbdadd8bf53"]
}, Closed]],

Cell[CellGroupData[{

Cell["Whitehead automorphisms of type II", "Subsection",
 CellChangeTimes->{{3.818341196153842*^9, 
  3.818341205010419*^9}},ExpressionUUID->"93a5fc62-fa33-41fb-af3c-\
8db4ddc51ef4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"preAutII", "[", 
   RowBox[{
   "generators_", ",", "generator_", ",", "multiplier_", ",", "\"\<0\>\""}], 
   "]"}], ":=", "generator"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preAutII", "[", 
   RowBox[{
   "generators_", ",", "generator_", ",", "multiplier_", ",", "\"\<1\>\""}], 
   "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"generator", ",", 
        RowBox[{"inverse", "[", "generator", "]"}]}], "}"}], ",", 
      "multiplier"}], "]"}], ",", "\[IndentingNewLine]", "generator", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"inverse", "[", "multiplier", "]"}], ",", "generator"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preAutII", "[", 
   RowBox[{
   "generators_", ",", "generator_", ",", "multiplier_", ",", "\"\<2\>\""}], 
   "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"generator", ",", 
        RowBox[{"inverse", "[", "generator", "]"}]}], "}"}], ",", 
      "multiplier"}], "]"}], ",", "\[IndentingNewLine]", "generator", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"generator", ",", " ", "multiplier"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"preAutII", "[", 
   RowBox[{
   "generators_", ",", "generator_", ",", "multiplier_", ",", "\"\<3\>\""}], 
   "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"generator", ",", 
        RowBox[{"inverse", "[", "generator", "]"}]}], "}"}], ",", 
      "multiplier"}], "]"}], ",", "\[IndentingNewLine]", "generator", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"inverse", "[", "multiplier", "]"}], ",", "generator", ",", " ",
       "multiplier"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"autII", "[", 
   RowBox[{"generators_", ",", "multiplier_", ",", " ", "quaternary_"}], 
   "]"}], ":=", 
  RowBox[{"Association", "[", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"gen", "[", 
       RowBox[{
        RowBox[{"generators", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<0\>\""}], "]"}], "\[Rule]",
       " ", 
      RowBox[{"preAutII", "[", 
       RowBox[{"generators", ",", 
        RowBox[{"gen", "[", 
         RowBox[{
          RowBox[{"generators", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<0\>\""}], "]"}], ",", 
        "multiplier", ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"quaternary", ",", 
          RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "generators", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"multipliers", "[", "generators_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{"generators", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"inverse", "[", "#", "]"}], "&"}], "/@", "generators"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quaternaryNumbers", "[", "length_", "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Fold", "[", 
       RowBox[{"StringJoin", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<0\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "length"}], "}"}]}], "]"}]}], "]"}], 
      "]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"Fold", "[", 
              RowBox[{"StringJoin", ",", 
               RowBox[{"Table", "[", 
                RowBox[{"\"\<0\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"length", "-", "n"}]}], "}"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"BaseForm", "[", 
                 RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", "n"}], "]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"4", "^", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"4", "^", "n"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"length", "-", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"BaseForm", "[", 
             RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", "length"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"4", "^", 
            RowBox[{"(", 
             RowBox[{"length", "-", "1"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"4", "^", "length"}], "-", "1"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"autIIParameters", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<multiplier\>\"", ",", "\"\<quaternary\>\""}], "}"}], ",", 
      "#"}], "]"}], "&"}], "/@", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"multipliers", "[", "generators", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"quaternaryNumbers", "[", 
             RowBox[{"Length", "[", "generators", "]"}], "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"multipliers", "[", "generators", "]"}], "]"}]}], "}"}]}],
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"quaternaryNumbers", "[", 
           RowBox[{"Length", "[", "generators", "]"}], "]"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAutII", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{"allAutII", "[", "generators", "]"}], "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"autII", "[", 
       RowBox[{"generators", ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "\"\<multiplier\>\"", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "\"\<quaternary\>\"", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"autIIParameters", "[", "generators", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allAutII", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8183443966425323`*^9, 3.818344646861865*^9}, {
   3.818344726863177*^9, 3.8183447765336237`*^9}, {3.818344854081337*^9, 
   3.8183448924870768`*^9}, {3.818344949458811*^9, 3.8183449506866665`*^9}, {
   3.8183498612366004`*^9, 3.8183499575933795`*^9}, {3.818350236656273*^9, 
   3.8183502376685934`*^9}, {3.8183505907387457`*^9, 3.818350606164884*^9}, {
   3.8183506996082873`*^9, 3.8183507010573783`*^9}, {3.8183507647897077`*^9, 
   3.818350781465413*^9}, {3.8184126656243086`*^9, 3.818412712269807*^9}, {
   3.818412745344743*^9, 3.8184128320504036`*^9}, 3.818412876425697*^9, {
   3.8184130478872223`*^9, 3.8184131005367327`*^9}, {3.818413194678007*^9, 
   3.818413202197331*^9}, {3.8184132814478188`*^9, 3.818413293775251*^9}, {
   3.819531741017065*^9, 3.8195317457822003`*^9}, {3.8195324013230143`*^9, 
   3.819532417950832*^9}, {3.8195338881975374`*^9, 3.819533966721637*^9}, {
   3.819534009427149*^9, 3.819534180901395*^9}, {3.8195343204720507`*^9, 
   3.819534339271166*^9}, {3.8195345706445637`*^9, 3.819534572966279*^9}, {
   3.8195480426600275`*^9, 3.819548045422531*^9}, {3.8195690279718504`*^9, 
   3.8195690369976034`*^9}, {3.819569126176186*^9, 3.819569177942938*^9}, {
   3.819569255280535*^9, 3.8195693291531963`*^9}, {3.819615102106536*^9, 
   3.819615116250414*^9}, {3.8196505560903454`*^9, 3.8196505643893166`*^9}, {
   3.819650721601383*^9, 3.81965074810327*^9}, 3.8196523087678733`*^9, {
   3.8196524379471436`*^9, 3.819652444992896*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"7608409c-f05d-424c-8a5e-539d0e5b4208"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Whitehead\[CloseCurlyQuote]s Minimisation Algorithm", "Section",
 CellChangeTimes->{{3.818345153645567*^9, 
  3.8183451704886103`*^9}},ExpressionUUID->"e63f2381-d1bf-40ae-9a4d-\
f4142182fd17"],

Cell["\<\
We need to keep track, not only of what happens to a particular element as we \
apply Whitehead automorphisms to reduce its length, but also what these \
automorphisms do to the generators of the free group. We will record this \
information as an association which we will refer to as a word automorphism, \
or wordAut for short\
\>", "Text",
 CellChangeTimes->{{3.8195659716007605`*^9, 3.819566007621661*^9}, {
  3.819566039598727*^9, 3.8195660871000423`*^9}, {3.819566117943347*^9, 
  3.819566147426625*^9}, {3.819618016134201*^9, 3.8196180263953867`*^9}, {
  3.8196181071424074`*^9, 3.819618107199479*^9}, {3.819618138017686*^9, 
  3.8196181510068216`*^9}},ExpressionUUID->"efc0e57c-2d4c-489b-915a-\
25e3c0b07b5f"],

Cell["\<\
<| 
\[OpenCurlyDoubleQuote]word\[CloseCurlyDoubleQuote]-> \
\[OpenCurlyDoubleQuote]string\[CloseCurlyDoubleQuote], 
\[OpenCurlyDoubleQuote]aut\[CloseCurlyDoubleQuote]-> <| \
\[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote]-> \
aut[\[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote]], \
\[OpenCurlyDoubleQuote]b\[CloseCurlyDoubleQuote]->aut[\[OpenCurlyDoubleQuote]\
b\[CloseCurlyDoubleQuote]]|>, 
\[OpenCurlyDoubleQuote]inverseAut\[CloseCurlyDoubleQuote]-> <| \
\[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote]-> inverseAut[\
\[OpenCurlyDoubleQuote]a\[CloseCurlyDoubleQuote]], \[OpenCurlyDoubleQuote]b\
\[CloseCurlyDoubleQuote]-> inverseAut[\[OpenCurlyDoubleQuote]b\
\[CloseCurlyDoubleQuote]]|>
|>\
\>", "CodeText",
 CellChangeTimes->{{3.8195661590872636`*^9, 
  3.8195663446334653`*^9}},ExpressionUUID->"8502ef77-14de-4837-91a3-\
31195f2d2b5d"],

Cell[CellGroupData[{

Cell["Functions applying automorphisms", "Subsection",
 CellChangeTimes->{{3.818349088311103*^9, 3.8183491065177436`*^9}, {
  3.819567749548159*^9, 
  3.8195677559692802`*^9}},ExpressionUUID->"bf5e2a19-3844-4129-917e-\
6cf18119f8d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"automorphismToRules", "[", "automorphism_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Normal", "[", "automorphism", "]"}], ",", 
    RowBox[{"Normal", "[", 
     RowBox[{"AssociationThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"inverse", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "automorphism", "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"inverse", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"Values", "[", "automorphism", "]"}]}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aut", "[", 
    RowBox[{"word_String", ",", "automorphism_Association"}], "]"}], ":=", 
   RowBox[{"freelyReduce", "[", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"word", ",", 
      RowBox[{"automorphismToRules", "[", "automorphism", "]"}]}], "]"}], 
    "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "applies", " ", "automorphism", " ", "to", " ", "the", " ", "element", " ",
     "represented", " ", "by", " ", "word"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aut", "[", 
    RowBox[{"automorphism1_Association", ",", "automorphism2_Association"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"AssociationThread", "[", 
     RowBox[{
      RowBox[{"Keys", "[", "automorphism1", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"aut", "[", 
         RowBox[{"#", ",", "automorphism2"}], "]"}], "&"}], "/@", 
       RowBox[{"Values", "[", "automorphism1", "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"StringLength", "[", 
      RowBox[{
       RowBox[{"Keys", "[", "automorphism1", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "1"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "gives", " ", "the", " ", "automorphism", " ", "which", " ", "results", 
    " ", "from", " ", "applying", " ", "automorphism1", " ", "followed", " ", 
    "by", " ", "automorphism2"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aut", "[", 
    RowBox[{"wordAut_Association", ",", "automorphism_Association"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<word\>\"", "\[Rule]", 
       RowBox[{"aut", "[", 
        RowBox[{
         RowBox[{"wordAut", "[", 
          RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], ",", "automorphism"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<aut\>\"", "\[Rule]", 
       RowBox[{"aut", "[", 
        RowBox[{
         RowBox[{"wordAut", "[", 
          RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], ",", "automorphism"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<inverseAut\>\"", "\[Rule]", 
       RowBox[{"aut", "[", 
        RowBox[{
         RowBox[{"inverseAutomorphism", "[", "automorphism", "]"}], ",", 
         RowBox[{"wordAut", "[", 
          RowBox[{"[", "\"\<inverseAut\>\"", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"Keys", "[", "wordAut", "]"}], ",", "\"\<word\>\""}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "gives", " ", "the", " ", "result", " ", "of", " ", "applying", " ", 
    "automorphism", " ", "to", " ", "wordAut"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"automorphismType", "[", "automorphism_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fold", "[", 
     RowBox[{"Or", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "[", "#", "]"}], ">", "1"}], "&"}], "/@", 
         RowBox[{"Values", "[", "automorphism", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Type II\>\"", ",", "\[IndentingNewLine]", 
    "\"\<Type I\>\""}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverseAutomorphism", "[", "automorphism_", "]"}], ":=", 
  RowBox[{
   RowBox[{"KeySelect", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AssociationThread", "[", 
      RowBox[{
       RowBox[{"Values", "[", 
        RowBox[{"automorphismToRules", "[", "automorphism", "]"}], "]"}], ",", 
       RowBox[{"Keys", "[", 
        RowBox[{"automorphismToRules", "[", "automorphism", "]"}], "]"}]}], 
      "]"}], ",", "\[IndentingNewLine]", "LowerCaseQ"}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"automorphismType", "[", "automorphism", "]"}], "\[Equal]", 
    "\"\<Type I\>\""}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverseAutomorphism", "[", "automorphism_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nonTrivValue", ",", "nonTrivKey", ",", "multiplier", ",", 
       "quaternary"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nonTrivValue", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Values", "[", "automorphism", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "#", "]"}], ">", "1"}], "&"}], ",", 
          "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nonTrivKey", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "automorphism", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"automorphism", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "nonTrivValue"}], 
           "&"}], ",", "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"multiplier", "=", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "nonTrivValue", "]"}], "\[Equal]", 
          "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"nonTrivValue", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"nonTrivValue", ",", "1"}], "]"}], "\[Equal]", 
            "nonTrivKey"}], ",", "\[IndentingNewLine]", 
           RowBox[{"StringTake", "[", 
            RowBox[{"nonTrivValue", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"inverse", "[", 
            RowBox[{"StringTake", "[", 
             RowBox[{"nonTrivValue", ",", "1"}], "]"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"quaternary", "=", 
       RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", 
              RowBox[{"automorphism", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", "\"\<0\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"StringLength", "[", 
                RowBox[{"automorphism", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "]"}], "\[Equal]", "3"}], 
              ",", "\[IndentingNewLine]", "\"\<3\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{
                   RowBox[{"automorphism", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", "#"}], ",", 
                "\[IndentingNewLine]", "\"\<1\>\"", ",", 
                "\[IndentingNewLine]", "\"\<2\>\""}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "]"}], "&"}], "/@", 
         RowBox[{"Keys", "[", "automorphism", "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"autII", "[", 
       RowBox[{
        RowBox[{"Keys", "[", "automorphism", "]"}], ",", 
        RowBox[{"inverse", "[", "multiplier", "]"}], ",", "quaternary"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"automorphismType", "[", "automorphism", "]"}], "\[Equal]", 
    "\"\<Type II\>\""}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclicallyReduce", "[", "wordAut_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cyclicallyReducedQ", "[", 
     RowBox[{"wordAut", "[", 
      RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", "wordAut", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"freelyReducedQ", "[", 
        RowBox[{"wordAut", "[", 
         RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], "&&", 
       RowBox[{"Not", "[", 
        RowBox[{"cyclicallyReducedQ", "[", 
         RowBox[{"wordAut", "[", 
          RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cyclicallyReduce", "[", "\[IndentingNewLine]", 
       RowBox[{"aut", "[", 
        RowBox[{"wordAut", ",", 
         RowBox[{"autII", "[", 
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"wordAut", "[", 
             RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{
             RowBox[{"wordAut", "[", 
              RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], ",", "1"}], "]"}], 
           ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"\"\<3\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"wordAut", "[", 
                  RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], "]"}]}], "}"}]}], 
             "]"}], "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"cyclicallyReduce", "[", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<word\>\"", "\[Rule]", 
          RowBox[{"freelyReduce", "[", 
           RowBox[{"wordAut", "[", 
            RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"\"\<aut\>\"", "\[Rule]", 
          RowBox[{"wordAut", "[", 
           RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"\"\<inverseAut\>\"", "\[Rule]", 
          RowBox[{"wordAut", "[", 
           RowBox[{"[", "\"\<inverseAut\>\"", "]"}], "]"}]}]}], "|>"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdymtMkmEAxXEiq4kfdGkFrVopa10YOYrIshRzZsKCbgxcKBluCt28xJRl
NeYHppbZ0JYZNWKkmcEorVkzLWqMki6josFsuTYt39ioDLvac94PZ7/t7L+s
5MiuUiaDweCTQZfWVfi5khK/4Ua0cPY/ZznkBu/TBmQtRjhslDXSf9ens3T3
mHcBarj9XTCxZ4YLFrEioxPE5atOjsFFljgKfpuUz6GIumhsIZw3S7QYanpm
iuBvxvMNkK3szIHyFRlboT60WgLzhCrakkp3IVRt5KihuSOog+/9MT0sS85v
hswkTwu07ribHCXaNhk40D3V+BBWRZgeGJYxer8S070ZfXCw7crP+CpK7Auc
+gX3vRgRsoi51vVZ0K4oX9tETGTfEkNVwuF8mDJWvR8OPJo7BJsGLtJeG6+V
zD9Gib1lVtrsWMUCPvFdaIQNTbGJL5B3SRSB9lGzW0is+RGgDSs2S7OI6nsP
aGvfTu2GRznxOnhQa6yAz2xrDLBGv+c4DHu3W+ANU/Fl2D3kpzUkOOsUxNbm
YDscdPTZ4F6z+ir0Rcc74ZN2fRTWN0z/gakO/zQU5KSlKYl5SSdWwlz+unT4
IdQggtXfn2bDl+HMbdAkOyCFrDOTcniou0AJ+UsVtFv6eUXQk8oshtdfSy2w
Y0l9G0w5X3dORXwV63VAbqb9JnRZQ3egwSkYhoLbpz/C0r++Ag0xrnWnBP4H
JIaANQ==
  "],
 CellLabel->
  "In[125]:=",ExpressionUUID->"4e0b916c-c110-421e-996e-1a99f13d9068"]
}, Closed]],

Cell[CellGroupData[{

Cell["The algorithm", "Subsection",
 CellChangeTimes->{{3.8196191115707874`*^9, 
  3.819619114557674*^9}},ExpressionUUID->"46606802-2f0b-4e46-a63b-\
c82437c9dadd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allAut", "[", "generators_", "]"}], ":=", 
  RowBox[{
   RowBox[{"allAut", "[", "generators", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"allAutI", "[", "generators", "]"}], ",", 
     RowBox[{"allAutII", "[", "generators", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reducedWhiteheadNeighbourQuick", "[", "wordAut_", "]"}], ":=", 
   RowBox[{
    RowBox[{"reducedWhiteheadNeighbourQuick", "[", "wordAut", "]"}], "=", 
    RowBox[{"aut", "[", "\[IndentingNewLine]", 
     RowBox[{"wordAut", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allAutII", "[", 
            RowBox[{"Keys", "[", " ", 
             RowBox[{"wordAut", "[", 
              RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], " ", "]"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", 
              RowBox[{"aut", "[", 
               RowBox[{
                RowBox[{"wordAut", "[", 
                 RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], ",", "#"}], "]"}],
               "]"}], "<", 
             RowBox[{"StringLength", "[", 
              RowBox[{"wordAut", "[", 
               RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}]}], "&"}], ",",
            "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"AssociationThread", "[", " ", 
           RowBox[{
            RowBox[{"Keys", "[", " ", 
             RowBox[{"wordAut", "[", 
              RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], " ", "]"}], ",", 
            RowBox[{"Keys", "[", " ", 
             RowBox[{"wordAut", "[", 
              RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], " ", "]"}]}], "]"}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "performs", " ", "a", " ", "Whitehead", " ", "reduction", " ",
     "if", " ", "one", " ", "can", " ", "be", " ", "found", " ", "quickly"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"automorphismMinimalQuickQ", "[", "wordAut_", "]"}], ":=", 
   RowBox[{
    RowBox[{"reducedWhiteheadNeighbourQuick", "[", "wordAut", "]"}], 
    "\[Equal]", "wordAut"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"whiteheadNeighbours", "[", "wordAut_", "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"whiteheadNeighbours", "[", "wordAut", "]"}], "="}], "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cyclicallyReduce", "[", 
          RowBox[{"aut", "[", 
           RowBox[{"wordAut", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"allAutII", "[", 
         RowBox[{"Keys", "[", " ", 
          RowBox[{"wordAut", "[", 
           RowBox[{"[", "\"\<aut\>\"", "]"}], "]"}], " ", "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      RowBox[{"minimumLengthOfNeighbour", "[", "wordAut_", "]"}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"minimumLengthOfNeighbour", "[", "wordAut", "]"}], "="}], 
      "*)"}], 
     RowBox[{
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"whiteheadNeighbours", "[", "wordAut", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"automorphismMinimalSlowQ", "[", "wordAut_", "]"}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"minimumLengthOfNeighbour", "[", "wordAut", "]"}], 
        "\[GreaterEqual]", 
        RowBox[{
         RowBox[{"cyclicallyReducedLength", "[", " ", 
          RowBox[{"wordAut", "[", 
           RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], " ", "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"reducedWhiteheadNeighbourSlow", "[", "wordAut_", "]"}]}]}], 
       ":=", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "freelyMinimalNeighbours", ",", "minimumFreeLength", ",", "list"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"minimumFreeLength", "=", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"freelyReducedLength", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], "&"}], "/@", 
              RowBox[{"whiteheadNeighbours", "[", "wordAut", "]"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"freelyMinimalNeighbours", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"whiteheadNeighbours", "[", "wordAut", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"freelyReducedLength", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], 
                "\[Equal]", "minimumFreeLength"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"list", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"whiteheadReduce", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Select", "[", 
              RowBox[{"freelyMinimalNeighbours", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"cyclicallyReducedLength", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"minimumLengthOfNeighbour", "[", "wordAut", "]"}]}], 
                "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"DeleteDuplicatesBy", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "list", "]"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "&"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "are", " ", "an", " ", "old", " ", "slow", " ", "version", 
    " ", "of", " ", "the", " ", "algoritm", " ", "which", " ", "I", " ", 
    "think", " ", "is", " ", "redundant"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"whiteheadReduce", "[", "wordAut_", "]"}], ":=", 
  RowBox[{
   RowBox[{"whiteheadReduce", "[", "wordAut", "]"}], "=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"automorphismMinimalQuickQ", "[", "wordAut", "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"whiteheadReduce", "[", 
      RowBox[{"reducedWhiteheadNeighbourQuick", "[", "wordAut", "]"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"automorphismMinimalSlowQ", "[", "wordAut", "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"whiteheadReduce", "[", 
         RowBox[{"reducedWhiteheadNeighbourSlow", "[", "wordAut", "]"}], 
         "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "wordAut", " ", "can", " ", "be", " ", "reduced"}], ",", 
          " ", 
          RowBox[{
          "but", " ", "not", " ", "in", " ", "an", " ", "obvious", " ", 
           "way"}], ",", " ", 
          RowBox[{
          "we", " ", "then", " ", "perform", " ", "the", " ", "slow", " ", 
           "algorithm", " ", "once", " ", "before", " ", "testing", " ", 
           "whether", " ", "the", " ", "fast", " ", "algorithm", " ", "can", 
           " ", "again", " ", "be", " ", "applied"}]}], "*)"}], 
        "\[IndentingNewLine]", "wordAut"}], 
       RowBox[{"(*", 
        RowBox[{
        "If", " ", "wordAut", " ", "is", " ", "Whitehead", " ", "reduced", 
         " ", "we", " ", "just", " ", "return", " ", "wordAut"}], "*)"}], 
       "\[IndentingNewLine]", "]"}], "*)"}], "wordAut"}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"whiteheadReduce", "[", 
   RowBox[{"generators_List", ",", "word_String"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "automorphism", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"automorphism", "=", 
      RowBox[{"AssociationThread", "[", 
       RowBox[{"generators", ",", "generators"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"whiteheadReduce", "[", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<word\>\"", "\[Rule]", "word"}], ",", 
        RowBox[{"\"\<aut\>\"", "\[Rule]", "automorphism"}], ",", 
        RowBox[{"\"\<inverseAut\>\"", "\[Rule]", "automorphism"}]}], "|>"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"primitiveElementQ", "[", 
   RowBox[{"generators_", ",", " ", "word_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"StringLength", "[", " ", 
    RowBox[{
     RowBox[{"whiteheadReduce", "[", 
      RowBox[{"generators", ",", "word"}], "]"}], "[", 
     RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], " ", "]"}], "\[Equal]", 
   "1"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818349158480261*^9, 3.8183492643243546`*^9}, {
   3.8183492959787626`*^9, 3.818349379355933*^9}, {3.818349421070627*^9, 
   3.8183494414793205`*^9}, {3.818349479753024*^9, 3.81834950042273*^9}, {
   3.818349728914753*^9, 3.818349730491786*^9}, {3.8183502618561583`*^9, 
   3.8183502681158724`*^9}, {3.818350794427127*^9, 3.818350801825906*^9}, 
   3.818351089470109*^9, {3.8183511348788657`*^9, 3.81835115068034*^9}, {
   3.818351199206909*^9, 3.818351329395993*^9}, {3.818351361864208*^9, 
   3.8183514727321415`*^9}, {3.818353849939515*^9, 3.8183539549412594`*^9}, {
   3.818353996832121*^9, 3.8183540062817554`*^9}, {3.8183540394084215`*^9, 
   3.818354042190611*^9}, {3.818354265037718*^9, 3.818354355229449*^9}, {
   3.8183543925341396`*^9, 3.8183544868389626`*^9}, {3.8183545378693285`*^9, 
   3.818354540270156*^9}, {3.818354666927925*^9, 3.8183546697433767`*^9}, {
   3.8183574937905087`*^9, 3.8183575237871294`*^9}, {3.8183577592712455`*^9, 
   3.818357764823037*^9}, {3.818357809941502*^9, 3.818357860807315*^9}, {
   3.818357907632998*^9, 3.8183579444101863`*^9}, {3.818358424873603*^9, 
   3.818358452962578*^9}, {3.8183584929104013`*^9, 3.818358576993555*^9}, {
   3.818358639848816*^9, 3.8183587662953644`*^9}, {3.818359026259137*^9, 
   3.818359108123032*^9}, {3.818359219020262*^9, 3.8183592245496807`*^9}, {
   3.818359291564209*^9, 3.8183593072291517`*^9}, {3.8183594572150517`*^9, 
   3.8183595098114543`*^9}, {3.818359543035719*^9, 3.8183595558936625`*^9}, {
   3.8183595901593924`*^9, 3.8183597086918964`*^9}, {3.8183597830097785`*^9, 
   3.8183598195726633`*^9}, {3.8183601559614944`*^9, 3.818360208189632*^9}, {
   3.8183603024107265`*^9, 3.8183603213014727`*^9}, {3.8183623119453297`*^9, 
   3.8183625475438056`*^9}, {3.8183626300179625`*^9, 
   3.8183626343374853`*^9}, {3.8183627215208163`*^9, 3.818362782615489*^9}, {
   3.8183628458206716`*^9, 3.818362845909375*^9}, {3.818362911058501*^9, 
   3.818362942959901*^9}, {3.818363085961808*^9, 3.818363211904666*^9}, {
   3.818363435832734*^9, 3.8183634778133273`*^9}, {3.8183635088693743`*^9, 
   3.8183635375527916`*^9}, {3.8183635756757307`*^9, 3.818363578960971*^9}, {
   3.8183636742296166`*^9, 3.81836367767089*^9}, {3.8183637176698523`*^9, 
   3.8183637239974103`*^9}, {3.8183637595400977`*^9, 3.818363813581815*^9}, {
   3.8183660392895317`*^9, 3.8183660496747417`*^9}, {3.8183664183097496`*^9, 
   3.8183664229924603`*^9}, {3.8183664765955486`*^9, 
   3.8183664876943183`*^9}, {3.818366701352764*^9, 3.8183667042425933`*^9}, {
   3.8183672232209444`*^9, 3.8183672258820057`*^9}, {3.8183673020425777`*^9, 
   3.818367311370881*^9}, {3.8183676459045286`*^9, 3.818367680171332*^9}, {
   3.8183678093151774`*^9, 3.8183678460551147`*^9}, {3.818368076469037*^9, 
   3.818368087536271*^9}, {3.818368130499668*^9, 3.818368139350875*^9}, {
   3.8183682600954657`*^9, 3.8183682770749893`*^9}, {3.8183683389768944`*^9, 
   3.818368341760113*^9}, {3.8183683960891647`*^9, 3.818368399266279*^9}, {
   3.8183684491040335`*^9, 3.818368485009153*^9}, {3.8183685172311316`*^9, 
   3.81836851756103*^9}, {3.818368594376995*^9, 3.8183685978465157`*^9}, {
   3.8183686588024035`*^9, 3.8183687468370852`*^9}, {3.8183688397658005`*^9, 
   3.8183688405627565`*^9}, {3.818368885894518*^9, 3.818368886111785*^9}, {
   3.8183689289275866`*^9, 3.818369030070588*^9}, {3.818409945783604*^9, 
   3.81840995199356*^9}, {3.818414943699181*^9, 3.8184149561256304`*^9}, {
   3.8184150326479483`*^9, 3.8184150560660877`*^9}, {3.81860132294608*^9, 
   3.818601328046009*^9}, {3.818601415646187*^9, 3.8186014184632287`*^9}, {
   3.818601449972732*^9, 3.818601482336517*^9}, {3.8186018351693015`*^9, 
   3.81860184476919*^9}, {3.8186018803543186`*^9, 3.818601900115894*^9}, {
   3.818602041885874*^9, 3.8186020438563247`*^9}, {3.818602099063361*^9, 
   3.818602099192611*^9}, {3.8186025039987907`*^9, 3.8186025059253683`*^9}, {
   3.8186026301385293`*^9, 3.8186028105276256`*^9}, {3.8186041318712206`*^9, 
   3.818604148918197*^9}, {3.8186041964305754`*^9, 3.8186042966591425`*^9}, {
   3.8186788656781597`*^9, 3.8186788931816893`*^9}, {3.8195342060481415`*^9, 
   3.8195342085731106`*^9}, {3.819534714280501*^9, 3.8195349117447014`*^9}, {
   3.8195452471140175`*^9, 3.8195453079344296`*^9}, {3.8195472724582243`*^9, 
   3.819547275474641*^9}, {3.8195478889066143`*^9, 3.81954797179459*^9}, 
   3.819548476942686*^9, {3.8195677308442945`*^9, 3.819567730969099*^9}, {
   3.819616351752611*^9, 3.8196163844513984`*^9}, {3.8196181596618843`*^9, 
   3.8196181778578353`*^9}, {3.819619805683955*^9, 3.819619853715974*^9}, {
   3.8196222229004865`*^9, 3.8196224676954412`*^9}, {3.8196254016168814`*^9, 
   3.8196255509324846`*^9}, {3.819625591339693*^9, 3.8196256000834494`*^9}, {
   3.819625703313706*^9, 3.8196258326908007`*^9}, {3.8196259030149984`*^9, 
   3.8196259066398478`*^9}, {3.819625937286607*^9, 3.8196259500722075`*^9}, 
   3.81962605121359*^9, {3.8196260814593997`*^9, 3.8196260931080093`*^9}, {
   3.8196263146192026`*^9, 3.8196263867318473`*^9}, {3.8196264175191154`*^9, 
   3.8196265393586793`*^9}, {3.8196266229164906`*^9, 
   3.8196267291396065`*^9}, {3.819626759344515*^9, 3.819626771903957*^9}, {
   3.8196268037071276`*^9, 3.819626862689104*^9}, {3.8196269295144424`*^9, 
   3.819626956908549*^9}, {3.8196270149179735`*^9, 3.819627028592084*^9}, {
   3.819627896022545*^9, 3.8196279361917543`*^9}, {3.8196279763979807`*^9, 
   3.8196281067224054`*^9}, {3.819628151950698*^9, 3.8196283055559406`*^9}, {
   3.8196283388242817`*^9, 3.819628356325873*^9}, {3.8196284172040854`*^9, 
   3.8196284432096233`*^9}, {3.819628475822073*^9, 3.8196284766942763`*^9}, {
   3.8196334860634604`*^9, 3.81963348807747*^9}, {3.8196336561820107`*^9, 
   3.8196336812485843`*^9}, {3.81963381896832*^9, 3.81963382793931*^9}, {
   3.819633940668781*^9, 3.8196339594837575`*^9}, {3.8196353373938084`*^9, 
   3.8196353744196825`*^9}, {3.819635432805972*^9, 3.819635445448378*^9}, {
   3.8196396425439224`*^9, 3.819639644567325*^9}, {3.8196518714755745`*^9, 
   3.8196518916818347`*^9}, {3.8196521390988307`*^9, 3.819652142039892*^9}, {
   3.8196525530625753`*^9, 3.8196525708230305`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"10d62165-1f2a-4536-bb66-584c2d77e6cb"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fundamental groups", "Section",
 CellChangeTimes->{{3.819382422502266*^9, 
  3.8193824298714046`*^9}},ExpressionUUID->"26473773-1f33-4484-8842-\
a59f8cd41fc8"],

Cell[CellGroupData[{

Cell["Maximal contractable sub-complexes", "Subsection",
 CellChangeTimes->{{3.819386588071062*^9, 
  3.8193865976742167`*^9}},ExpressionUUID->"318d19db-ee61-4ff3-b111-\
99026253f553"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeFormsCycleQ", "[", 
   RowBox[{"squareComplex_", ",", "subComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"SubsetQ", "[", 
   RowBox[{
    RowBox[{"subComplex", "[", 
     RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
    RowBox[{"edgeVertices", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maximalSubTreeQ", "[", 
    RowBox[{"squareComplex_", ",", "subGraph_"}], "]"}], ":=", 
   RowBox[{"ContainsExactly", "[", 
    RowBox[{
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
     RowBox[{"subGraph", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], " ", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "assumes", " ", "subGraph", " ", "is", " ", "connected"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extendTree", "[", 
   RowBox[{"squareComplex_", ",", "subGraph_"}], "]"}], ":=", 
  RowBox[{"subGraph", "/;", 
   RowBox[{"maximalSubTreeQ", "[", 
    RowBox[{"squareComplex", ",", "subGraph"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extendTree", "[", 
   RowBox[{"squareComplex_", ",", "subGraph_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edgeAddition", ",", "vertexAddition", ",", "extendedTree"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edgeAddition", "=", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Keys", "[", " ", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Keys", "[", " ", 
               RowBox[{"subGraph", "[", 
                RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
              "#"}], "]"}], "]"}], "&&", "\[IndentingNewLine]", 
           RowBox[{"Not", "[", 
            RowBox[{"edgeFormsCycleQ", "[", 
             RowBox[{"squareComplex", ",", "subGraph", ",", "#"}], "]"}], 
            "]"}], "&&", "\[IndentingNewLine]", 
           RowBox[{"IntersectingQ", "[", 
            RowBox[{
             RowBox[{"edgeVertices", "[", 
              RowBox[{"squareComplex", ",", "#"}], "]"}], ",", 
             RowBox[{"subGraph", "[", 
              RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], " ", "]"}]}], 
          "&"}], ",", "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertexAddition", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "edgeAddition"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"subGraph", "[", 
              RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], " ", ",", "#"}], 
            "]"}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"extendedTree", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"subGraph", "[", 
            RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", 
           RowBox[{"{", "vertexAddition", "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "\[Rule]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"subGraph", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"edgeAddition", "\[Rule]", 
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "edgeAddition", "]"}], "]"}]}]}], " ", "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"extendTree", "[", 
      RowBox[{"squareComplex", ",", "extendedTree"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"maximalSubTree", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"maximalSubTree", "[", "squareComplex", "]"}], "=", 
   RowBox[{"extendTree", "[", 
    RowBox[{"squareComplex", ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ",", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"<|", "|>"}]}], ",", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"<|", "|>"}]}]}], "|>"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"squareUnionContractableQ", "[", 
   RowBox[{"squareComplex_", ",", "subComplex_", ",", "s1_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "s1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "[", " ", 
          RowBox[{"subComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", "#"}],
         "]"}], "&"}]}], "]"}], "]"}], "\[Equal]", 
   "3"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maximalContractableSubcomplexQ", "[", 
   RowBox[{"squareComplex_", ",", "subComplex_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"squareUnionContractableQ", "[", 
          RowBox[{"squareComplex", ",", "subComplex", ",", "#"}], "]"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", " ", 
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extendContractableSubComplex", "[", 
   RowBox[{"squareComplex_", ",", "subComplex_"}], "]"}], ":=", 
  RowBox[{"subComplex", "/;", 
   RowBox[{"maximalContractableSubcomplexQ", "[", 
    RowBox[{"squareComplex", ",", "subComplex"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extendContractableSubComplex", "[", 
   RowBox[{"squareComplex_", ",", "subComplex_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "squareAddition", ",", "edgeAddition", ",", "extendedSubComplex"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"squareAddition", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Keys", "[", " ", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Keys", "[", " ", 
               RowBox[{"subComplex", "[", 
                RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",",
               "#"}], "]"}], "]"}], "&&", 
           RowBox[{"squareUnionContractableQ", "[", 
            RowBox[{"squareComplex", ",", "subComplex", ",", "#"}], "]"}]}], 
          "&"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgeAddition", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", "squareAddition", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", " ", 
              RowBox[{"subComplex", "[", 
               RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
             "#"}], "]"}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"extendedSubComplex", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", 
         RowBox[{"subComplex", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "->", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"subComplex", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"edgeAddition", "\[Rule]", 
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "edgeAddition", "]"}], "]"}]}]}], " ", "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"subComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
           RowBox[{"squareAddition", "->", 
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "squareAddition", "]"}], "]"}]}]}], " ", "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"extendContractableSubComplex", "[", 
      RowBox[{"squareComplex", ",", "extendedSubComplex"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maximalContractableSubComplex", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"extendContractableSubComplex", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"maximalSubTree", "[", "squareComplex", "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819382551398275*^9, 3.819382563146154*^9}, {
   3.8193826547174287`*^9, 3.819382908653786*^9}, {3.8193843620765467`*^9, 
   3.8193846882719526`*^9}, {3.8193847958174944`*^9, 
   3.8193849166150837`*^9}, {3.81938498744036*^9, 3.819385225906562*^9}, {
   3.81938528242146*^9, 3.8193853084078274`*^9}, {3.8193853385372543`*^9, 
   3.8193853545962467`*^9}, {3.8193853857086387`*^9, 3.81938550059836*^9}, {
   3.81938556790957*^9, 3.819385582213747*^9}, {3.819385846346157*^9, 
   3.8193859081903133`*^9}, {3.819385986862314*^9, 3.8193865595738015`*^9}, {
   3.819391168238927*^9, 3.819391177197776*^9}, {3.8193917123519883`*^9, 
   3.819391724161261*^9}, {3.819391833760436*^9, 3.819391834875149*^9}, {
   3.81939207992663*^9, 3.8193920894249344`*^9}, {3.819392195264906*^9, 
   3.8193921975433083`*^9}, {3.8193926263261833`*^9, 
   3.8193927004414215`*^9}, {3.819392788547937*^9, 3.8193927942562895`*^9}, {
   3.819392841147043*^9, 3.8193928471826735`*^9}, {3.8193930281271396`*^9, 
   3.8193930317478886`*^9}, 3.819393064578006*^9, {3.8193931916689005`*^9, 
   3.819393249972675*^9}, {3.8193933521047816`*^9, 3.819393422160001*^9}, {
   3.8193950405393896`*^9, 3.819395111725074*^9}, 3.819395204730094*^9, {
   3.8193954607216716`*^9, 3.8193954648818445`*^9}, {3.8193977286114073`*^9, 
   3.819397737055139*^9}, {3.8198197493930044`*^9, 3.8198197604195323`*^9}, {
   3.8198229658677998`*^9, 3.8198229707189965`*^9}, {3.819823779736684*^9, 
   3.8198237881364164`*^9}, {3.8198239489983187`*^9, 3.819823950157926*^9}, {
   3.8198244073097157`*^9, 3.819824473217839*^9}, {3.8201468841514945`*^9, 
   3.8201468878852463`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"6c6b188f-8a6f-40d4-ac52-2ba7ddfa6def"]
}, Closed]],

Cell[CellGroupData[{

Cell["From square complexes to group presentations", "Subsection",
 CellChangeTimes->{{3.8193866317532544`*^9, 
  3.8193866458743277`*^9}},ExpressionUUID->"67734995-3821-45a6-baaf-\
edfb2e3d1f5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"characters", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\"", ",", "\"\<d\>\"", ",", 
     "\"\<e\>\"", ",", "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<h\>\"", ",", 
     "\"\<i\>\"", ",", "\"\<j\>\"", ",", "\"\<k\>\"", ",", "\"\<l\>\"", ",", 
     "\"\<m\>\"", ",", "\"\<n\>\"", ",", "\"\<o\>\"", ",", "\"\<p\>\"", ",", 
     "\"\<q\>\"", ",", "\"\<r\>\"", ",", "\"\<s\>\"", ",", "\"\<t\>\"", ",", 
     "\"\<u\>\"", ",", "\"\<v\>\"", ",", "\"\<w\>\"", ",", "\"\<x\>\"", ",", 
     "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgesToGenerators", "[", 
   RowBox[{"squareComplex_", ",", "eList_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "generatorsAssoc", ",", "eListComplement", ",", "nonGeneratorsAssoc"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"generatorsAssoc", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"eList", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"characters", ",", 
           RowBox[{"Length", "[", "eList", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eListComplement", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Keys", "[", " ", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
         "eList"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nonGeneratorsAssoc", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{"eListComplement", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "eListComplement", "]"}]}], "}"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"generatorsAssoc", ",", "nonGeneratorsAssoc"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "eList", "]"}], "\[LessEqual]", 
    RowBox[{"Length", "[", "characters", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgesToGenerators", "[", 
   RowBox[{"squareComplex_", ",", "eList_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Too few characters to act as generators\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "Abort"}]}], "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "eList", "]"}], ">", 
    RowBox[{"Length", "[", "characters", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareBoundaryInverseQ", "[", 
   RowBox[{"squareComplex_", ",", "s1_", ",", "sequence_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"boundaryList", ",", "e1", ",", "eNext", ",", "eOpp"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"boundaryList", "=", 
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "s1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e1", "=", 
      RowBox[{"boundaryList", "[", 
       RowBox[{"[", "sequence", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eNext", "=", 
      RowBox[{"boundaryList", "[", 
       RowBox[{"[", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"sequence", "+", "1"}], ",", "4", ",", "1"}], "]"}], " ", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eOpp", "=", 
      RowBox[{"boundaryList", "[", 
       RowBox[{"[", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"sequence", "+", "2"}], ",", "4", ",", "1"}], "]"}], " ", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeLoopQ", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{
        "orientations", " ", "of", " ", "opposite", " ", "sides", " ", "of", 
         " ", "squares", " ", "should", " ", "match", " ", "to", " ", 
         "respect", " ", "the", " ", "product", " ", "structure", " ", "of", 
         " ", "the", " ", "square", " ", "in", " ", "a", " ", "side", " ", 
         "is", " ", "an", " ", "edge", " ", "loop"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edgeLoopQ", "[", 
          RowBox[{"squareComplex", ",", "eOpp"}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "if", " ", "both", " ", "e1", " ", "and", " ", "eOpp", " ", "are", 
           " ", "loops", " ", "we", " ", "use", " ", "the", " ", "convention",
            " ", "that", " ", "the", " ", "first", " ", "and", " ", "second", 
           " ", "edges", " ", "in", " ", "boundaryList", " ", "are", " ", 
           "oriented", " ", "cyclically", " ", "wrt", " ", "toe", " ", 
           "boundary", " ", "of", " ", "the", " ", "square"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], ",", "sequence"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"squareBoundaryInverseQ", "[", 
           RowBox[{"squareComplex", ",", "s1", ",", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"sequence", "+", "2"}], ",", "4", ",", "1"}], "]"}]}], 
           "]"}], "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
         "otherwise", " ", "we", " ", "give", " ", "e1", " ", "the", " ", 
          "opposit", " ", "orientation", " ", "to", " ", "eOpp"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "eNext"}], "]"}], ",", 
         RowBox[{"initialVertex", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "if", " ", "an", " ", "edge", " ", "is", " ", "not", " ", "a", " ", 
         "loop"}], ",", " ", 
        RowBox[{
        "it", " ", "has", " ", "the", " ", "orientation", " ", "induced", " ",
          "by", " ", "the", " ", "ordering", " ", "of", " ", "its", " ", 
         "endpoints"}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareBoundaryEdgeToGenerator", "[", 
   RowBox[{"squareComplex_", ",", "s1_", ",", "sequence_", ",", "eList_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"generatorsAssoc", ",", "boundaryList"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"boundaryList", "=", 
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "s1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"generatorsAssoc", "=", 
      RowBox[{"edgesToGenerators", "[", 
       RowBox[{"squareComplex", ",", "eList"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"squareBoundaryInverseQ", "[", 
        RowBox[{"squareComplex", ",", "s1", ",", "sequence"}], "]"}], ",", 
       RowBox[{"inverse", "[", " ", 
        RowBox[{"generatorsAssoc", "[", 
         RowBox[{"[", " ", 
          RowBox[{"boundaryList", "[", 
           RowBox[{"[", "sequence", "]"}], "]"}], " ", "]"}], "]"}], " ", 
        "]"}], ",", 
       RowBox[{"generatorsAssoc", "[", 
        RowBox[{"[", " ", 
         RowBox[{"boundaryList", "[", 
          RowBox[{"[", "sequence", "]"}], "]"}], " ", "]"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareToRelation", "[", 
   RowBox[{"squareComplex_", ",", "eList_", ",", "s1_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"squareBoundaryEdgeToGenerator", "[", 
      RowBox[{"squareComplex", ",", "s1", ",", "i", ",", "eList"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fundamentalGroupPresentation", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "contractableSubComplex", ",", "nullEdges", ",", "edgeList", ",", 
      "generatorsAssoc", ",", "generators", ",", "nullSquares", ",", 
      "squareList", ",", "relations"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"contractableSubComplex", "=", 
      RowBox[{"maximalContractableSubComplex", "[", "squareComplex", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"nullEdges", "=", 
      RowBox[{"Keys", "[", " ", 
       RowBox[{"contractableSubComplex", "[", 
        RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgeList", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Keys", "[", " ", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
        "nullEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"generatorsAssoc", "=", 
      RowBox[{"edgesToGenerators", "[", 
       RowBox[{"squareComplex", ",", "edgeList"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"generators", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"generatorsAssoc", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "edgeList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nullSquares", "=", 
      RowBox[{"Keys", "[", " ", 
       RowBox[{"contractableSubComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"squareList", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Keys", "[", " ", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
        "nullSquares"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"relations", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"squareToRelation", "[", 
           RowBox[{"squareComplex", ",", "edgeList", ",", "#"}], "]"}], "&"}],
          "/@", "squareList"}], ",", 
        RowBox[{"{", "\"\<\>\"", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<generators\>\"", "\[Rule]", "generators"}], ",", 
       RowBox[{"\"\<relations\>\"", "\[Rule]", "relations"}]}], "|>"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193798481098804`*^9, 3.8193799361205254`*^9}, 
   3.8193875673190527`*^9, {3.8193876049587617`*^9, 3.8193878320615873`*^9}, {
   3.8193878657335443`*^9, 3.819387885292304*^9}, {3.8193879748213105`*^9, 
   3.81938804747933*^9}, {3.8193880802518473`*^9, 3.819388724216161*^9}, {
   3.8193887587504683`*^9, 3.8193887781913023`*^9}, {3.819398467929713*^9, 
   3.819398470553192*^9}, {3.8193989007575073`*^9, 3.81939913558997*^9}, {
   3.8193992991873865`*^9, 3.8193993196765423`*^9}, {3.8193994985218077`*^9, 
   3.8193995924884424`*^9}, {3.8193996837171373`*^9, 3.819399746597863*^9}, {
   3.8194000814867496`*^9, 3.8194000828716235`*^9}, {3.8194017900157757`*^9, 
   3.819402145428773*^9}, {3.8194021839585915`*^9, 3.8194022311450033`*^9}, {
   3.819402273604845*^9, 3.819402287876258*^9}, {3.8194023340544496`*^9, 
   3.8194023513248844`*^9}, {3.8194586930784063`*^9, 
   3.8194587102927847`*^9}, {3.8194588114885087`*^9, 
   3.8194589144719296`*^9}, {3.81946017833992*^9, 3.8194601804327555`*^9}, {
   3.819463828162916*^9, 3.81946383204493*^9}, 3.8194772101556683`*^9, {
   3.8194772435115585`*^9, 3.819477378067156*^9}, 3.8194774295757885`*^9, {
   3.819477467085416*^9, 3.8194775694452457`*^9}, {3.819477610607685*^9, 
   3.8194777328391333`*^9}, {3.8194777631721787`*^9, 
   3.8194779516460896`*^9}, {3.819478445649724*^9, 3.8194786022665424`*^9}, {
   3.819478741044983*^9, 3.8194787776611476`*^9}, {3.8194788340342197`*^9, 
   3.8194790603158665`*^9}, {3.8194840158592434`*^9, 3.819484035444843*^9}, {
   3.8196512856112404`*^9, 3.819651297491124*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"7c95077c-7220-4885-8d49-b52275d57cca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Removing obviously redundant generators and relations", "Subsection",
 CellChangeTimes->{{3.819479761302343*^9, 
  3.819479791392047*^9}},ExpressionUUID->"55c4aca5-88f0-4c59-b73e-\
b8a208ad1c7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cyclicallyPermute", "[", 
   RowBox[{"word_", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"word", ",", 
     RowBox[{"-", "1"}]}], "]"}], "<>", 
   RowBox[{"StringDrop", "[", 
    RowBox[{"word", ",", 
     RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclicallyPermute", "[", 
   RowBox[{"word_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"cyclicallyPermute", "[", 
   RowBox[{
    RowBox[{"cyclicallyPermute", "[", 
     RowBox[{"word", ",", "1"}], "]"}], ",", 
    RowBox[{"n", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relationADefinitionQ", "[", 
   RowBox[{"word_", ",", "letter_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCount", "[", 
    RowBox[{"word", ",", 
     RowBox[{"{", 
      RowBox[{"letter", ",", 
       RowBox[{"inverse", "[", "letter", "]"}]}], "}"}]}], "]"}], "\[Equal]", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relationADefinitionQ", "[", "word_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"relationADefinitionQ", "[", 
         RowBox[{"word", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"word", ",", 
            RowBox[{"{", "i", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"StringLength", "[", "word", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relationToDefinition", "[", "word_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"generator", ",", "position", ",", "definition"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"generator", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"StringReverse", "[", "word", "]"}], ",", 
              RowBox[{"{", "i", "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"StringLength", "[", "word", "]"}]}], "}"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{"relationADefinitionQ", "[", 
           RowBox[{"word", ",", "#"}], "]"}], "&"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"position", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{
          RowBox[{"StringReverse", "[", "word", "]"}], ",", "generator", ",", 
          "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"definition", "=", 
      RowBox[{"freelyReduce", "[", 
       RowBox[{"StringDrop", "[", 
        RowBox[{
         RowBox[{"cyclicallyPermute", "[", 
          RowBox[{"word", ",", "position"}], "]"}], ",", "1"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"generator", "\[Rule]", 
        RowBox[{"inverse", "[", "definition", "]"}]}], ",", 
       RowBox[{
        RowBox[{"inverse", "[", "generator", "]"}], "\[Rule]", 
        "definition"}]}], "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"containsRelationDefinitionQ", "[", "presentation_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"relationADefinitionQ", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"presentation", "[", 
        RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleDefinition", "[", "presentation_", "]"}], ":=", 
  RowBox[{"relationToDefinition", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"presentation", "[", 
       RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"relationADefinitionQ", "[", "#", "]"}], "&"}], ",", "1"}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"applyDefinition", "[", 
   RowBox[{"presentation_", ",", "definition_"}], "]"}], ":=", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<generators\>\"", "\[Rule]", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"presentation", "[", 
        RowBox[{"[", "\"\<generators\>\"", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ToLowerCase", "[", " ", 
         RowBox[{
          RowBox[{"Keys", "[", "definition", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<relations\>\"", "\[Rule]", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"freelyReduce", "[", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Normal", "[", "definition", "]"}]}], "]"}], "]"}], "&"}],
         "/@", 
        RowBox[{"presentation", "[", 
         RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}]}], ",", 
       RowBox[{"{", "\"\<\>\"", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "|>"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeRedundantGenerators", "[", "presentation_", "]"}], ":=", 
  RowBox[{"presentation", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"containsRelationDefinitionQ", "[", "presentation", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeRedundantGenerators", "[", "presentation_", "]"}], ":=", 
  RowBox[{"removeRedundantGenerators", "[", 
   RowBox[{"applyDefinition", "[", 
    RowBox[{"presentation", ",", 
     RowBox[{"possibleDefinition", "[", "presentation", "]"}]}], "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8194800331063023`*^9, 3.819480044991971*^9}, {
   3.8194800899221983`*^9, 3.819480267680849*^9}, {3.8194803026323323`*^9, 
   3.8194803787279663`*^9}, {3.8194804149199877`*^9, 3.819480539254074*^9}, {
   3.8194826274554405`*^9, 3.8194826328082275`*^9}, {3.819482665501811*^9, 
   3.819482869779372*^9}, 3.819482908991353*^9, 3.8194829560645638`*^9, {
   3.8194829977965617`*^9, 3.81948299885804*^9}, {3.8194830426598377`*^9, 
   3.8194830435782146`*^9}, {3.819483180071759*^9, 3.8194831808869405`*^9}, {
   3.819483318563142*^9, 3.819483330529813*^9}, {3.819483468468009*^9, 
   3.8194835291564593`*^9}, {3.8194836127798643`*^9, 3.819483627070826*^9}, {
   3.819483862393791*^9, 3.8194838737483335`*^9}, 3.819484092081711*^9, {
   3.8194842087343225`*^9, 3.8194842301563845`*^9}, {3.819485008759873*^9, 
   3.819485227349491*^9}, {3.8194852740464787`*^9, 3.819485295333694*^9}, {
   3.8194853548962545`*^9, 3.8194855333246336`*^9}, {3.8194855737607784`*^9, 
   3.819485613865852*^9}, {3.819485646979667*^9, 3.819485792253945*^9}, {
   3.819485926008272*^9, 3.8194859261219034`*^9}, {3.8194860246339073`*^9, 
   3.819486027975118*^9}, {3.819486088977791*^9, 3.8194860906984835`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"b5b3eed7-3594-4cad-8ef0-40a9a2c4bb15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Removing non-obviously redundant generators and relations", "Subsection",
 CellChangeTimes->{{3.8195473918842535`*^9, 
  3.819547425635824*^9}},ExpressionUUID->"9e7b23f0-4338-4ffd-8936-\
8b2258cb7458"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"redundantRelation", "[", "presentation_", "]"}], ":=", 
  RowBox[{
   RowBox[{"redundantRelation", "[", "presentation", "]"}], "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"presentation", "[", 
      RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"primitiveElementQ", "[", 
       RowBox[{
        RowBox[{"presentation", "[", 
         RowBox[{"[", "\"\<generators\>\"", "]"}], "]"}], ",", "#"}], "]"}], 
      "&"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"containsRedundantRelationQ", "[", "presentation_", "]"}], ":=", 
  RowBox[{"Not", "[", 
   RowBox[{
    RowBox[{"redundantRelation", "[", "presentation", "]"}], "\[Equal]", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rewrite", "[", 
    RowBox[{"word_", ",", "inverseAut_"}], "]"}], ":=", 
   RowBox[{"aut", "[", 
    RowBox[{"word", ",", "inverseAut"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Let", " ", "word", " ", "be", " ", "written", " ", "in", " ", "terms", 
     " ", "of", " ", "X"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "want", " ", "to", " ", "rewrite", " ", "it", " ", "in", " ", 
      "terms", " ", "of", " ", "Y"}], "=", 
     RowBox[{"aut", "[", "X", "]"}]}], ",", " ", 
    RowBox[{"for", " ", "which", " ", "we", " ", "need", " ", "only", " ", 
     RowBox[{"inverseAut", ".", " ", "Note"}], " ", "that", " ", "the", " ", 
     "output", " ", "looks", " ", "like", " ", "a", " ", "word", " ", "in", 
     " ", "X"}], ",", " ", 
    RowBox[{
    "but", " ", "should", " ", "be", " ", "thought", " ", "of", " ", "as", 
     " ", "a", " ", "word", " ", "in", " ", "Y"}], ",", " ", 
    RowBox[{"where", " ", "we", " ", "have", " ", "replabelled", " ", 
     RowBox[{"aut", "[", "x", "]"}], " ", "with", " ", "x"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeARedunadantRelation", "[", "presentation_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "redRel", ",", "wordAut", ",", "redGen", ",", "inverseAut", ",", 
       "newRelations"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"redRel", "=", 
       RowBox[{
        RowBox[{"redundantRelation", "[", "presentation", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wordAut", "=", 
       RowBox[{"whiteheadReduce", "[", 
        RowBox[{
         RowBox[{"presentation", "[", 
          RowBox[{"[", "\"\<generators\>\"", "]"}], "]"}], ",", "redRel"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"redGen", "=", 
       RowBox[{"ToLowerCase", "[", 
        RowBox[{"wordAut", "[", 
         RowBox[{"[", "\"\<word\>\"", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inverseAut", "=", 
       RowBox[{"wordAut", "[", 
        RowBox[{"[", "\"\<inverseAut\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newRelations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"freelyReduce", "[", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"rewrite", "[", 
             RowBox[{"#", ",", "inverseAut"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"redGen", "\[Rule]", "\"\<\>\""}], ",", 
              RowBox[{
               RowBox[{"inverse", "[", "redGen", "]"}], "\[Rule]", 
               "\"\<\>\""}]}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"presentation", "[", 
           RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}], ",", 
          RowBox[{"{", "redRel", "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<generators\>\"", "\[Rule]", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"presentation", "[", 
            RowBox[{"[", "\"\<generators\>\"", "]"}], "]"}], ",", 
           RowBox[{"{", "redGen", "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<relations\>\"", "\[Rule]", "newRelations"}]}], 
       "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "NB", " ", "this", " ", "outputs", " ", "a", " ", "presentation", " ", 
     "with", " ", "generators", " ", "represented", " ", "by", " ", "the", 
     " ", "same", " ", "symbols", " ", "an", " ", "the", " ", "generators", 
     " ", "on", " ", "the", " ", "input", " ", "presentation"}], ",", " ", 
    RowBox[{
    "however", " ", "these", " ", "do", " ", "not", " ", "represnet", " ", 
     "the", " ", "same", " ", "elements", " ", "in", " ", "isomorphic", " ", 
     "groups"}], ",", " ", 
    RowBox[{
    "they", " ", "represent", " ", "completely", " ", "different", " ", 
     "group", " ", 
     RowBox[{"elements", ".", " ", "What"}], " ", "is", " ", "true", " ", 
     "is", " ", "that", " ", "the", " ", "input", " ", "and", " ", "output", 
     " ", "presentations", " ", "define", " ", "isomorphic", " ", "groups", 
     " ", "useing", " ", "different", " ", "size", " ", "generating", " ", 
     "sets"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeRedundantRelations", "[", "presentation_", "]"}], ":=", 
  RowBox[{"presentation", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{"containsRedundantRelationQ", "[", "presentation", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeRedundantRelations", "[", "presentation_", "]"}], ":=", 
  RowBox[{"removeRedundantRelations", "[", "\[IndentingNewLine]", 
   RowBox[{"removeARedunadantRelation", "[", "presentation", "]"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simplifyPresentation", "[", "presentation_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"removeRedundantRelations", "[", 
   RowBox[{"removeRedundantGenerators", "[", "presentation", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeGroupQ", "[", "presentation_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"simplifyPresentation", "[", "presentation", "]"}], "[", 
    RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}], "\[Equal]", 
   RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeComplexQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"freeGroupQ", "[", 
   RowBox[{"fundamentalGroupPresentation", "[", "squareComplex", "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQHXX0wcGE0jeOYQu2XADRnySUroJoiRm6j0E0n+rl
NyC6kPn+OxC9gDU5JBFIe/28nwKik2b8zQHR52R2N4Nou/Ybn0H00vM3voPo
k8n+jElAeg/PbRYQ/adwKTeIZhFt1QbTB0LMQfRVjSn+IFoiUrMKRL9ksAPT
B2TtG0B01OyTYFrv6MSNYHOuH9gCot3KoqSSgXRZ3DELEF00fYYNiJYJN3YD
0V3WvxpAdPqyiEYQba67uy8FSLe9ypgEolWeTelOB9KrDoROBNFBE05/AdHz
brz6CqJfOytxZIDc0bEaTDN1dyiD6BPeJqogeqtlcFpc2RvHHREnwDQA0u6p
jA==
  "],
 CellLabel->
  "In[166]:=",ExpressionUUID->"2c156775-f606-46b2-bb60-880c58d49626"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geodesics in trees", "Subsection",
 CellChangeTimes->{{3.820140347625208*^9, 3.820140379196463*^9}, {
  3.820142588958679*^9, 
  3.8201425936106176`*^9}},ExpressionUUID->"263c0915-9351-40f2-a40d-\
6abb8362db91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeBetweenQ", "[", 
   RowBox[{"tree_", ",", "v1_", ",", "v2_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"forest", ",", "v1Component"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"forest", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<vertices\>\"", "\[Rule]", 
         RowBox[{"tree", "[", 
          RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<edges\>\"", "\[Rule]", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"tree", "[", 
            RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", "e1"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<squares\>\"", "\[Rule]", 
         RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v1Component", "=", 
      RowBox[{"connectedComponent", "[", 
       RowBox[{"forest", ",", 
        RowBox[{"{", "v1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"v1Component", "[", 
         RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", "v2"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextEdgeBetween", "[", 
   RowBox[{"tree_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"incidentEdges", "[", 
      RowBox[{"tree", ",", "v1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"edgeBetweenQ", "[", 
       RowBox[{"tree", ",", "v1", ",", "v2", ",", "#"}], "]"}], "&"}]}], 
    "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"geodesicEdgeList", "[", 
   RowBox[{"tree_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", "}"}], "/;", 
   RowBox[{"v1", "\[Equal]", "v2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"geodesicEdgeList", "[", 
   RowBox[{"tree_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nextEdge", ",", "nextVertex"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nextEdge", "=", 
      RowBox[{"nextEdgeBetween", "[", 
       RowBox[{"tree", ",", "v1", ",", "v2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nextVertex", "=", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"tree", ",", "nextEdge"}], "]"}], ",", 
         RowBox[{"{", "v1", "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "nextEdge", "}"}], ",", 
       RowBox[{"geodesicEdgeList", "[", 
        RowBox[{"tree", ",", "nextVertex", ",", "v2"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeToCycle", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Join", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"geodesicEdgeList", "[", 
     RowBox[{
      RowBox[{"maximalSubTree", "[", "squareComplex", "]"}], ",", 
      "\"\<v0\>\"", ",", 
      RowBox[{"initialVertex", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "e1", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"geodesicEdgeList", "[", 
     RowBox[{
      RowBox[{"maximalSubTree", "[", "squareComplex", "]"}], ",", 
      RowBox[{"terminalVertex", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", "\"\<v0\>\""}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeToWord", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "#", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"edgeToCycle", "[", 
     RowBox[{"squareComplex", ",", "e1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generatorsToWords", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "contractableSubComplex", ",", "nullEdges", ",", "edgeList", ",", 
      "generatorsAssoc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"contractableSubComplex", "=", 
      RowBox[{"maximalContractableSubComplex", "[", "squareComplex", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"nullEdges", "=", 
      RowBox[{"Keys", "[", " ", 
       RowBox[{"contractableSubComplex", "[", 
        RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgeList", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Keys", "[", " ", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
        "nullEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"generatorsAssoc", "=", 
      RowBox[{"edgesToGenerators", "[", 
       RowBox[{"squareComplex", ",", "edgeList"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociationThread", "[", 
      RowBox[{
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Values", "[", "generatorsAssoc", "]"}], ",", 
         RowBox[{"{", "\"\<\>\"", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeToWord", "[", 
          RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
        "edgeList"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820143055495345*^9, 3.8201430951059046`*^9}, {
  3.8201431273194704`*^9, 3.82014321089126*^9}, {3.82014326177977*^9, 
  3.820143366648719*^9}, {3.820143459549396*^9, 3.8201436196909375`*^9}, {
  3.8201436954917192`*^9, 3.8201437950163116`*^9}, {3.8201438300317297`*^9, 
  3.8201438742035785`*^9}, {3.8201439172161727`*^9, 3.8201439474338746`*^9}, {
  3.8201468322978354`*^9, 3.820146862492672*^9}, {3.820146894297536*^9, 
  3.82014692942848*^9}, {3.820146970667626*^9, 3.82014700497761*^9}, {
  3.820147039566247*^9, 3.8201471193730583`*^9}, {3.820147178437405*^9, 
  3.8201471900898676`*^9}, {3.8201481858830776`*^9, 3.820148338582705*^9}, {
  3.8201500008832817`*^9, 3.8201500014701796`*^9}, {3.8201500939188166`*^9, 
  3.820150094785365*^9}, {3.8201517774653*^9, 3.8201517973328753`*^9}, {
  3.8201549318709145`*^9, 3.820154941638522*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"29fa101f-2da6-42dc-aaf5-b551fff4a91b"]
}, Closed]],

Cell[CellGroupData[{

Cell["From presentations to subgroups of Coxeter groups", "Subsection",
 CellChangeTimes->{{3.820140347625208*^9, 
  3.820140379196463*^9}},ExpressionUUID->"dd746a5a-dfd0-44e9-9123-\
6e310187b144"],

Cell[BoxData[
 RowBox[{
  RowBox[{"presentationToSubgroup", "[", 
   RowBox[{"presentation_", ",", "generatorsToWords_"}], "]"}], ":=", 
  RowBox[{"/;", 
   RowBox[{
    RowBox[{
     RowBox[{"presentation", "[", 
      RowBox[{"[", "\"\<relations\>\"", "]"}], "]"}], "\[Equal]", 
     RowBox[{"{", "}"}]}], "||", 
    RowBox[{"Not", "[", 
     RowBox[{"containsRedundantRelationQ", "[", "presentation", "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.820155317363429*^9, 3.8201553478191223`*^9}, {
  3.8201554005015664`*^9, 3.820155415345685*^9}, {3.8201556444192677`*^9, 
  3.8201556603961487`*^9}},ExpressionUUID->"59886657-fa34-4dbf-8cb4-\
09c2103bd2a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"removeRedundantGenerators", "[", 
  RowBox[{"fundamentalGroupPresentation", "[", "example6", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8201424912975297`*^9, 3.8201424944480624`*^9}, {
  3.8201551818379154`*^9, 3.820155195714326*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"8ab3c407-8e4e-4f52-a196-00e933889aa7"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"generators\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"e\"\>", ",", "\<\"f\"\>", ",", "\<\"h\"\>", 
      ",", "\<\"k\"\>"}], "}"}]}], ",", 
   RowBox[{"\<\"relations\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"kFKfEheH\"\>", "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.820155196547677*^9},
 CellLabel->
  "Out[335]=",ExpressionUUID->"8c020f5c-0195-4ba5-904c-92e2b36e3d97"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"example6", "=", 
   RowBox[{"completion", "[", 
    RowBox[{"raPentagon", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<13\>\"", ",", "\"\<24\>\"", ",", "\"\<5135\>\"", ",", 
       "\"\<5245\>\""}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8201484413530817`*^9, 3.8201485108112855`*^9}, {
  3.8201494511525154`*^9, 3.820149453261259*^9}, {3.820154985215517*^9, 
  3.8201550354670453`*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"66f634db-4fa5-44cc-bb90-a5e270478e3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tree6", "=", 
   RowBox[{"maximalSubTree", "[", "example6", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8201485373526077`*^9, 3.8201485559161806`*^9}, {
  3.8201494355407248`*^9, 3.820149435888273*^9}, {3.8201494718105097`*^9, 
  3.8201494737151604`*^9}, {3.820155046576926*^9, 3.820155060366974*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"8605c1b7-64bf-48d3-b587-11e56da9282c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generatorsToWords", "[", "example6", "]"}]], "Input",
 CellChangeTimes->{{3.820149935599443*^9, 3.8201499445857983`*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"ee60ffb4-08e8-41d5-bfb4-f1d1406913a2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"a\"\>", "\[Rule]", "\<\"5425\"\>"}], ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", "\<\"1421\"\>"}], ",", 
   RowBox[{"\<\"c\"\>", "\[Rule]", "\<\"2321\"\>"}], ",", 
   RowBox[{"\<\"d\"\>", "\[Rule]", "\<\"2525\"\>"}], ",", 
   RowBox[{"\<\"e\"\>", "\[Rule]", "\<\"125415\"\>"}], ",", 
   RowBox[{"\<\"f\"\>", "\[Rule]", "\<\"512415\"\>"}], ",", 
   RowBox[{"\<\"g\"\>", "\[Rule]", "\<\"521415\"\>"}], ",", 
   RowBox[{"\<\"h\"\>", "\[Rule]", "\<\"31\"\>"}], ",", 
   RowBox[{"\<\"i\"\>", "\[Rule]", "\<\"523415\"\>"}], ",", 
   RowBox[{"\<\"j\"\>", "\[Rule]", "\<\"42\"\>"}], ",", 
   RowBox[{"\<\"k\"\>", "\[Rule]", "\<\"5315\"\>"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8201500757331905`*^9, 3.820150102610339*^9}, 
   3.82015186768764*^9, {3.8201550639317703`*^9, 3.820155069416912*^9}},
 CellLabel->
  "Out[334]=",ExpressionUUID->"a9e3b0f2-59d4-4044-ae07-2b3131951ca8"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Folding square complexes", "Chapter",
 CellChangeTimes->{{3.819400052736648*^9, 
  3.819400060761092*^9}},ExpressionUUID->"b1f57003-e33d-4e61-866f-\
19dbcd39548a"],

Cell[CellGroupData[{

Cell["Counting moves", "Section",
 CellChangeTimes->{{3.843292832030118*^9, 
  3.843292842800087*^9}},ExpressionUUID->"74d67cbe-bc11-4383-a67d-\
2e99b07ad050"],

Cell["\<\
Sometimes it is useful to know how many moves have been performed in a given \
completion sequence. To find this out, initialise these variables to 0, \
compute the completion, and then evaluate moveCount.\
\>", "Text",
 CellChangeTimes->{{3.8200850133000836`*^9, 
  3.820085080556422*^9}},ExpressionUUID->"c2e0f75c-933d-4ca1-bc75-\
f35520c41725"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeFoldCount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFoldCount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachCount", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"moveCount", ":=", 
   RowBox[{
    RowBox[{"ToString", "[", "edgeFoldCount", "]"}], "<>", 
    "\"\< edges have been folded, \>\"", "<>", 
    RowBox[{"ToString", "[", "squareFoldCount", "]"}], "<>", 
    "\"\< squares have been folded, and \>\"", "<>", 
    RowBox[{"ToString", "[", "squareAttachCount", "]"}], "<>", 
    "\"\< squares have been attached.\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"initialiseCounts", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"edgeFoldCount", "=", "0"}], ";", 
     RowBox[{"squareFoldCount", "=", "0"}], ";", 
     RowBox[{"squareAttachCount", "=", "0"}], ";"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8200846414058714`*^9, 3.8200849468644753`*^9}, {
  3.8200849856057034`*^9, 3.820085005181203*^9}, {3.8200853720711384`*^9, 
  3.82008540454731*^9}, {3.8200854373090706`*^9, 3.8200854374505806`*^9}, {
  3.8200855031306267`*^9, 3.8200855182875423`*^9}, {3.820085571483272*^9, 
  3.8200855736886806`*^9}, {3.8200859711090093`*^9, 3.8200859711289363`*^9}, {
  3.820086875150629*^9, 3.8200868752316246`*^9}, {3.820140236667695*^9, 
  3.820140246355212*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"943cd27e-e6ad-4f19-abe7-7ee4e1fe3042"]
}, Closed]],

Cell[CellGroupData[{

Cell["Folding edges", "Section",
 CellChangeTimes->{{3.8191108447056828`*^9, 
  3.8191108497786355`*^9}},ExpressionUUID->"eecf9f17-3391-4b0b-8b9b-\
8c2e6c37568c"],

Cell[CellGroupData[{

Cell["Possible edge folds", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 
  3.8193023376798086`*^9}},ExpressionUUID->"6ecdbb72-578c-4d9d-956f-\
b810bf6a68c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "vertex_", ",", "edgeLabel_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"incidentEdgeLabels", "[", 
         RowBox[{"squareComplex", ",", "vertex"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "==", "edgeLabel"}], "&"}]}], "]"}], "]"}], 
     "\[GreaterEqual]", "2"}], ",", "True", ",", "False"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "vertex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Fold", "[", 
    RowBox[{"Or", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"edgeFoldPossibleQ", "[", 
        RowBox[{"squareComplex", ",", "vertex", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"incidentEdgeLabels", "[", 
       RowBox[{"squareComplex", ",", "vertex"}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentEdgeLabels", "[", 
      RowBox[{"squareComplex", ",", "vertex"}], "]"}], "]"}], 
    "\[GreaterEqual]", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "vertex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"edgeFoldPossibleQ", "[", 
    RowBox[{"squareComplex", ",", "vertex", ",", 
     RowBox[{
      RowBox[{"incidentEdgeLabels", "[", 
       RowBox[{"squareComplex", ",", "vertex"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentEdgeLabels", "[", 
      RowBox[{"squareComplex", ",", "vertex"}], "]"}], "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "vertex_"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentEdgeLabels", "[", 
      RowBox[{"squareComplex", ",", "vertex"}], "]"}], "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Fold", "[", " ", 
    RowBox[{"Or", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"edgeFoldPossibleQ", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}]}], " ", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "]"}], "\[GreaterEqual]",
     "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"edgeFoldPossibleQ", "[", 
    RowBox[{"squareComplex", ",", 
     RowBox[{
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleEdgeFolds", "[", 
   RowBox[{"squareComplex_", ",", "vertex_", ",", "edgeLabel_"}], "]"}], ":=", 
  RowBox[{"Subsets", "[", 
   RowBox[{
    RowBox[{"incidentEdges", "[", 
     RowBox[{"squareComplex", ",", "vertex", ",", "edgeLabel"}], "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleEdgeFolds", "[", 
   RowBox[{"squareComplex_", ",", "vertex_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Join", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"possibleEdgeFolds", "[", 
       RowBox[{"squareComplex", ",", "vertex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"incidentEdgeLabels", "[", 
       RowBox[{"squareComplex", ",", "vertex"}], "]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleEdgeFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{"Join", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"possibleEdgeFolds", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}]}], "]"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8195281227615576`*^9, 3.8195281606646824`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"d338cf4e-db08-44a1-a2a5-67adccc4c990"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Folding edges", "Subsection",
 CellChangeTimes->{{3.8193024527295446`*^9, 
  3.819302454789172*^9}},ExpressionUUID->"9b5f6054-d833-4a6f-9648-\
ea9a16a6c3bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foldType", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Or", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", "\"\<Type II\>\"", ",", 
    "\[IndentingNewLine]", "\"\<Type I\>\""}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFold", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mineIndex", ",", "maxeIndex"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mineIndex", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"e1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"e2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"maxeIndex", "=", 
       RowBox[{"ToString", "[", 
        RowBox[{"Max", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"e1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringDrop", "[", 
             RowBox[{"e2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"reindexEdges", "[", 
       RowBox[{"squareComplex", ",", 
        RowBox[{"{", 
         RowBox[{"maxeIndex", "\[Rule]", "mineIndex"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{
    RowBox[{"foldType", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "\[Equal]", 
    "\"\<Type II\>\""}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeFold", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v0", ",", "v1", ",", "v2", ",", "minvIndex", ",", "maxvIndex"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v0", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"edgeVertices", "[", 
            RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v0", "==", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v0", "==", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"minvIndex", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"maxvIndex", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"Max", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringDrop", "[", 
            RowBox[{"v2", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edgeFold", "[", 
      RowBox[{
       RowBox[{"reindexVertices", "[", 
        RowBox[{"squareComplex", ",", 
         RowBox[{"{", 
          RowBox[{"maxvIndex", "\[Rule]", "minvIndex"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldEdges", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"edgeFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleEdgeFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193024933100295`*^9, 3.8193024938424797`*^9}, {
  3.8195281704217873`*^9, 3.8195281735807104`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"e8ec5cf9-6205-495e-b96c-cd53bae590fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Freely folding edges", "Subsection",
 CellChangeTimes->{{3.819302470309471*^9, 
  3.819302482200614*^9}},ExpressionUUID->"2ef540d1-c524-467f-89a0-\
d0ccf52ab348"],

Cell["\<\
Free edge folds are sorted into three types: those which obviously result in \
a free complex because they are type I or involve an edge without any \
incident edges; those which aren\[CloseCurlyQuote]t obviously free,but which \
nevertheless result in a square complex which deformation retracts onto a \
graph; and finally those which result in a complex with non-trivial second \
homology perhaps, but nevertheless have free fundamental group.\
\>", "Text",
 CellChangeTimes->{{3.8198998830127797`*^9, 3.8199000550548463`*^9}, {
  3.81990009101457*^9, 
  3.8199001503793592`*^9}},ExpressionUUID->"927dc486-1fa0-4112-b7d3-\
90b67b19a3ca"],

Cell[CellGroupData[{

Cell["Obviously free folds", "Subsubsection",
 CellChangeTimes->{{3.8199001612912188`*^9, 
  3.8199001662897325`*^9}},ExpressionUUID->"57d8e237-3a5f-497a-991b-\
ff818be83e53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"obviousFreeEdgeFoldQ", "[", 
    RowBox[{"squareComplex_", ",", 
     RowBox[{"{", 
      RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"foldType", "[", 
       RowBox[{"squareComplex", ",", 
        RowBox[{"{", 
         RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "\[Equal]", 
      "\"\<Type I\>\""}], ",", "\[IndentingNewLine]", "True", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"freeEdgeQ", "[", 
         RowBox[{"squareComplex", ",", "e1"}], "]"}], "||", 
        RowBox[{"freeEdgeQ", "[", 
         RowBox[{"squareComplex", ",", "e2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"graphQ", "[", 
        RowBox[{"fullSquareDeformationRetraction", "[", 
         RowBox[{"edgeFold", "[", 
          RowBox[{"squareComplex", ",", 
           RowBox[{"{", 
            RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "liable", " ", "to", " ", "false", " ", 
     "negatives"}], ",", " ", 
    RowBox[{
    "which", " ", "we", " ", "can", " ", "eliminate", " ", "with", " ", "a", 
     " ", "much", " ", "slower", " ", "algorithm", " ", "which", " ", "we", 
     " ", "will", " ", "apply", " ", "separately", " ", "when", " ", "all", 
     " ", "of", " ", "these", " ", "free", " ", "folds", " ", "have", " ", 
     "been", " ", "performed"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleObviousFreeEdgeFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"possibleEdgeFolds", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"obviousFreeEdgeFoldQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"possibleObviousFreeEdgeFolds", "[", "squareComplex", "]"}], 
    "]"}], "\[GreaterEqual]", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldObviousEdgesFreely", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"edgeFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleObviousFreeEdgeFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819188395166962*^9, 3.819188395339384*^9}, {
   3.8191885002002583`*^9, 3.8191885003537626`*^9}, {3.8191885707888193`*^9, 
   3.8191885881246324`*^9}, {3.81918862994736*^9, 3.8191886640410366`*^9}, {
   3.8191887172053385`*^9, 3.819188851314679*^9}, {3.8191891247008505`*^9, 
   3.819189131595572*^9}, {3.8191892016363754`*^9, 3.8191892023953667`*^9}, {
   3.8191892557339687`*^9, 3.8191892589183755`*^9}, {3.8191893007906885`*^9, 
   3.819189306651663*^9}, {3.8191896277881436`*^9, 3.8191897043578444`*^9}, {
   3.8191897454441705`*^9, 3.8191898353453646`*^9}, {3.819189927228434*^9, 
   3.819189940842865*^9}, {3.8191900817361946`*^9, 3.819190125602242*^9}, {
   3.81919161348265*^9, 3.819191616637204*^9}, {3.819191981716552*^9, 
   3.8191919849922943`*^9}, {3.8191921984346404`*^9, 
   3.8191922011876965`*^9}, {3.8191922747301884`*^9, 3.81919230706096*^9}, {
   3.8191926247748327`*^9, 3.8191926473574467`*^9}, {3.8191928010479345`*^9, 
   3.819192811140519*^9}, {3.81919288658914*^9, 3.8191929247416034`*^9}, {
   3.819193007610916*^9, 3.819193037321125*^9}, {3.819193629047282*^9, 
   3.8191937357411437`*^9}, {3.819193784261363*^9, 3.8191938026743317`*^9}, {
   3.8191938466511126`*^9, 3.8191938468453445`*^9}, {3.819193922279689*^9, 
   3.81919395725817*^9}, {3.8191940241752634`*^9, 3.8191940973252673`*^9}, {
   3.819194262656149*^9, 3.8191943393691053`*^9}, {3.8191944124329066`*^9, 
   3.8191944833725038`*^9}, {3.819194529060429*^9, 3.819194547255587*^9}, {
   3.8191946196911135`*^9, 3.819194621874546*^9}, {3.8191958218962917`*^9, 
   3.8191958223219385`*^9}, {3.8191960927079983`*^9, 3.819196102280219*^9}, {
   3.8191964022664347`*^9, 3.8191964143434896`*^9}, {3.8192015293893967`*^9, 
   3.81920174702271*^9}, {3.8192049048299017`*^9, 3.819204933465501*^9}, {
   3.819209980057453*^9, 3.8192100473700857`*^9}, {3.819219036697897*^9, 
   3.819219040966705*^9}, {3.819220504398834*^9, 3.8192205689583035`*^9}, {
   3.819220604089549*^9, 3.819220641940239*^9}, {3.8192206781711216`*^9, 
   3.8192207179602423`*^9}, {3.8192230262296705`*^9, 
   3.8192232146929474`*^9}, {3.819223854085986*^9, 3.8192238561947155`*^9}, {
   3.819273038004916*^9, 3.819273165056959*^9}, {3.8192736224281344`*^9, 
   3.819273623063281*^9}, {3.8192736878833494`*^9, 3.8192737641001434`*^9}, {
   3.8192738003087673`*^9, 3.8192738573196473`*^9}, 3.8192900174822598`*^9, {
   3.8192901011810136`*^9, 3.819290129117649*^9}, {3.8192901772829876`*^9, 
   3.8192902933636026`*^9}, {3.819290461514815*^9, 3.8192906008957644`*^9}, {
   3.8192906343999977`*^9, 3.819290642785435*^9}, {3.819290779976844*^9, 
   3.8192909876586437`*^9}, {3.8192916076107035`*^9, 3.819291623931245*^9}, {
   3.8192916980861454`*^9, 3.8192917080403976`*^9}, {3.8192919029922285`*^9, 
   3.8192919833031054`*^9}, 3.819302342675408*^9, {3.819302418469654*^9, 
   3.8193024914005775`*^9}, {3.819359865446561*^9, 3.8193598662442727`*^9}, {
   3.819360801732194*^9, 3.819360857127556*^9}, {3.8193609019806957`*^9, 
   3.819360902115247*^9}, {3.8193667686599646`*^9, 3.8193667696143723`*^9}, {
   3.8193672076811113`*^9, 3.8193672111969185`*^9}, {3.8195282276662655`*^9, 
   3.8195282323715253`*^9}, {3.819644079629237*^9, 3.8196441293330045`*^9}, {
   3.81964416656658*^9, 3.819644195995826*^9}, {3.819644236403908*^9, 
   3.819644331117631*^9}, {3.8196443779310713`*^9, 3.819644482006045*^9}, {
   3.8196447932161617`*^9, 3.8196448036296916`*^9}, {3.81990019530433*^9, 
   3.8199001963291483`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"101cbc87-decd-4144-b618-ddb406bfd222"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-closing free folds", "Subsubsection",
 CellChangeTimes->{{3.8199001612912188`*^9, 
  3.8199001785796766`*^9}},ExpressionUUID->"7d421757-4fa1-4a0e-886c-\
65e45c7ab9af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonClosingEdgeFoldQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"graphQ", "[", 
   RowBox[{"fullSquareDeformationRetraction", "[", 
    RowBox[{"edgeFold", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleNonClosingEdgeFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"possibleEdgeFolds", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"nonClosingEdgeFoldQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingEdgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"possibleNonClosingEdgeFolds", "[", "squareComplex", "]"}], "]"}],
    "\[GreaterEqual]", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldNonClosingEdges", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"edgeFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleNonClosingEdgeFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819900228109331*^9, 3.8199003951703544`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"7650658f-c294-44f0-ad64-9dc837d22d5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hidden free folds", "Subsubsection",
 CellChangeTimes->{{3.8199001612912188`*^9, 
  3.8199001886609573`*^9}},ExpressionUUID->"59b1d336-ff6f-4a6e-9100-\
5e0a05c2dc2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hiddenFreeEdgeFoldQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"freeComplexQ", "[", 
   RowBox[{"edgeFold", "[", 
    RowBox[{"squareComplex", ",", 
     RowBox[{"{", 
      RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleHiddenFreeEdgeFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"possibleEdgeFolds", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"hiddenFreeEdgeFoldQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hiddenFreeEdgeFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"possibleHiddenFreeEdgeFolds", "[", "squareComplex", "]"}], "]"}],
    "==", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldHiddenEdgesFreely", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"edgeFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleHiddenFreeEdgeFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[209]:=",ExpressionUUID->"b2419dd8-19c4-4a9f-8991-050582a7f964"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Folding squares", "Section",
 CellChangeTimes->{{3.8191273315524592`*^9, 
  3.819127334579099*^9}},ExpressionUUID->"c311c0f9-8781-428d-82de-\
250d34f4c112"],

Cell[CellGroupData[{

Cell["Possible square folds", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.8193025707315454`*^9, 
  3.819302571469988*^9}},ExpressionUUID->"7a2af6b3-6c2e-4d89-b78d-\
eca82aa1218f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_", ",", "type_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"incidentSquares", "[", 
       RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"squareType", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "\[Equal]", "type"}], 
       "&"}]}], "]"}], "]"}], "\[GreaterEqual]", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", "e1_String"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"squareFoldPossibleQ", "[", 
         RowBox[{"squareComplex", ",", "e1", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"incidentSquareTypes", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFoldPossibleQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"squareType", "[", 
     RowBox[{"squareComplex", ",", "s1"}], "]"}], "\[Equal]", 
    RowBox[{"squareType", "[", 
     RowBox[{"squareComplex", ",", "s2"}], "]"}]}], "&&", 
   RowBox[{"IntersectingQ", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", "s1", "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", "s2", "]"}], "]"}]}], "]"}], "&&", 
   RowBox[{"Not", "[", 
    RowBox[{"s1", "\[Equal]", "s2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"squareFoldPossibleQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Values", "[", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}], "]"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareFolds", "[", 
   RowBox[{"squareComplex_", ",", "e1_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"incidentSquares", "[", 
         RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"squareType", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "\[Equal]", "type"}], 
         "&"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareFolds", "[", 
   RowBox[{"squareComplex_", ",", "e1_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"Join", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"possibleSquareFolds", "[", 
         RowBox[{"squareComplex", ",", "e1", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"incidentSquareTypes", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Fold", "[", 
    RowBox[{"Join", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"possibleSquareFolds", "[", 
          RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Keys", "[", 
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819303119713069*^9, 3.8193031402278194`*^9}, {
   3.819303174808925*^9, 3.819303243059331*^9}, {3.8193042886593885`*^9, 
   3.81930429915234*^9}, {3.81930492421572*^9, 3.819304926515524*^9}, {
   3.8193049950304117`*^9, 3.8193049960079336`*^9}, 3.8193050997900443`*^9, {
   3.819305146268445*^9, 3.819305151611477*^9}, {3.8193107398976336`*^9, 
   3.8193107423859606`*^9}, {3.819311084714818*^9, 3.819311111274585*^9}, {
   3.8193111551800985`*^9, 3.819311319074025*^9}, {3.8193113739801006`*^9, 
   3.819311377298319*^9}, {3.8193592113461094`*^9, 3.819359219218278*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"26acd47b-e21e-4a12-b52e-4da7c435333a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Folding squares", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.8193025766705756`*^9, 
  3.8193025795837307`*^9}},ExpressionUUID->"c74f53f9-4fad-4c4d-8ee3-\
f4c334b02613"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareEdgeIdentifications", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "initialEdgeMatch", ",", "initialEdge1", ",", "secondEdge1", ",", 
      "terminalVertexOfInitialEdge1", ",", "secondEdge2", ",", "increment"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"initialEdgeMatch", "=", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "s1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "==", 
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "s2", "]"}], "]"}], "[", 
            RowBox[{"[", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}]}], "&"}], ",",
          "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"initialEdge1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "s1", "]"}], "]"}], "[", 
       RowBox[{"[", " ", 
        RowBox[{"initialEdgeMatch", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"secondEdge1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"squareComplex", "[", 
         RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", "s1", "]"}], "]"}], "[", 
       RowBox[{"[", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"initialEdgeMatch", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", "4", ",", "1"}], 
         "]"}], " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"terminalVertexOfInitialEdge1", "=", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "initialEdge1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"edgeVertices", "[", 
             RowBox[{"squareComplex", ",", "secondEdge1"}], "]"}], ",", "#"}],
            "]"}], "&"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"secondEdge2", "=", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"squareComplex", "[", 
             RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "s2", "]"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"initialEdgeMatch", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialEdgeMatch", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "2"}], ",", "4", ",",
                   "1"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"edgeVertices", "[", 
             RowBox[{"squareComplex", ",", "#"}], "]"}], ",", 
            "terminalVertexOfInitialEdge1"}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"increment", "=", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"secondEdge2", "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
             RowBox[{"[", "s2", "]"}], "]"}], "[", 
            RowBox[{"[", " ", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialEdgeMatch", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", "#"}], ",", "4", ",", 
               "1"}], "]"}], " ", "]"}], "]"}]}], "&"}]}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", "s1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"initialEdgeMatch", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "j"}], ",", "4", ",", 
             "1"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"squareComplex", "[", 
            RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", "s2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"initialEdgeMatch", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", 
              RowBox[{"j", " ", "increment"}]}], ",", "4", ",", "1"}], "]"}], 
           "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFold", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<vertices\>\"", "\[Rule]", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<edges\>\"", "\[Rule]", 
      RowBox[{"squareComplex", "[", 
       RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<squares\>\"", "\[Rule]", 
      RowBox[{"Association", "[", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s2", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"squareComplex", "[", 
             RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", "s2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}], "/;", 
   RowBox[{"boundaryEqualQ", "[", 
    RowBox[{"squareComplex", ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareFold", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"squareFold", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"edgeFold", "[", "\[IndentingNewLine]", 
     RowBox[{"squareComplex", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"squareEdgeIdentifications", "[", 
          RowBox[{"squareComplex", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", "1"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldSquares", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleSquareFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819302616729787*^9, 3.8193026168774524`*^9}, {
  3.8199105419936156`*^9, 3.8199106061969833`*^9}, {3.819910647501193*^9, 
  3.8199106765572815`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"d73dc117-b7f3-428a-aa3a-a42c242d59fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Freely folding squares", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.819302582429187*^9, 
  3.8193025886655855`*^9}},ExpressionUUID->"5a27cb82-7d9b-4e98-bfcb-\
8344fa6dc03d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"freeSquareFoldQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"commonEdges", ",", "commonEdgeLabels"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"commonEdges", "=", 
      RowBox[{"Intersection", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "s1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"squareComplex", "[", 
          RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", "s2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"commonEdgeLabels", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeLabel", "[", 
          RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
        "commonEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "commonEdges", "]"}], "\[Equal]", "1"}], "||", 
      RowBox[{
       RowBox[{"Length", "[", "commonEdgeLabels", "]"}], "\[Equal]", 
       "2"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleFreeSquareFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"possibleSquareFolds", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"freeSquareFoldQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeSquareFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"possibleFreeSquareFolds", "[", "squareComplex", "]"}], "]"}], 
   "\[GreaterEqual]", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldSquaresFreely", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleFreeSquareFolds", "[", "squareComplex", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8191275947420807`*^9, 3.819127629286029*^9}, {
   3.8191317459695063`*^9, 3.8191317462923737`*^9}, {3.8191318273824387`*^9, 
   3.8191321170615883`*^9}, {3.819194981776174*^9, 3.8191951467495165`*^9}, {
   3.819195203311054*^9, 3.8191952588862524`*^9}, {3.81919530302011*^9, 
   3.8191953428965874`*^9}, {3.81919540698688*^9, 3.8191954219961905`*^9}, {
   3.8191954689091473`*^9, 3.8191954713957014`*^9}, {3.819195527880828*^9, 
   3.819195533850552*^9}, {3.8191955709637423`*^9, 3.8191956102425337`*^9}, {
   3.8191958287420073`*^9, 3.819195928790473*^9}, {3.819196158497416*^9, 
   3.819196384958208*^9}, 3.8191991814479895`*^9, {3.819199276565213*^9, 
   3.819199322799386*^9}, {3.8192000308085704`*^9, 3.819200097405644*^9}, {
   3.819200131447035*^9, 3.81920019085448*^9}, {3.819200292533926*^9, 
   3.8192003466636677`*^9}, {3.8192004427097397`*^9, 
   3.8192006109898453`*^9}, {3.8192006751585226`*^9, 
   3.8192006762297983`*^9}, {3.819200711297804*^9, 3.8192008886002054`*^9}, {
   3.819200999390422*^9, 3.819201039997764*^9}, {3.819201079279224*^9, 
   3.819201190016814*^9}, {3.8192012284561305`*^9, 3.8192012598141117`*^9}, {
   3.8192013198069053`*^9, 3.8192013235102262`*^9}, {3.819201368604065*^9, 
   3.8192013851877537`*^9}, {3.819201775808587*^9, 3.819201795632142*^9}, {
   3.8192020913416877`*^9, 3.8192021265562387`*^9}, {3.8192022739817333`*^9, 
   3.8192022960705276`*^9}, {3.8192023612612586`*^9, 
   3.8192023643826036`*^9}, {3.819202449131841*^9, 3.819202512560042*^9}, {
   3.819202547927581*^9, 3.819202559110329*^9}, {3.8192026050470824`*^9, 
   3.8192026053729963`*^9}, {3.819202668567755*^9, 3.8192029987225304`*^9}, {
   3.8192031733495836`*^9, 3.819203181198032*^9}, {3.81920321376366*^9, 
   3.8192032196432166`*^9}, {3.8192034822317863`*^9, 3.819203493015174*^9}, {
   3.819204368628853*^9, 3.81920441302586*^9}, {3.819204746725391*^9, 
   3.819204786798182*^9}, {3.8192052951698604`*^9, 3.819205331919544*^9}, {
   3.819206071538652*^9, 3.8192061139121013`*^9}, {3.819206206956953*^9, 
   3.819206311105813*^9}, {3.8192063515066466`*^9, 3.8192063782989273`*^9}, {
   3.8192064252887487`*^9, 3.8192065519420905`*^9}, 3.819206612351675*^9, {
   3.8192066705555916`*^9, 3.8192067782217674`*^9}, {3.819208824763994*^9, 
   3.8192088277750473`*^9}, {3.8192088705552597`*^9, 3.819208890820969*^9}, {
   3.8192089315229616`*^9, 3.819209009856961*^9}, {3.8192090622099295`*^9, 
   3.8192091893865356`*^9}, {3.8192092641792593`*^9, 3.819209294045014*^9}, {
   3.819209960256234*^9, 3.819209964784654*^9}, {3.8192101852095213`*^9, 
   3.8192102131856046`*^9}, {3.8192208774897594`*^9, 3.819220901377977*^9}, {
   3.8192209780914507`*^9, 3.819221145609371*^9}, {3.819221360129485*^9, 
   3.8192214952812834`*^9}, {3.819221578951722*^9, 3.819221598170733*^9}, {
   3.819221686273339*^9, 3.8192216917826223`*^9}, {3.819221826167961*^9, 
   3.819221910254657*^9}, {3.8192219631053524`*^9, 3.8192219899028788`*^9}, {
   3.8192232271330724`*^9, 3.8192233234009075`*^9}, {3.8192253580392013`*^9, 
   3.8192253662545543`*^9}, {3.8192726143918424`*^9, 3.819272724082923*^9}, {
   3.819272788802251*^9, 3.819272859897607*^9}, {3.8192977394906354`*^9, 
   3.8192978624198*^9}, {3.819297895562493*^9, 3.8192979081772575`*^9}, {
   3.8192979397172775`*^9, 3.8192980115203247`*^9}, {3.819298043184244*^9, 
   3.8192984198599253`*^9}, 3.8193025557100997`*^9, {3.819302597051129*^9, 
   3.819302621841175*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"dd68c38e-2dd5-4bbc-a4da-8f4331301df9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Folding non closing squares", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.819302582429187*^9, 3.8193025886655855`*^9}, {3.8199006578246355`*^9, 
  3.8199006793626857`*^9}},ExpressionUUID->"853dfae3-d175-496b-85c2-\
93f7cc289f86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonClosingSquareFoldQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"graphQ", "[", 
   RowBox[{"fullSquareDeformationRetraction", "[", 
    RowBox[{"squareFold", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleNonClosingSquareFolds", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"possibleSquareFolds", "[", "squareComplex", "]"}], ",", 
    RowBox[{
     RowBox[{"nonClosingSquareFoldQ", "[", 
      RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingSquareFoldPossibleQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"possibleNonClosingSquareFolds", "[", "squareComplex", "]"}], 
    "]"}], "\[GreaterEqual]", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldNonClosingSquares", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareFold", "[", " ", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleNonClosingSquareFolds", "[", "squareComplex", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8191275947420807`*^9, 3.819127629286029*^9}, {
   3.8191317459695063`*^9, 3.8191317462923737`*^9}, {3.8191318273824387`*^9, 
   3.8191321170615883`*^9}, {3.819194981776174*^9, 3.8191951467495165`*^9}, {
   3.819195203311054*^9, 3.8191952588862524`*^9}, {3.81919530302011*^9, 
   3.8191953428965874`*^9}, {3.81919540698688*^9, 3.8191954219961905`*^9}, {
   3.8191954689091473`*^9, 3.8191954713957014`*^9}, {3.819195527880828*^9, 
   3.819195533850552*^9}, {3.8191955709637423`*^9, 3.8191956102425337`*^9}, {
   3.8191958287420073`*^9, 3.819195928790473*^9}, {3.819196158497416*^9, 
   3.819196384958208*^9}, 3.8191991814479895`*^9, {3.819199276565213*^9, 
   3.819199322799386*^9}, {3.8192000308085704`*^9, 3.819200097405644*^9}, {
   3.819200131447035*^9, 3.81920019085448*^9}, {3.819200292533926*^9, 
   3.8192003466636677`*^9}, {3.8192004427097397`*^9, 
   3.8192006109898453`*^9}, {3.8192006751585226`*^9, 
   3.8192006762297983`*^9}, {3.819200711297804*^9, 3.8192008886002054`*^9}, {
   3.819200999390422*^9, 3.819201039997764*^9}, {3.819201079279224*^9, 
   3.819201190016814*^9}, {3.8192012284561305`*^9, 3.8192012598141117`*^9}, {
   3.8192013198069053`*^9, 3.8192013235102262`*^9}, {3.819201368604065*^9, 
   3.8192013851877537`*^9}, {3.819201775808587*^9, 3.819201795632142*^9}, {
   3.8192020913416877`*^9, 3.8192021265562387`*^9}, {3.8192022739817333`*^9, 
   3.8192022960705276`*^9}, {3.8192023612612586`*^9, 
   3.8192023643826036`*^9}, {3.819202449131841*^9, 3.819202512560042*^9}, {
   3.819202547927581*^9, 3.819202559110329*^9}, {3.8192026050470824`*^9, 
   3.8192026053729963`*^9}, {3.819202668567755*^9, 3.8192029987225304`*^9}, {
   3.8192031733495836`*^9, 3.819203181198032*^9}, {3.81920321376366*^9, 
   3.8192032196432166`*^9}, {3.8192034822317863`*^9, 3.819203493015174*^9}, {
   3.819204368628853*^9, 3.81920441302586*^9}, {3.819204746725391*^9, 
   3.819204786798182*^9}, {3.8192052951698604`*^9, 3.819205331919544*^9}, {
   3.819206071538652*^9, 3.8192061139121013`*^9}, {3.819206206956953*^9, 
   3.819206311105813*^9}, {3.8192063515066466`*^9, 3.8192063782989273`*^9}, {
   3.8192064252887487`*^9, 3.8192065519420905`*^9}, 3.819206612351675*^9, {
   3.8192066705555916`*^9, 3.8192067782217674`*^9}, {3.819208824763994*^9, 
   3.8192088277750473`*^9}, {3.8192088705552597`*^9, 3.819208890820969*^9}, {
   3.8192089315229616`*^9, 3.819209009856961*^9}, {3.8192090622099295`*^9, 
   3.8192091893865356`*^9}, {3.8192092641792593`*^9, 3.819209294045014*^9}, {
   3.819209960256234*^9, 3.819209964784654*^9}, {3.8192101852095213`*^9, 
   3.8192102131856046`*^9}, {3.8192208774897594`*^9, 3.819220901377977*^9}, {
   3.8192209780914507`*^9, 3.819221145609371*^9}, {3.819221360129485*^9, 
   3.8192214952812834`*^9}, {3.819221578951722*^9, 3.819221598170733*^9}, {
   3.819221686273339*^9, 3.8192216917826223`*^9}, {3.819221826167961*^9, 
   3.819221910254657*^9}, {3.8192219631053524`*^9, 3.8192219899028788`*^9}, {
   3.8192232271330724`*^9, 3.8192233234009075`*^9}, {3.8192253580392013`*^9, 
   3.8192253662545543`*^9}, {3.8192726143918424`*^9, 3.819272724082923*^9}, {
   3.819272788802251*^9, 3.819272859897607*^9}, {3.8192977394906354`*^9, 
   3.8192978624198*^9}, {3.819297895562493*^9, 3.8192979081772575`*^9}, {
   3.8192979397172775`*^9, 3.8192980115203247`*^9}, {3.819298043184244*^9, 
   3.8192984198599253`*^9}, 3.8193025557100997`*^9, {3.819302597051129*^9, 
   3.819302621841175*^9}, {3.819900687062208*^9, 3.819900691028022*^9}, {
   3.8199007254630237`*^9, 3.819900836403576*^9}, {3.8199008664765873`*^9, 
   3.81990091851289*^9}, {3.819909527771126*^9, 3.8199095358104887`*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"d16b62b2-d702-4a9a-85e7-176a03a6ae85"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Attaching squares", "Section",
 CellChangeTimes->{{3.819209422356073*^9, 
  3.8192094265530643`*^9}},ExpressionUUID->"da3af8ef-56f3-4acd-a270-\
72d049030925"],

Cell[CellGroupData[{

Cell["Possible square attachments", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.819302582429187*^9, 3.8193025886655855`*^9}, {3.8193026800805273`*^9, 
  3.819302684875532*^9}},ExpressionUUID->"7505930b-0bec-44f3-b4a3-\
da498011abc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squarePresentQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e1_"}], "}"}]}], "]"}], ":=", 
  "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squarePresentQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Not", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Select", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Keys", "[", " ", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fold", "[", "\[IndentingNewLine]", 
        RowBox[{"Or", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"SubsetQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "&"}], "/@", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"squareComplex", "[", 
                 RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"squareComplex", "[", 
                 RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", 
               RowBox[{"[", " ", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "4", ",", "1"}], "]"}], " ", 
                "]"}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       "&"}]}], "\[IndentingNewLine]", "]"}], "\[Equal]", 
    RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"e1", "\[Equal]", "e2"}], "||", 
    RowBox[{"squarePresentQ", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "||", 
    RowBox[{"disjointEdgesQ", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", 
     RowBox[{"[", " ", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"edgeLabel", "[", 
        RowBox[{"squareComplex", ",", "e1"}], "]"}], "]"}], " ", "]"}], "]"}],
     "[", 
    RowBox[{"[", " ", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"edgeLabel", "[", 
       RowBox[{"squareComplex", ",", "e2"}], "]"}], "]"}], " ", "]"}], "]"}], 
   "\[Equal]", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_", ",", "v1_String"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Fold", "[", 
    RowBox[{"Or", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"squareAttachmentPossibleQ", "[", 
        RowBox[{"M", ",", "squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"incidentEdges", "[", 
         RowBox[{"squareComplex", ",", "v1"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentEdges", "[", 
      RowBox[{"squareComplex", ",", "v1"}], "]"}], "]"}], "\[GreaterEqual]", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_", ",", "v1_String"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"incidentEdges", "[", 
      RowBox[{"squareComplex", ",", "v1"}], "]"}], "]"}], "<", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"squareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", " ", 
   RowBox[{"Or", ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"squareAttachmentPossibleQ", "[", 
         RowBox[{"M", ",", "squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareAttachments", "[", 
   RowBox[{"M_", ",", "squareComplex_", ",", "v1_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"incidentEdges", "[", 
       RowBox[{"squareComplex", ",", "v1"}], "]"}], ",", "2"}], "]"}], ",", 
    RowBox[{
     RowBox[{"squareAttachmentPossibleQ", "[", 
      RowBox[{"M", ",", "squareComplex", ",", "#"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleSquareAttachments", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"Fold", "[", " ", 
   RowBox[{"Join", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"possibleSquareAttachments", "[", 
       RowBox[{"M", ",", "squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"squareComplex", "[", 
      RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}]}]}], " ", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81952829865234*^9, 3.8195283394240713`*^9}, {
  3.819528460004959*^9, 3.8195284767636185`*^9}, {3.8196490107848177`*^9, 
  3.8196490610321894`*^9}, {3.8196492530504274`*^9, 3.81964925509875*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"f462131b-5960-465b-a915-78e679c2b68f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Attaching squares", "Subsection",
 CellChangeTimes->{{3.819302334355644*^9, 3.8193023376798086`*^9}, {
  3.819302582429187*^9, 3.8193025886655855`*^9}, {3.819302687410582*^9, 
  3.8193026909845896`*^9}},ExpressionUUID->"d60681cd-4464-4214-b894-\
74a2cc519ffd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareAttachment", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v0", ",", "v1", ",", "v2", ",", "vKey", ",", "eKeys", ",", "sKey"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v0", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"edgeVertices", "[", 
            RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v0", "==", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v0", "==", 
         RowBox[{
          RowBox[{"edgeVertices", "[", 
           RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"edgeVertices", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vKey", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<v\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"maxVertexIndex", "[", "squareComplex", "]"}], "+", 
              "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", "#"}], 
            "]"}], "]"}], "&"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eKeys", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\"\<e\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"maxEdgeIndex", "[", "squareComplex", "]"}], "+", 
             "2"}]}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", " ", 
             RowBox[{"squareComplex", "[", 
              RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], " ", "]"}], ",", 
            "#"}], "]"}], "]"}], "&"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sKey", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<s\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"maxSquareIndex", "[", "squareComplex", "]"}], "+", 
              "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", " ", 
              RowBox[{"squareComplex", "[", 
               RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], " ", "]"}], ",", 
             "#"}], "]"}], "]"}], "&"}], ",", "1"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<vertices\>\"", "\[Rule]", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], ",", "vKey"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<edges\>\"", "\[Rule]", 
        RowBox[{"Append", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<edges\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"eKeys", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"v1", ",", "vKey"}], "}"}], ",", 
               RowBox[{"edgeLabel", "[", 
                RowBox[{"squareComplex", ",", "e2"}], "]"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eKeys", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"v2", ",", "vKey"}], "}"}], ",", 
               RowBox[{"edgeLabel", "[", 
                RowBox[{"squareComplex", ",", "e1"}], "]"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<squares\>\"", "\[Rule]", 
        RowBox[{"Append", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"squareComplex", "[", 
           RowBox[{"[", "\"\<squares\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"sKey", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"e1", ",", 
             RowBox[{"eKeys", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"eKeys", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "e2"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "|>"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attachSquare", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"squareAttachment", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819212150827795*^9, 3.819212181127539*^9}, {
   3.81921239564245*^9, 3.8192125343441415`*^9}, {3.8192126101797132`*^9, 
   3.819212664759776*^9}, {3.8192126964715815`*^9, 3.819212697433008*^9}, 
   3.8192127279911547`*^9, {3.819212772141003*^9, 3.819212993523924*^9}, {
   3.8192130264842043`*^9, 3.8192130270015774`*^9}, {3.8192132189977107`*^9, 
   3.819213250094892*^9}, {3.819213283974641*^9, 3.8192133787148695`*^9}, {
   3.819213428284058*^9, 3.819213477375565*^9}, {3.8192136658962126`*^9, 
   3.819213672954961*^9}, {3.819215744211805*^9, 3.819215763830526*^9}, {
   3.81921585019762*^9, 3.8192159019873886`*^9}, {3.819216082753094*^9, 
   3.8192161082038307`*^9}, {3.819216203559873*^9, 3.819216267422613*^9}, {
   3.819216307257501*^9, 3.819216367530059*^9}, {3.8192164547743893`*^9, 
   3.819216683771037*^9}, {3.8192167517519426`*^9, 3.819217006551363*^9}, {
   3.819217036926794*^9, 3.819217150933801*^9}, {3.819217275297654*^9, 
   3.819217351523409*^9}, {3.819217646784673*^9, 3.8192177491853704`*^9}, {
   3.819217782415413*^9, 3.819217949770153*^9}, {3.8192180160578732`*^9, 
   3.819218178699849*^9}, {3.8192182817462163`*^9, 3.8192182834574423`*^9}, {
   3.819219005641763*^9, 3.81921901166654*^9}, {3.8192203100927286`*^9, 
   3.819220380377389*^9}, {3.819222060535226*^9, 3.81922236736814*^9}, {
   3.8192254650103464`*^9, 3.8192254668896804`*^9}, {3.819273248107027*^9, 
   3.8192733641985583`*^9}, 3.819291052620369*^9, {3.8193026994855113`*^9, 
   3.819302701690801*^9}, {3.8195283446940265`*^9, 3.8195283524428186`*^9}, {
   3.819528575033725*^9, 3.819528600735467*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"7e695e15-a3b0-414c-b804-522814a1b8da"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Folding sequences and completions", "Section",
 CellChangeTimes->{{3.819223570818925*^9, 
  3.819223592704985*^9}},ExpressionUUID->"d4b86cca-51db-4d6a-9208-\
18a9443802fb"],

Cell[CellGroupData[{

Cell["Standard completions", "Subsection",
 CellChangeTimes->{{3.819900512396163*^9, 
  3.8199005202557917`*^9}},ExpressionUUID->"8f993ae6-4b92-4663-9350-\
8bee2f66f611"],

Cell[CellGroupData[{

Cell["Folding", "Subsubsection",
 CellChangeTimes->{{3.8193027973022423`*^9, 
  3.8193027984333925`*^9}},ExpressionUUID->"7eb6f85c-14e5-4d41-afc9-\
16ad47a958b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"foldOnlyEdges", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"Not", "[", " ", 
    RowBox[{"edgeFoldPossibleQ", "[", "squareComplex", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldOnlyEdges", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"foldOnlyEdges", "[", 
   RowBox[{"foldEdges", "[", "squareComplex", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"foldedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Not", "[", " ", 
   RowBox[{
    RowBox[{"edgeFoldPossibleQ", "[", "squareComplex", "]"}], "||", 
    RowBox[{"squareFoldPossibleQ", "[", "squareComplex", "]"}]}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"foldedQ", "[", "squareComplex", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "edgeFoldCount"}], ";", 
      RowBox[{"fold", "[", " ", 
       RowBox[{"foldEdges", "[", "squareComplex", "]"}], " ", "]"}]}]}], 
    "]"}], "/;", 
   RowBox[{
   "edgeFoldPossibleQ", "[", "squareComplex", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"++", "squareFoldCount"}], ";", 
     RowBox[{
      RowBox[{"fold", "[", 
       RowBox[{"foldSquares", "[", "squareComplex", "]"}], " ", "]"}], "/;", 
      RowBox[{"squareFoldPossibleQ", "[", "squareComplex", "]"}]}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819303788132002*^9, 3.8193037933867655`*^9}, {
  3.8193101609947414`*^9, 3.8193102441370153`*^9}, {3.8200851174457603`*^9, 
  3.8200851340702105`*^9}, {3.8200852199612827`*^9, 3.8200852521275177`*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"617c2098-1a06-4f6e-8707-365d4fb3c49e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Completion", "Subsubsection",
 CellChangeTimes->{{3.819302802981535*^9, 
  3.819302804964802*^9}},ExpressionUUID->"e280c4b1-70a0-4ae2-afa0-\
47e6dcb7fe1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"completion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{
    RowBox[{"foldedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{"Not", "[", " ", 
     RowBox[{"squareAttachmentPossibleQ", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], " ", 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"completion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Calculation terminated at 100 squares\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "squareComplex"}]}], "\[IndentingNewLine]", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"foldedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{
     RowBox[{
      RowBox[{"cubeCount", "[", "squareComplex", "]"}], "[", 
      RowBox[{"[", "\"\<squareCount\>\"", "]"}], "]"}], "\[GreaterEqual]", 
     "100"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"completion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"completion", "[", " ", 
    RowBox[{"M", ",", 
     RowBox[{"fold", "[", "squareComplex", "]"}]}], " ", "]"}], "/;", 
   RowBox[{"Not", "[", " ", 
    RowBox[{"foldedQ", "[", "squareComplex", "]"}], " ", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"completion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"++", "squareAttachCount"}], ";", 
     RowBox[{"completion", "[", " ", 
      RowBox[{"M", ",", 
       RowBox[{"attachSquare", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}]}], " ", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"completion", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"completion", "[", 
    RowBox[{"M", ",", "wList"}], "]"}], "=", 
   RowBox[{"completion", "[", 
    RowBox[{"M", ",", 
     RowBox[{"setToRose", "[", "wList", "]"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819807968413043*^9, 3.8198079785476327`*^9}, {
  3.8200851657315855`*^9, 3.8200852139411635`*^9}, {3.822208194523961*^9, 
  3.8222082013686295`*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"42c3278b-4036-4155-9d9b-37a0eed818f2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Free completions", "Subsection",
 CellChangeTimes->{{3.819900526837986*^9, 
  3.8199005303112125`*^9}},ExpressionUUID->"708fc183-6061-4341-baa4-\
5046ca4d7f90"],

Cell[CellGroupData[{

Cell["Freely folding", "Subsubsection",
 CellChangeTimes->{{3.8193028095704627`*^9, 
  3.819302812441536*^9}},ExpressionUUID->"d0e26681-e604-472f-8e8b-\
4fba00cc08ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"freelyFoldedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], "||", 
     RowBox[{"freeSquareFoldPossibleQ", "[", "squareComplex", "]"}]}], ",", 
    "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
    RowBox[{"Not", "[", 
     RowBox[{"hiddenFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{
   "freelyFoldedQ", "[", "squareComplex", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "edgeFoldCount"}], ";", 
      RowBox[{"freelyFold", "[", " ", 
       RowBox[{"foldObviousEdgesFreely", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
   "obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "squareFoldCount"}], ";", 
      RowBox[{"freelyFold", "[", " ", 
       RowBox[{"foldSquaresFreely", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], " ", "/;", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], 
     "]"}], "&&", 
    RowBox[{
    "freeSquareFoldPossibleQ", "[", "squareComplex", 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freelyFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "edgeFoldCount"}], ";", 
      RowBox[{"freelyFold", "[", " ", 
       RowBox[{"foldHiddenEdgesFreely", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], " ", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], "||", 
     RowBox[{"freeSquareFoldPossibleQ", "[", "squareComplex", "]"}]}], 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193028715933104`*^9, 3.819302872878809*^9}, {
  3.8196446607191067`*^9, 3.819644661587352*^9}, {3.8196447057124205`*^9, 
  3.8196447740880175`*^9}, {3.819644863930002*^9, 3.819644956899314*^9}, {
  3.820085803853938*^9, 3.820085850273932*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"58b89735-d7d9-4bad-863f-331674cb27e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Free completion", "Subsubsection",
 CellChangeTimes->{{3.8193028143663344`*^9, 
  3.8193028205682487`*^9}},ExpressionUUID->"ab2b6aef-cf4a-4991-9166-\
7f5899f133d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareAttachmentADoublingQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newSquareType", ",", "adjacentSquareTypes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newSquareType", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeLabel", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adjacentSquareTypes", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"incidentSquareTypes", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", 
         RowBox[{"incidentSquareTypes", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"adjacentSquareTypes", ",", "newSquareType"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Not", "[", " ", 
    RowBox[{"Fold", "[", 
     RowBox[{"And", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"squareAttachmentADoublingQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"possibleSquareAttachments", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}]}]}], " ", "]"}], " ", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[GreaterEqual]", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Not", "[", " ", 
    RowBox[{"squareAttachmentADoublingQ", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{
       RowBox[{"possibleSquareAttachments", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "  ", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleNonDoublingSquareAttachment", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", " ", 
       RowBox[{"squareAttachmentADoublingQ", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], " ", "]"}], "&"}], ",", 
     "1"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attachNonDoublingSquare", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"squareAttachment", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"possibleNonDoublingSquareAttachment", "[", 
     RowBox[{"M", ",", "squareComplex"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{
    RowBox[{"freelyFoldedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{"Not", "[", " ", 
     RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], " ", 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Calculation terminated at 100 squares\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "squareComplex"}]}], "\[IndentingNewLine]", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"freelyFoldedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{
     RowBox[{
      RowBox[{"cubeCount", "[", "squareComplex", "]"}], "[", 
      RowBox[{"[", "\"\<squareCount\>\"", "]"}], "]"}], "\[GreaterEqual]", 
     "100"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"freeCompletion", "[", " ", 
    RowBox[{"M", ",", 
     RowBox[{"freelyFold", "[", "squareComplex", "]"}]}], " ", "]"}], "/;", 
   RowBox[{"Not", "[", " ", 
    RowBox[{"freelyFoldedQ", "[", "squareComplex", "]"}], " ", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"++", "squareAttachCount"}], ";", 
     RowBox[{"freeCompletion", "[", " ", 
      RowBox[{"M", ",", 
       RowBox[{"attachNonDoublingSquare", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}]}], " ", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"freeCompletion", "[", 
     RowBox[{"M", ",", "wList"}], "]"}], "="}], "*)"}], 
  RowBox[{"freeCompletion", "[", 
   RowBox[{"M", ",", 
    RowBox[{"setToRose", "[", "wList", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy1tIk3EABfC5BsJs+jVWSA0hdbi1Ra6XMoY6GubcCGYgrCREp5QIMZhR
KkF5G5vOMd2+oes2UWpNrJS8YW0TVg97iFBUqFnDhxiTaks3Wg/+z/dw+HEO
nNPNd+pb2SwWq4QEPpJOqWlTQvk9pDfA6+/P32a67YMFeqj2vzA/pc/CL9tS
lptYNLPBh+Vn1YXw37XZk9AXqRDBeNGGHJre8i7BgM6pg1zNuQY41DPSBE8E
zAYY1iaMcFcj7IIHZQsPIcWttkC7qsHB/FVpFzxeFZmBLVGBe5aocfx5DQtW
6uzviD8zlAvaCnn3l4nNH+UDcDwZssChSfkwLOb0jUKFP+mEvy5SghWieDcg
hjWN5furRHNVbxby206JA0Rp7dwZuH7Pm4ZPfkfZQeLWIIeCb14KGW8d8dLM
/ukbY+PX+Og28YJhk4Y6gUUk60woIwc3yuCxpr6n80RePMtozY/9WCIudozF
oCRvbWKdeFlS7YGco1eeQUUm+BzmpGTTcLP+8wvojVV27xCj6dJ+aKTVw9Ba
IX8Mb1IdXtiZuzcF/4doP2QnU4xjvrBWcTehfPBKdhUeAok/Kw8=
  "],
 CellLabel->
  "In[259]:=",ExpressionUUID->"165ea959-8127-4b5d-bcd3-7d2662b40ce9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"freeCompletion", "[", 
  RowBox[{"raPentagon", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<525314252\>\"", ",", "\"\<253152315\>\"", ",", "\"\<15234153\>\"", 
     ",", "\"\<452342452\>\"", ",", "\"\<2524153\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8347556638527203`*^9, 3.834755684141922*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"d95ea71f-ab06-4b06-807f-c4a15a5d5f74"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e5\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e6\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"s1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e5\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s10\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e6\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e6\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s13\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e4\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s14\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e4\"\>", ",", "\<\"e6\"\>", ",", "\<\"e4\"\>", 
         ",", "\<\"e6\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s3\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e5\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e5\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347557469113207`*^9},
 CellLabel->
  "Out[369]=",ExpressionUUID->"675a80c8-46a4-4df6-8a81-e4d30ad0f4f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullDeformationRetraction", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.8347558012626667`*^9, 3.8347558071104*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"ad009a87-c747-409b-8649-abf9ccf9e158"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e5\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e6\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"s1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e5\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s10\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e6\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e6\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s13\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e4\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s14\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e4\"\>", ",", "\<\"e6\"\>", ",", "\<\"e4\"\>", 
         ",", "\<\"e6\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s3\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e5\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e5\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347558081550503`*^9},
 CellLabel->
  "Out[370]=",ExpressionUUID->"4ef9842c-3e6e-4f7d-8151-9ec69764cd24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fundamentalGroupPresentation", "[", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"\"\<vertices\>\"", "\[Rule]", 
     RowBox[{"{", "\"\<v0\>\"", "}"}]}], ",", 
    RowBox[{"\"\<edges\>\"", "\[Rule]", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<e1\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<v0\>\"", ",", "\"\<v0\>\""}], "}"}], ",", 
          "\"\<5\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<e2\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<v0\>\"", ",", "\"\<v0\>\""}], "}"}], ",", 
          "\"\<2\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<e4\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<v0\>\"", ",", "\"\<v0\>\""}], "}"}], ",", 
          "\"\<3\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<e5\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<v0\>\"", ",", "\"\<v0\>\""}], "}"}], ",", 
          "\"\<1\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<e6\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<v0\>\"", ",", "\"\<v0\>\""}], "}"}], ",", 
          "\"\<4\>\""}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
    RowBox[{"\"\<squares\>\"", "\[Rule]", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<s1\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<e1\>\"", ",", "\"\<e5\>\"", ",", "\"\<e1\>\"", ",", 
          "\"\<e5\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<s10\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<e1\>\"", ",", "\"\<e6\>\"", ",", "\"\<e1\>\"", ",", 
          "\"\<e6\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<s13\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<e2\>\"", ",", "\"\<e4\>\"", ",", "\"\<e2\>\"", ",", 
          "\"\<e4\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<s14\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<e4\>\"", ",", "\"\<e6\>\"", ",", "\"\<e4\>\"", ",", 
          "\"\<e6\>\""}], "}"}]}], ",", 
       RowBox[{"\"\<s3\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<e2\>\"", ",", "\"\<e5\>\"", ",", "\"\<e2\>\"", ",", 
          "\"\<e5\>\""}], "}"}]}]}], "\[RightAssociation]"}]}]}], 
   "\[RightAssociation]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8347559486793413`*^9, 3.834755956892003*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"ad18bcf9-73bb-47fe-98b9-d964b96d44d3"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"generators\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"a\"\>", ",", "\<\"b\"\>", ",", "\<\"c\"\>", 
      ",", "\<\"d\"\>", ",", "\<\"e\"\>"}], "}"}]}], ",", 
   RowBox[{"\<\"relations\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"adAD\"\>", ",", "\<\"aeAE\"\>", ",", "\<\"bcBC\"\>", 
      ",", "\<\"bdBD\"\>", ",", "\<\"ceCE\"\>"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347559577925515`*^9},
 CellLabel->
  "Out[373]=",ExpressionUUID->"ed1a4931-bbc4-4fc5-b881-0788a59712a8"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Non closing completions", "Subsection",
 CellChangeTimes->{{3.81990054040495*^9, 
  3.8199005483893948`*^9}},ExpressionUUID->"0f648d22-4483-45d8-aa7f-\
1032e936ec07"],

Cell[CellGroupData[{

Cell["Non closing folding", "Subsubsection",
 CellChangeTimes->{{3.8199005671828947`*^9, 
  3.819900572281684*^9}},ExpressionUUID->"a60a9a21-2864-4c11-85ed-\
f644a8fd4c49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonClosingFoldedQ", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], "||", 
     RowBox[{"nonClosingSquareFoldPossibleQ", "[", "squareComplex", "]"}]}], 
    ",", "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
    RowBox[{"Not", "[", 
     RowBox[{"nonClosingEdgeFoldPossibleQ", "[", "squareComplex", "]"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{
   "nonClosingFoldedQ", "[", "squareComplex", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "edgeFoldCount"}], ";", 
      RowBox[{"nonClosingFold", "[", " ", 
       RowBox[{"foldObviousEdgesFreely", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], "/;", 
   RowBox[{
   "obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "squareFoldCount"}], ";", 
      RowBox[{"nonClosingFold", "[", " ", 
       RowBox[{"foldNonClosingSquares", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], " ", "/;", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], 
     "]"}], "&&", 
    RowBox[{
    "nonClosingSquareFoldPossibleQ", "[", "squareComplex", 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingFold", "[", "squareComplex_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"++", "edgeFoldCount"}], ";", 
      RowBox[{"nonClosingFold", "[", " ", 
       RowBox[{"foldNonClosingEdges", "[", "squareComplex", "]"}], " ", 
       "]"}]}]}], "]"}], " ", "/;", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"obviousFreeEdgeFoldPossibleQ", "[", "squareComplex", "]"}], "||", 
     RowBox[{"nonClosingSquareFoldPossibleQ", "[", "squareComplex", "]"}]}], 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193028715933104`*^9, 3.819302872878809*^9}, {
  3.8196446607191067`*^9, 3.819644661587352*^9}, {3.8196447057124205`*^9, 
  3.8196447740880175`*^9}, {3.819644863930002*^9, 3.819644956899314*^9}, {
  3.819901265421839*^9, 3.819901470866122*^9}, {3.8200858873568172`*^9, 
  3.820085913213215*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"8eaed1a0-b0d3-4625-bc5e-d0642406a51f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Non closing completions", "Subsubsection",
 CellChangeTimes->{{3.819900582923588*^9, 
  3.8199005886273046`*^9}},ExpressionUUID->"20d1fdb6-493a-428f-bf1a-\
206956bb50b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"squareAttachmentADoublingQ", "[", 
   RowBox[{"squareComplex_", ",", 
    RowBox[{"{", 
     RowBox[{"e1_", ",", "e2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newSquareType", ",", "adjacentSquareTypes"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newSquareType", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgeLabel", "[", 
           RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"e1", ",", "e2"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"adjacentSquareTypes", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"incidentSquareTypes", "[", 
          RowBox[{"squareComplex", ",", "e1"}], "]"}], ",", 
         RowBox[{"incidentSquareTypes", "[", 
          RowBox[{"squareComplex", ",", "e2"}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"adjacentSquareTypes", ",", "newSquareType"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Not", "[", " ", 
    RowBox[{"Fold", "[", 
     RowBox[{"And", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"squareAttachmentADoublingQ", "[", 
         RowBox[{"squareComplex", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"possibleSquareAttachments", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}]}]}], " ", "]"}], " ", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[GreaterEqual]", 
    "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Not", "[", " ", 
    RowBox[{"squareAttachmentADoublingQ", "[", 
     RowBox[{"squareComplex", ",", 
      RowBox[{
       RowBox[{"possibleSquareAttachments", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "  ", "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[Equal]", 
    "1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"False", "/;", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], "]"}], "\[Equal]", 
    "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"possibleNonDoublingSquareAttachment", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"possibleSquareAttachments", "[", 
      RowBox[{"M", ",", "squareComplex"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", " ", 
       RowBox[{"squareAttachmentADoublingQ", "[", 
        RowBox[{"squareComplex", ",", "#"}], "]"}], " ", "]"}], "&"}], ",", 
     "1"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"attachNonDoublingSquare", "[", 
   RowBox[{"M_", ",", "squareComplex_"}], "]"}], ":=", 
  RowBox[{"squareAttachment", "[", 
   RowBox[{"squareComplex", ",", 
    RowBox[{"possibleNonDoublingSquareAttachment", "[", 
     RowBox[{"M", ",", "squareComplex"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"squareComplex", "/;", 
   RowBox[{"Or", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"squareComplex", "[", 
        RowBox[{"[", "\"\<vertices\>\"", "]"}], "]"}], "]"}], "\[Equal]", 
      "1"}], ",", 
     RowBox[{
      RowBox[{"nonClosingFoldedQ", "[", "squareComplex", "]"}], "&&", 
      RowBox[{"Not", "[", " ", 
       RowBox[{"nonDoublingSquareAttachmentPossibleQ", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}], " ", "]"}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Calculation terminated at 100 squares\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "squareComplex"}]}], "\[IndentingNewLine]", 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"nonClosingFoldedQ", "[", "squareComplex", "]"}], "&&", 
    RowBox[{
     RowBox[{
      RowBox[{"cubeCount", "[", "squareComplex", "]"}], "[", 
      RowBox[{"[", "\"\<squareCount\>\"", "]"}], "]"}], "\[GreaterEqual]", 
     "100"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"nonClosingCompletion", "[", " ", 
    RowBox[{"M", ",", 
     RowBox[{"nonClosingFold", "[", "squareComplex", "]"}]}], " ", "]"}], "/;", 
   RowBox[{"Not", "[", " ", 
    RowBox[{"nonClosingFoldedQ", "[", "squareComplex", "]"}], " ", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M_", ",", "squareComplex_Association"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"++", "squareAttachCount"}], ";", 
     RowBox[{"nonClosingCompletion", "[", " ", 
      RowBox[{"M", ",", 
       RowBox[{"attachNonDoublingSquare", "[", 
        RowBox[{"M", ",", "squareComplex"}], "]"}]}], " ", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M_", ",", "wList_List"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"freeCompletion", "[", 
     RowBox[{"M", ",", "wList"}], "]"}], "="}], "*)"}], 
  RowBox[{"nonClosingCompletion", "[", 
   RowBox[{"M", ",", 
    RowBox[{"setToRose", "[", "wList", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0W8o43EcB/CZ1RU2v9NIToosc6MzTxwt/KJjpu5Gt8IvaTfXkZJCOE/O
/4ad/Pstx/2ZJneRO+RvmF2de7AHlwjFsDy41oTNmW4e+L5/Dz69er/r/egT
ra0uKOfzeDwJOdgiMyvZWhd9Yi3SweL15AouGzb0cJSqvIYiT5EPbh/IeEZi
1PRuCExKVIbD/4UzEfCbLVUCnVG7clg7K0yDFvWQGgaonmhgT/P7Mhhm6dLB
X/muGnimimyCN3GL7yAVkKmHfdmafm6f7R2GoRm2afjKLjbOEFX9V99h8Gpe
3wLx7y01DA3hwsYVonZL3gFH3FY97BmX98IYQdsAVEy5h+DFU0q8SpSeWaTw
GZP0b43YldHqgyGvH0ktRFnu3GO402Dywo+Xdv4mcb9TQMEfXyM53/ibWK7/
fcTJHDoHDogpuj0WqsV6SUKdi7bdlMTBh2Vtn+aJQqePs1vkOF0mLlUNOmB8
4M8PO8Ss+MxRKAjK+QwVt5tfoJ8nYQLuFfyZhCZH+ttjot0b2w5rWGUv7E6V
j8FSqsoE6x6cm+GdlZ2CfLeHs9JQkuMgGhf8n0Oz6MVLRT35fzOtgUweU8o0
uWgrLdLCe9IAOMI=
  "],
 CellLabel->
  "In[275]:=",ExpressionUUID->"ab4b02b0-6a41-44de-8316-1bf3ff1dbea9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonClosingCompletion", "[", 
  RowBox[{"raPentagon", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<252\>\"", ",", "\"\<5213\>\"", ",", "\"\<413525\>\"", ",", 
     "\"\<4153\>\"", ",", "\"\<45242423\>\""}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8347643479389944`*^9, 3.8347643692510023`*^9}, {
  3.834766072298234*^9, 3.834766103163905*^9}, {3.8347662233041954`*^9, 
  3.8347662542718277`*^9}, {3.8347663056886015`*^9, 3.8347663289872775`*^9}, {
  3.834766480877528*^9, 3.834766508706071*^9}, {3.834766614126177*^9, 
  3.8347666520531197`*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"5aa2eaef-6213-446f-ae10-d147f8d0fcc4"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e6\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e7\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e8\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e9\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e13\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e3\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e15\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"s1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e3\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e7\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e13\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e8\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s3\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e7\"\>", ",", "\<\"e15\"\>", ",", "\<\"e7\"\>", 
         ",", "\<\"e8\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e9\"\>", ",", "\<\"e2\"\>", ",", "\<\"e6\"\>", 
         ",", "\<\"e2\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347643748855457`*^9, 3.834766106361101*^9, 
  3.8347662621127834`*^9, 3.834766333982883*^9, 3.8347665127589464`*^9, 
  3.834766653908064*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"671b6e6e-5a91-45f5-b502-ab8e3475e44d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullDeformationRetraction", "[", "%", "]"}]], "Input",
 CellLabel->
  "In[380]:=",ExpressionUUID->"6e939b0f-c6f8-46ca-9665-9e6e4746c60a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e22\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e23\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e26\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e29\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e31\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347661219105062`*^9, 3.834766269292487*^9, 
  3.8347663368783035`*^9},
 CellLabel->
  "Out[380]=",ExpressionUUID->"fbc3a0f2-d920-4469-84d2-e0e82ede2750"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonClosingCompletion", "[", 
  RowBox[{"raPentagon", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<525314252\>\"", ",", "\"\<253152315\>\"", ",", "\"\<15234153\>\"", 
     ",", "\"\<452342452\>\"", ",", "\"\<2524153\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.834755845736014*^9, 3.8347558574655933`*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"a4fe5d1c-4270-4d16-81a5-fbeb25ff5f06"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e5\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e6\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e12\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e10\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e19\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e20\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e29\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e9\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e16\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e14\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e34\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e36\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e13\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e15\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e27\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"s1\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e10\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e19\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s10\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e6\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e16\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s11\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e27\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e34\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s12\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e5\"\>", ",", "\<\"e1\"\>", 
         ",", "\<\"e36\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s13\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e4\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e20\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s14\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e20\"\>", ",", "\<\"e29\"\>", ",", "\<\"e4\"\>", 
         ",", "\<\"e16\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s3\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e14\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e19\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e12\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e4\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s5\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e4\"\>", ",", "\<\"e34\"\>", ",", "\<\"e4\"\>", 
         ",", "\<\"e6\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s6\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e2\"\>", ",", "\<\"e36\"\>", ",", "\<\"e2\"\>", 
         ",", "\<\"e10\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s7\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e9\"\>", ",", "\<\"e13\"\>", 
         ",", "\<\"e9\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s8\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e1\"\>", ",", "\<\"e14\"\>", ",", "\<\"e15\"\>", 
         ",", "\<\"e14\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"s9\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"e12\"\>", ",", "\<\"e16\"\>", ",", "\<\"e20\"\>", 
         ",", "\<\"e9\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347558700019455`*^9},
 CellLabel->
  "Out[371]=",ExpressionUUID->"f9cc6078-f596-4ff7-b5fa-871c975c9893"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullDeformationRetraction", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.834755921351262*^9, 3.8347559253121758`*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"cb190133-9d7c-4bed-b051-7a3d09cbfa10"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"vertices\"\>", "\[Rule]", 
    RowBox[{"{", "\<\"v0\"\>", "}"}]}], ",", 
   RowBox[{"\<\"edges\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"e2\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"2\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e4\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"3\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e14\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"1\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e15\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"5\"\>"}], "}"}]}], ",", 
      RowBox[{"\<\"e27\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"v0\"\>", ",", "\<\"v0\"\>"}], "}"}], 
         ",", "\<\"4\"\>"}], "}"}]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"squares\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8347559263655963`*^9},
 CellLabel->
  "Out[372]=",ExpressionUUID->"5a3f7f7e-f4fe-4be9-9c8a-e742ce42e8d7"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell["Computations", "Chapter",
 CellChangeTimes->{{3.819896145534825*^9, 
  3.8198961475564127`*^9}},ExpressionUUID->"36c6bb8c-253d-4b9f-8e32-\
d03faf565497"]
}, Open  ]]
},
WindowSize->{682, 820},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 176, 3, 156, "Title",ExpressionUUID->"c0592181-2bc2-40ff-8063-625e90e7c580"],
Cell[759, 27, 458, 8, 100, "Text",ExpressionUUID->"d5c460ef-276d-40cb-a9ff-62fca3d364c1"],
Cell[CellGroupData[{
Cell[1242, 39, 161, 3, 67, "Chapter",ExpressionUUID->"7281204c-ae45-42a7-bd00-203577ee332d"],
Cell[CellGroupData[{
Cell[1428, 46, 427, 6, 34, "Text",ExpressionUUID->"884cfa5a-207c-40f8-b40b-c94e659c4dc8",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1858, 54, 468, 9, 57, "CodeText",ExpressionUUID->"faed99d7-aea1-4436-8b58-aa6a5f3b5ae7",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2329, 65, 308, 6, 34, "Text",ExpressionUUID->"e6e3f7be-cbc4-4376-98f7-cdec57e14145",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2640, 73, 354, 6, 37, "CodeText",ExpressionUUID->"1c96b662-9192-41bc-ac52-2daab7aabc0a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2997, 81, 649, 11, 100, "Text",ExpressionUUID->"67495eec-b796-49b0-b2a1-a4c2bb26c78d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3649, 94, 339, 5, 37, "CodeText",ExpressionUUID->"fb95d1d8-63fb-4f2c-ba24-3e19b309b397",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3991, 101, 1482, 26, 232, "Text",ExpressionUUID->"80dc2ad9-f8fe-4ea7-a036-786059851d1a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[5476, 129, 346, 5, 37, "CodeText",ExpressionUUID->"3b53e2f9-a34b-469d-912e-5dedf4c42674",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[5825, 136, 857, 15, 144, "Text",ExpressionUUID->"f0052d5d-30e1-497c-869b-d12b7bd0dccc",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[6685, 153, 554, 13, 137, "CodeText",ExpressionUUID->"e168f076-4f37-4dab-86a4-b4f113f7bc5d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[7276, 171, 177, 3, 67, "Section",ExpressionUUID->"8b2d407b-3a04-4f1f-8003-07117fe47118"],
Cell[CellGroupData[{
Cell[7478, 178, 173, 3, 53, "Subsection",ExpressionUUID->"fe0d3314-4a93-4ac4-b359-45a83e658208"],
Cell[7654, 183, 2796, 76, 140, "Input",ExpressionUUID->"d6aeecbc-4a98-48f4-b6fd-457c9baafd29",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[10487, 264, 169, 3, 37, "Subsection",ExpressionUUID->"6574bbfb-0047-4614-83fa-2ed1d841659e"],
Cell[10659, 269, 1353, 37, 83, "Input",ExpressionUUID->"2a996f2f-eb5b-4b3b-a680-6275fe592046",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[12049, 311, 163, 3, 37, "Subsection",ExpressionUUID->"d61beb70-b7d8-4f88-8540-dda0af60aadb"],
Cell[12215, 316, 5345, 143, 235, "Input",ExpressionUUID->"c4f0ac6d-3f4e-4803-a598-be760e467173",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[17597, 464, 167, 3, 37, "Subsection",ExpressionUUID->"f6c7a115-f0aa-4a7c-a90a-37b4d78d7d23"],
Cell[17767, 469, 4338, 121, 273, "Input",ExpressionUUID->"2fc0f5af-70c0-4c43-ab81-2f89a72f33ca",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[22142, 595, 180, 3, 37, "Subsection",ExpressionUUID->"72e99d18-8a0f-4f72-a6c2-9f1111113988"],
Cell[22325, 600, 3804, 96, 216, "Input",ExpressionUUID->"0933ed46-6358-4e14-a911-64bd530b8ecd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[26166, 701, 179, 3, 37, "Subsection",ExpressionUUID->"ea20c1da-d6f2-41fd-adec-c378a14c67c2"],
Cell[26348, 706, 17174, 429, 1261, "Input",ExpressionUUID->"df36fa4e-02b5-46b6-b773-5e6b1afdbe45",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[43571, 1141, 172, 3, 53, "Section",ExpressionUUID->"430d001c-0020-42a0-9ca3-8aa91cfeeaa6"],
Cell[43746, 1146, 9440, 191, 653, "Input",ExpressionUUID->"dda4ef83-975a-4c94-850c-2bb7a5d404b1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53223, 1342, 199, 3, 53, "Section",ExpressionUUID->"68c839cc-8cec-41d3-ab85-27575fb53983"],
Cell[CellGroupData[{
Cell[53447, 1349, 234, 4, 53, "Subsection",ExpressionUUID->"30fc5afe-1e3b-402d-b20f-d3e298381c9c"],
Cell[53684, 1355, 4043, 98, 273, "Input",ExpressionUUID->"3a777bcd-eba2-4679-937d-58d9491d6277",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[57764, 1458, 231, 4, 37, "Subsection",ExpressionUUID->"3023db2d-146d-4322-af10-793d021c8715"],
Cell[57998, 1464, 5157, 126, 368, "Input",ExpressionUUID->"c715ca63-8720-40a0-ad87-a2646cd2db05",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63192, 1595, 232, 4, 37, "Subsection",ExpressionUUID->"d29f9d81-b0ab-4c4e-bc82-8c0a035c938e"],
Cell[63427, 1601, 7298, 173, 957, "Input",ExpressionUUID->"3ffd6460-0bb3-4c94-b4a9-5c4bcef55e91",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70762, 1779, 203, 3, 37, "Subsection",ExpressionUUID->"37d1ea17-ebed-4c40-8e0c-edc11e026222"],
Cell[70968, 1784, 2210, 52, 292, "Input",ExpressionUUID->"ebece2f7-5c7a-4dc2-8ebe-4f9d1fc30670",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[73227, 1842, 177, 3, 53, "Section",ExpressionUUID->"5fbda290-5847-4e02-997a-5e0a86ea34bc"],
Cell[CellGroupData[{
Cell[73429, 1849, 165, 3, 53, "Subsection",ExpressionUUID->"9202fadd-112a-4a09-ab2c-16292e3742a1"],
Cell[73597, 1854, 6369, 157, 368, "Input",ExpressionUUID->"c4573fac-19fd-4ed6-a0f7-625f957e1d05",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[80003, 2016, 215, 4, 37, "Subsection",ExpressionUUID->"78e00cfa-51fb-4888-9707-72a5b591940e"],
Cell[80221, 2022, 1361, 34, 121, "Input",ExpressionUUID->"616e1a69-d624-4ad6-a53f-57f1ce994a2f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[81619, 2061, 157, 3, 37, "Subsection",ExpressionUUID->"75ef1c7d-ca9a-4a4d-8e9f-1400bad63b5f"],
Cell[81779, 2066, 5497, 142, 444, "Input",ExpressionUUID->"284136c3-a375-421b-ab58-005a905808a0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[87313, 2213, 168, 3, 37, "Subsection",ExpressionUUID->"428f9184-0b4b-4f15-835d-827d995bfc71"],
Cell[87484, 2218, 9015, 217, 577, "Input",ExpressionUUID->"1b95cab2-4a8c-43fb-9a86-335dde4e8579",
 InitializationCell->True]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[96560, 2442, 229, 4, 56, "Chapter",ExpressionUUID->"ecbd4324-6ed4-4710-9c15-f3e71f502ab0"],
Cell[CellGroupData[{
Cell[96814, 2450, 172, 3, 67, "Section",ExpressionUUID->"cb721450-5317-4952-a0ca-cfb01ffe944e"],
Cell[96989, 2455, 774, 13, 166, "Text",ExpressionUUID->"cf6253f5-f674-4483-afd3-392f6dfcc078"],
Cell[97766, 2470, 470, 8, 37, "CodeText",ExpressionUUID->"2587533a-d0d5-4d73-84ec-4aba3d567f54"],
Cell[CellGroupData[{
Cell[98261, 2482, 187, 3, 53, "Subsection",ExpressionUUID->"b999f5b5-6930-475b-bf7b-3abb948aeef4"],
Cell[98451, 2487, 2178, 40, 83, "Input",ExpressionUUID->"d8c962d1-daba-47b0-9481-e3cd870ae812",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100666, 2532, 178, 3, 37, "Subsection",ExpressionUUID->"7d927834-75f2-46f3-82a3-bc1bd2b9a0d3"],
Cell[100847, 2537, 5991, 156, 425, "Input",ExpressionUUID->"e74bf74f-be66-4243-a06e-ad1234cdce44",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[106887, 2699, 221, 4, 53, "Section",ExpressionUUID->"f05c9f81-f86a-473a-bca6-afd9a1f34c70"],
Cell[CellGroupData[{
Cell[107133, 2707, 183, 3, 53, "Subsection",ExpressionUUID->"e4716def-cbaa-40ff-866f-69090320216d"],
Cell[107319, 2712, 7268, 175, 615, "Input",ExpressionUUID->"d5f97de8-1918-42df-ad64-cfbdadd8bf53",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[114624, 2892, 182, 3, 37, "Subsection",ExpressionUUID->"93a5fc62-fa33-41fb-af3c-8db4ddc51ef4"],
Cell[114809, 2897, 9676, 239, 881, "Input",ExpressionUUID->"7608409c-f05d-424c-8a5e-539d0e5b4208",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[124534, 3142, 198, 3, 53, "Section",ExpressionUUID->"e63f2381-d1bf-40ae-9a4d-f4142182fd17"],
Cell[124735, 3147, 728, 12, 56, "Text",ExpressionUUID->"efc0e57c-2d4c-489b-915a-25e3c0b07b5f"],
Cell[125466, 3161, 852, 18, 117, "CodeText",ExpressionUUID->"8502ef77-14de-4837-91a3-31195f2d2b5d"],
Cell[CellGroupData[{
Cell[126343, 3183, 233, 4, 53, "Subsection",ExpressionUUID->"bf5e2a19-3844-4129-917e-6cf18119f8d1"],
Cell[126579, 3189, 12052, 291, 1166, "Input",ExpressionUUID->"4e0b916c-c110-421e-996e-1a99f13d9068",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[138668, 3485, 163, 3, 37, "Subsection",ExpressionUUID->"46606802-2f0b-4e46-a63b-c82437c9dadd"],
Cell[138834, 3490, 15882, 316, 767, "Input",ExpressionUUID->"10d62165-1f2a-4536-bb66-584c2d77e6cb",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[154765, 3812, 165, 3, 53, "Section",ExpressionUUID->"26473773-1f33-4484-8842-a59f8cd41fc8"],
Cell[CellGroupData[{
Cell[154955, 3819, 184, 3, 53, "Subsection",ExpressionUUID->"318d19db-ee61-4ff3-b111-99026253f553"],
Cell[155142, 3824, 12128, 285, 729, "Input",ExpressionUUID->"6c6b188f-8a6f-40d4-ac52-2ba7ddfa6def",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[167307, 4114, 196, 3, 37, "Subsection",ExpressionUUID->"67734995-3821-45a6-baaf-edfb2e3d1f5e"],
Cell[167506, 4119, 12759, 287, 900, "Input",ExpressionUUID->"7c95077c-7220-4885-8d49-b52275d57cca",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[180302, 4411, 201, 3, 37, "Subsection",ExpressionUUID->"55c4aca5-88f0-4c59-b73e-b8a208ad1c7b"],
Cell[180506, 4416, 7636, 190, 748, "Input",ExpressionUUID->"b5b3eed7-3594-4cad-8ef0-40a9a2c4bb15",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[188179, 4611, 207, 3, 37, "Subsection",ExpressionUUID->"9e7b23f0-4338-4ffd-8936-8b2258cb7458"],
Cell[188389, 4616, 7122, 166, 843, "Input",ExpressionUUID->"2c156775-f606-46b2-bb60-880c58d49626",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[195548, 4787, 217, 4, 37, "Subsection",ExpressionUUID->"263c0915-9351-40f2-a40d-6abb8362db91"],
Cell[195768, 4793, 6879, 169, 577, "Input",ExpressionUUID->"29fa101f-2da6-42dc-aaf5-b551fff4a91b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[202684, 4967, 197, 3, 37, "Subsection",ExpressionUUID->"dd746a5a-dfd0-44e9-9123-6e310187b144"],
Cell[202884, 4972, 668, 16, 67, "Input",ExpressionUUID->"59886657-fa34-4dbf-8cb4-09c2103bd2a8"],
Cell[CellGroupData[{
Cell[203577, 4992, 347, 7, 28, "Input",ExpressionUUID->"8ab3c407-8e4e-4f52-a196-00e933889aa7"],
Cell[203927, 5001, 479, 12, 32, "Output",ExpressionUUID->"8c020f5c-0195-4ba5-904c-92e2b36e3d97"]
}, Open  ]],
Cell[204421, 5016, 529, 13, 28, "Input",ExpressionUUID->"66f634db-4fa5-44cc-bb90-a5e270478e3a"],
Cell[204953, 5031, 423, 8, 28, "Input",ExpressionUUID->"8605c1b7-64bf-48d3-b587-11e56da9282c"],
Cell[CellGroupData[{
Cell[205401, 5043, 228, 4, 28, "Input",ExpressionUUID->"ee60ffb4-08e8-41d5-bfb4-f1d1406913a2"],
Cell[205632, 5049, 968, 18, 52, "Output",ExpressionUUID->"a9e3b0f2-59d4-4044-ae07-2b3131951ca8"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[206673, 5075, 169, 3, 56, "Chapter",ExpressionUUID->"b1f57003-e33d-4e61-866f-19dbcd39548a"],
Cell[CellGroupData[{
Cell[206867, 5082, 159, 3, 67, "Section",ExpressionUUID->"74d67cbe-bc11-4383-a67d-2e99b07ad050"],
Cell[207029, 5087, 357, 7, 78, "Text",ExpressionUUID->"c2e0f75c-933d-4ca1-bc75-f35520c41725"],
Cell[207389, 5096, 1553, 33, 197, "Input",ExpressionUUID->"943cd27e-e6ad-4f19-abe7-7ee4e1fe3042",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[208979, 5134, 162, 3, 53, "Section",ExpressionUUID->"eecf9f17-3391-4b0b-8b9b-8c2e6c37568c"],
Cell[CellGroupData[{
Cell[209166, 5141, 169, 3, 53, "Subsection",ExpressionUUID->"6ecdbb72-578c-4d9d-956f-b810bf6a68c8"],
Cell[209338, 5146, 4935, 131, 254, "Input",ExpressionUUID->"d338cf4e-db08-44a1-a2a5-67adccc4c990",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[214310, 5282, 163, 3, 53, "Subsection",ExpressionUUID->"9b5f6054-d833-4a6f-9648-ea9a16a6c3bc"],
Cell[214476, 5287, 7807, 207, 444, "Input",ExpressionUUID->"e8ec5cf9-6205-495e-b96c-cd53bae590fd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[222320, 5499, 168, 3, 53, "Subsection",ExpressionUUID->"2ef540d1-c524-467f-89a0-d0ccf52ab348"],
Cell[222491, 5504, 650, 11, 78, "Text",ExpressionUUID->"927dc486-1fa0-4112-b7d3-90b67b19a3ca"],
Cell[CellGroupData[{
Cell[223166, 5519, 175, 3, 44, "Subsubsection",ExpressionUUID->"57d8e237-3a5f-497a-991b-ff818be83e53"],
Cell[223344, 5524, 6229, 113, 273, "Input",ExpressionUUID->"101cbc87-decd-4144-b618-ddb406bfd222",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[229610, 5642, 177, 3, 44, "Subsubsection",ExpressionUUID->"7d421757-4fa1-4a0e-886c-65e45c7ab9af"],
Cell[229790, 5647, 1518, 38, 102, "Input",ExpressionUUID->"7650658f-c294-44f0-ad64-9dc837d22d5b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[231345, 5690, 172, 3, 44, "Subsubsection",ExpressionUUID->"59b1d336-ff6f-4a6e-9100-5e0a05c2dc2c"],
Cell[231520, 5695, 1382, 36, 102, "Input",ExpressionUUID->"b2419dd8-19c4-4a9f-8991-050582a7f964",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[232963, 5738, 162, 3, 53, "Section",ExpressionUUID->"c311c0f9-8781-428d-82de-250d34f4c112"],
Cell[CellGroupData[{
Cell[233150, 5745, 222, 4, 53, "Subsection",ExpressionUUID->"7a2af6b3-6c2e-4d89-b78d-eca82aa1218f"],
Cell[233375, 5751, 5380, 143, 216, "Input",ExpressionUUID->"26acd47b-e21e-4a12-b52e-4da7c435333a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[238792, 5899, 218, 4, 53, "Subsection",ExpressionUUID->"c74f53f9-4fad-4c4d-8ee3-f4c334b02613"],
Cell[239013, 5905, 9930, 251, 767, "Input",ExpressionUUID->"d73dc117-b7f3-428a-aa3a-a42c242d59fd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[248980, 6161, 223, 4, 53, "Subsection",ExpressionUUID->"5a27cb82-7d9b-4e98-bfcb-8344fa6dc03d"],
Cell[249206, 6167, 5784, 108, 311, "Input",ExpressionUUID->"dd68c38e-2dd5-4bbc-a4da-8f4331301df9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[255027, 6280, 278, 4, 53, "Subsection",ExpressionUUID->"853dfae3-d175-496b-85c2-93f7cc289f86"],
Cell[255308, 6286, 5117, 87, 235, "Input",ExpressionUUID->"d16b62b2-d702-4a9a-85e7-176a03a6ae85",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[260474, 6379, 164, 3, 53, "Section",ExpressionUUID->"da3af8ef-56f3-4acd-a270-72d049030925"],
Cell[CellGroupData[{
Cell[260663, 6386, 276, 4, 53, "Subsection",ExpressionUUID->"7505930b-0bec-44f3-b4a3-da498011abc9"],
Cell[260942, 6392, 6288, 165, 710, "Input",ExpressionUUID->"f462131b-5960-465b-a915-78e679c2b68f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[267267, 6562, 266, 4, 53, "Subsection",ExpressionUUID->"d60681cd-4464-4214-b894-74a2cc519ffd"],
Cell[267536, 6568, 9122, 216, 805, "Input",ExpressionUUID->"7e695e15-a3b0-414c-b804-522814a1b8da",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[276707, 6790, 178, 3, 53, "Section",ExpressionUUID->"d4b86cca-51db-4d6a-9208-18a9443802fb"],
Cell[CellGroupData[{
Cell[276910, 6797, 170, 3, 53, "Subsection",ExpressionUUID->"8f993ae6-4b92-4663-9350-8bee2f66f611"],
Cell[CellGroupData[{
Cell[277105, 6804, 162, 3, 44, "Subsubsection",ExpressionUUID->"7eb6f85c-14e5-4d41-afc9-16ad47a958b3"],
Cell[277270, 6809, 2082, 54, 159, "Input",ExpressionUUID->"617c2098-1a06-4f6e-8707-365d4fb3c49e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[279389, 6868, 161, 3, 44, "Subsubsection",ExpressionUUID->"e280c4b1-70a0-4ae2-afa0-47e6dcb7fe1d"],
Cell[279553, 6873, 2499, 67, 178, "Input",ExpressionUUID->"42c3278b-4036-4155-9d9b-37a0eed818f2",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[282101, 6946, 166, 3, 37, "Subsection",ExpressionUUID->"708fc183-6061-4341-baa4-5046ca4d7f90"],
Cell[CellGroupData[{
Cell[282292, 6953, 167, 3, 44, "Subsubsection",ExpressionUUID->"d0e26681-e604-472f-8e8b-4fba00cc08ba"],
Cell[282462, 6958, 2766, 71, 387, "Input",ExpressionUUID->"58b89735-d7d9-4bad-863f-331674cb27e6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[285265, 7034, 170, 3, 36, "Subsubsection",ExpressionUUID->"ab2b6aef-cf4a-4991-9166-7f5899f133d9"],
Cell[285438, 7039, 6890, 176, 805, "Input",ExpressionUUID->"165ea959-8127-4b5d-bcd3-7d2662b40ce9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[292353, 7219, 420, 10, 48, "Input",ExpressionUUID->"d95ea71f-ab06-4b06-807f-c4a15a5d5f74"],
Cell[292776, 7231, 2453, 64, 90, "Output",ExpressionUUID->"675a80c8-46a4-4df6-8a81-e4d30ad0f4f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295266, 7300, 227, 4, 28, "Input",ExpressionUUID->"ad009a87-c747-409b-8649-abf9ccf9e158"],
Cell[295496, 7306, 2453, 64, 90, "Output",ExpressionUUID->"4ef9842c-3e6e-4f7d-8151-9ec69764cd24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297986, 7375, 2641, 70, 162, "Input",ExpressionUUID->"ad18bcf9-73bb-47fe-98b9-d964b96d44d3"],
Cell[300630, 7447, 602, 14, 32, "Output",ExpressionUUID->"ed1a4931-bbc4-4fc5-b881-0788a59712a8"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[301293, 7468, 172, 3, 37, "Subsection",ExpressionUUID->"0f648d22-4483-45d8-aa7f-1032e936ec07"],
Cell[CellGroupData[{
Cell[301490, 7475, 172, 3, 44, "Subsubsection",ExpressionUUID->"a60a9a21-2864-4c11-85ed-f644a8fd4c49"],
Cell[301665, 7480, 2878, 73, 254, "Input",ExpressionUUID->"8eaed1a0-b0d3-4625-bc5e-d0642406a51f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[304580, 7558, 176, 3, 36, "Subsubsection",ExpressionUUID->"20d1fdb6-493a-428f-bf1a-206956bb50b6"],
Cell[304759, 7563, 7209, 184, 824, "Input",ExpressionUUID->"ab4b02b0-6a41-44de-8316-1bf3ff1dbea9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[311993, 7751, 660, 13, 48, "Input",ExpressionUUID->"5aa2eaef-6213-446f-ae10-d147f8d0fcc4"],
Cell[312656, 7766, 3223, 86, 128, "Output",ExpressionUUID->"671b6e6e-5a91-45f5-b502-ab8e3475e44d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315916, 7857, 161, 3, 28, "Input",ExpressionUUID->"6e939b0f-c6f8-46ca-9665-9e6e4746c60a"],
Cell[316080, 7862, 1618, 44, 71, "Output",ExpressionUUID->"fbc3a0f2-d920-4469-84d2-e0e82ede2750"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317735, 7911, 426, 10, 48, "Input",ExpressionUUID->"a4fe5d1c-4270-4d16-81a5-fbeb25ff5f06"],
Cell[318164, 7923, 6568, 174, 242, "Output",ExpressionUUID->"f9cc6078-f596-4ff7-b5fa-871c975c9893"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324769, 8102, 229, 4, 28, "Input",ExpressionUUID->"cb190133-9d7c-4bed-b051-7a3d09cbfa10"],
Cell[325001, 8108, 1567, 43, 71, "Output",ExpressionUUID->"5a3f7f7e-f4fe-4be9-9c8a-e742ce42e8d7"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[326631, 8158, 159, 3, 56, "Chapter",ExpressionUUID->"36c6bb8c-253d-4b9f-8e32-d03faf565497"]
}, Open  ]]
}
]
*)

